/*
  This software is copyright Kong Inc. and its licensors.
  Use of the software is subject to the agreement between your organization
  and Kong Inc. If there is no such agreement, use is governed by and
  subject to the terms of the Kong Master Software License Agreement found
  at https://konghq.com/enterprisesoftwarelicense/.
*/

import{_ as w,r as n,o as l,c as h,a as d,b as p,h as b,z as x,u as O,Q as je,Z as T,E as Ne,l as g,w as m,d as v,ae as F,R,V as _,G as E,W as qe,t as C,U as A,af as $,X as Be,O as ze,ad as Ue,H as He,N as Ke,M as Ge,J as Je,m as Ze,I as Qe,k as Xe,v as Ye,j,p as ta,e as ea,__tla as aa}from"./index.84d84090.3_3_0_0.js";import{D as N,_ as q,C as sa,s as P,L as ra,a as ia,K as oa,F as la,b as na,__tla as ca}from"./LicenseMixin.1fc445e6.3_3_0_0.js";import{C as V,__tla as da}from"./ChartDataController.a765a4e0.3_3_0_0.js";import{N as ha,a as ua,__tla as pa}from"./NodeDataTable.67ffbca2.3_3_0_0.js";import{_ as ma,__tla as ya}from"./LineChartWrapper.be3dd56e.3_3_0_0.js";import{g as ba,s as B,m as z,f as U,t as H,a as K,b as ga,c as G,i as ka,d as J,e as Z,h as fa,j as wa,k as va,l as Ca}from"./chartHelpers.1bf67333.3_3_0_0.js";import{l as xa}from"./vitalsGroup.41ed9564.3_3_0_0.js";import{L as Q,V as M,a as X,__tla as La}from"./VitalsDisabled.f093ed15.3_3_0_0.js";import{T as Da,__tla as Sa}from"./TimeFramePicker.465b75eb.3_3_0_0.js";import{P as _a,__tla as Ta}from"./Pagination.d4ba9ccc.3_3_0_0.js";import{E as Ea,__tla as Fa}from"./EntityMixin.2764673d.3_3_0_0.js";import{__tla as Ra}from"./monaco-editor.90904fcf.3_3_0_0.js";import"./icon-help.699f8c28.3_3_0_0.js";import{__tla as Pa}from"./EntityButton.1838e0e9.3_3_0_0.js";import{__tla as Va}from"./EntityFilter.bf4158bc.3_3_0_0.js";let Y,Ma=Promise.all([(()=>{try{return aa}catch{}})(),(()=>{try{return ca}catch{}})(),(()=>{try{return da}catch{}})(),(()=>{try{return pa}catch{}})(),(()=>{try{return ya}catch{}})(),(()=>{try{return La}catch{}})(),(()=>{try{return Sa}catch{}})(),(()=>{try{return Ta}catch{}})(),(()=>{try{return Fa}catch{}})(),(()=>{try{return Ra}catch{}})(),(()=>{try{return Pa}catch{}})(),(()=>{try{return Va}catch{}})()]).then(async()=>{const tt={name:"NodeChartTabs",components:{NodeChartList:ha,NodeDataTable:ua},props:{nodes:{type:Object,default:null},siblingEvent:{type:Object,default:null},notifySiblings:{type:Function,default:null},height:{type:Number,default:200},chartList:{type:Object,default:null}}},et={class:"latency-chart-wrapper"},at={class:"chart-group mb-4"},st={class:"row"},rt={class:"row"},it={key:0,class:"mt-4 col"};function ot(t,a,e,i,r,s){const o=n("NodeChartList"),c=n("NodeDataTable");return l(),h("div",et,[d("div",at,[d("div",st,[p(o,{"chart-visible":!!e.chartList&&!!e.chartList.updateOptions,"chart-list":e.chartList,"sibling-event":e.siblingEvent,height:e.height,"notify-siblings":e.notifySiblings},null,8,["chart-visible","chart-list","sibling-event","height","notify-siblings"])]),d("div",rt,[e.chartList.dataTableConfig?(l(),h("div",it,[p(c,{list:e.chartList,nodes:e.nodes},null,8,["list","nodes"])])):b("",!0)])])])}const lt=w(tt,[["render",ot]]),nt=[{h:0,s:0,l:30},{h:0,s:0,l:45},{h:0,s:0,l:60},{h:0,s:0,l:75},{h:146,s:70,l:62},{h:79,s:70,l:65},{h:49,s:90,l:69},{h:35,s:90,l:67},{h:20,s:90,l:60},{h:0,s:90,l:62},{h:292,s:44,l:70},{h:261,s:48,l:65},{h:245,s:40,l:60},{h:227,s:90,l:55},{h:219,s:90,l:60},{h:208,s:90,l:75},{h:186,s:75,l:65},{h:168,s:70,l:50}],ct={name:"NodeChartWrapper",components:{LatencyNodeChart:lt},extends:ma,props:{labelTemplate:{type:Function,default:()=>{}},chartList:{type:Object,default:null}},data(){return{timeRange:{},labels:[],colors:[],siblingEvent:null,nodeData:{},nodes:{},loadedTabs:{}}},computed:{stats(){return this.rawData&&this.rawData.stats?this.rawData.stats:{}},meta(){return this.rawData&&this.rawData.meta?this.rawData.meta:{}}},watch:{isUtc:{handler:function(){this.redraw(this.chartList)}},timeRange:{handler:function(t){this.processData(this.chartList,t)}}},mounted(){this.init()},updated(){const t=new Event("latencyEvent",{bubbles:!0});t.avgLatency=this.avgLatency(),this.$el.dispatchEvent(t)},methods:{getHslaFromColorObj:ba,avgLatency(){const t=Object.keys(this.chartList.table).filter(e=>this.nodes[e]&&this.nodes[e].active&&this.nodes[e].state).map(e=>({data:this.chartList.table[e],nodeId:e}))[0],a=this.chartList.dataTableConfig[2];return t&&a.formatter(t.data,t.nodeId)},getColors(){this.colors=nt.slice()},getChartData(){this.timeRange=this.getTimeRange(this.meta),this.nodeData=this.getNodeData(this.stats,this.meta),this.labels=this.timeRange.labels,Object.keys(this.nodes).forEach(t=>{this.nodes[t].active=!1}),this.processData(this.chartList,this.timeRange)},redraw(t){let a=5;t.charts.forEach(e=>{const i=e.processedData&&e.processedData.datasets||this.getDatasets(e);!i||(i.forEach(r=>{r.hidden=!this.nodes[r.label]||!this.nodes[r.label].active||!this.nodes[r.label].state,r.hidden||(a=r.data.reduce((s,o)=>Math.max(s,o.y||0),a))}),e.processedData={labels:this.labels,datasets:i})}),t.table=Object.assign({},t.tempTableData),t.updateOptions={suggestedYMax:a}},init(){this.chartList.charts.forEach(t=>{t.options=this.getOptions(t),t.tooltipModel=null}),this.redraw(this.chartList)},notifySiblings(t,a){this[t]=a},chartLegendUpdate(){this.redraw(this.chartList)},getOptions(t){const a=[{stacked:t.stacked,id:"y-axis-main",ticks:{beginAtZero:!0,max:t.max,callback:t.yCallback,maxTicksLimit:5}}];return t.stacked&&a.push({id:"y-axis-cluster-total",stacked:!1,display:!1,ticks:{beginAtZero:!0,max:t.max,callback:t.yCallback,maxTicksLimit:5}}),{plugins:{tooltip:{itemSort:(e,i,r)=>r.datasets[e.datasetIndex].label==="cluster"?-1:r.datasets[i.datasetIndex].label==="cluster"?1:e.datasetIndex>i.datasetIndex?-1:e.datasetIndex<i.datasetIndex?1:0,callbacks:{label:this.formatTooltipLabel(t)},external:this.drawTooltip(t)}},scales:{xAxes:[{ticks:{callback:this.timeTicksFormat},time:{parser:this.timeParser}}],yAxes:a}}},drawTooltip(t){return({tooltip:a})=>{t.tooltipModel=Object.assign({},a)}},getDatasets(t){return t.tempChartData?Object.keys(t.tempChartData).reduce((a,e)=>{const i=t.tempChartData[e].dataArray,r=e==="cluster"||i.some(({y:s})=>s!==t.defaultValue);if(this.updateNode(e,t.tempChartData[e].hostname,r),r){const s=this.getHslaFromColorObj(this.nodes[e].color),o=this.getHslaFromColorObj(this.nodes[e].color,{a:.8});a.push({spanGaps:!!t.spanGaps,data:i,fill:t.stacked&&e!=="cluster"?"origin":!1,backgroundColor:o,borderColor:s,hostname:t.tempChartData[e].hostname,label:e,lineTension:0,borderWidth:1.2,pointRadius:t.pointRadius||0,pointBorderWidth:1.2,pointHoverBackgroundColor:o,pointBorderColor:s,borderJoinStyle:"round",yAxisID:t.stacked&&e==="cluster"?"y-axis-cluster-total":"y-axis-main"})}return a},[]).sort((a,e)=>{const i=this.nodes[a.label].index,r=this.nodes[e.label].index;return i>r?1:i<r?-1:0}):null},updateNode(t,a,e){this.nodes[t]||(this.nodes[t]={state:!0,active:!1,hostname:a,index:Object.keys(this.nodes).length}),e&&(this.nodes[t].active=!0),!this.nodes[t].color&&e&&(this.colors.length===0&&this.getColors(),this.nodes[t].color=t==="cluster"?{h:0,s:0,l:30}:this.colors.pop())},formatTooltipValue(t,a){return typeof a!="function"?t:`${a(t)}`},formatTooltipLabel(t){return a=>{const e=a.dataset.hostname,i=this.formatTooltipValue(a.formattedValue,t.tooltipCallback);return[e,i]}},getNodeData(t,a){return!t||!a?[]:Object.keys(t).map(e=>{const i=a.nodes[e]&&a.nodes[e].hostname||"hostname unavailable";return{id:e,stats:t[e],hostname:i}})},processData(t,a){Array.isArray(a.range)&&(a.range.forEach((e,i)=>{const r=i===0;r&&(t.tempTableData={cluster:{cluster:0,total:0,min:null,max:null}}),t.charts.forEach(s=>{r&&(s.tempChartData={cluster:{dataArray:[],hostname:"cluster"}},s.processedData=null),s.acc={cluster:0,total:0},this.nodeData.forEach(c=>{let y=c.stats[e];y===void 0&&(y=s.defaultTimestampValue),r&&(t.tempTableData[c.id]={cluster:0,total:0},s.tempChartData[c.id]={dataArray:[],hostname:c.hostname});const u=s.getStat(y,t.tempTableData[c.id],t.tempTableData.cluster);s.tempChartData[c.id].dataArray.push({x:e,y:u})});const o=s.getClusterData(t.tempTableData.cluster);s.tempChartData.cluster.dataArray.push({x:e,y:o})})}),this.redraw(t))}}},dt={class:"row"},ht={class:"col"};function ut(t,a,e,i,r,s){const o=n("LatencyNodeChart");return l(),h("div",null,[d("div",dt,[d("div",ht,[p(o,{"chart-list":e.chartList,nodes:r.nodes,"sibling-event":r.siblingEvent,"notify-siblings":s.notifySiblings,height:t.height},null,8,["chart-list","nodes","sibling-event","notify-siblings","height"])])])])}const pt={name:"LatencyChart",components:{LatencyNodeChartWrapper:w(ct,[["render",ut],["__scopeId","data-v-62131b25"]])},mixins:[V],inheritAttrs:!1,props:{latencyTimeFrame:{type:Object,required:!0}},data(){return{charts:{vitalsGroup:{url:"nodes",rawData:null,config:{title:"Vitals",tabsGroup:[xa]}}}}},computed:{...x(O,{perms:"permissions"}),...x(je,{docsLink:"docsEnterprise"}),...x(T,{config:"infoConfig"}),isInfluxStrategy(){return this.config.vitals&&this.config.vitals_strategy==="influxdb"},isAllowedToView(){return this.$rbac.isAllowed(this.perms,[{path:"/vitals/nodes",actions:["read"]}],"*")}},watch:{latencyTimeFrame:{handler:function(){this.timeFrame=this.latencyTimeFrame},immediate:!0}},methods:{avgLatency(){return this.$refs.latencyNodeChartWrapper.avgLatency()}}},mt={class:"vitals-overview"},yt={key:0},bt={key:1};function gt(t,a,e,i,r,s){const o=n("LatencyNodeChartWrapper"),c=n("RbacEmptyList");return l(),h("section",mt,[s.isAllowedToView?(l(),h("div",yt,[p(o,Ne(t.$attrs,{ref:"latencyNodeChartWrapper","raw-data":r.charts.vitalsGroup.rawData,"vitals-enabled":t.vitalsEnabled,"chart-list":r.charts.vitalsGroup.config.tabsGroup[0],"time-frame":t.timeFrame,"is-utc":t.isUtc,"label-template":t.labelTemplate,height:250}),null,16,["raw-data","vitals-enabled","chart-list","time-frame","is-utc","label-template"])])):(l(),h("div",bt,[p(c)]))])}const kt=w(pt,[["render",gt]]),ft={name:"WorkspaceCardStatusCodesChart",components:{LineChart:Q,DashboardChartTooltip:N,VitalsEmptyState:M},extends:q,props:{stacked:{type:Boolean,default:!0},chartBackgroundColor:{type:String,default:null},padding:{type:Object,default:()=>({top:0,bottom:0,right:0,left:0})},showEmptyState:{type:Boolean,default:!1},workspace:{type:String,default:""}},data(){return{colors:{"1xx":{h:49,s:90,l:69},"2xx":{h:146,s:70,l:62},"3xx":{h:208,s:90,l:75},"4xx":{h:0,s:90,l:62},"5xx":{h:245,s:40,l:60},nonStandard:{h:0,s:0,l:75}},counters:{},options:{layout:{},animation:{duration:0},plugins:{legend:{display:!1,position:"bottom"},tooltip:{enabled:!1,mode:"index",intersect:!1,titleFont:{size:8},bodyFont:{size:8},caretSize:0,caretPadding:0,xPadding:0,itemSort:(t,a)=>t.datasetIndex>a.datasetIndex?-1:t.datasetIndex<a.datasetIndex?1:0,external:this.drawTooltip,callbacks:{label:this.formatTooltipLabel}}},elements:{point:{radius:0,hitRadius:4,hoverRadius:4}},scales:{xAxes:[{grid:{display:!1,drawTicks:!1,drawBorder:!1},ticks:{callback:this.timeTicksFormat,padding:10,source:"labels",autoSkip:!1,display:!1},type:"time",time:{parser:this.timeParser,tooltipFormat:"h:mm:ss a",displayFormats:{second:"h:mm:ss a",minute:"h:mm:ss a"}}}],yAxes:[{ticks:{maxTicksLimit:10,display:!1},id:"y-axis-main",stacked:!0,grid:{lineWidth:0,drawBorder:!1,display:!1,drawTicks:!1}}]},responsive:!0,maintainAspectRatio:!1}}},computed:{stats:B,meta:z,formattedTotal:U,timestampKeys:H,hasNoRequests(){return Object.keys(this.stats).length===0}},mounted(){this.options.scales.yAxes[0].stacked=this.stacked,this.options.layout.padding=this.padding||{top:0,bottom:0,right:0,left:0}},methods:{toCommaNumberStr:K,getColor:ga,formatTooltipLabel:G,isNonStandardClass:ka,getChartData(){this.counters={total:0};const t=this.getTimeRange(this.meta),a=t.range.reduce((e,i)=>{const r=this.stats[i];return r?Object.keys(r).filter(s=>!this.isNonStandardClass(s)).reduce((s,o)=>(s[o]=s[o]||this.initDataset(t.range,0),s[o][i]=r[o],this.counters[o]=(this.counters[o]||0)+r[o],this.counters.total+=r[o],s),e):e},{});return{datasets:Object.keys(a).map(e=>{const i=a[e],r=this.getColor(e),s=this.getColor(e,{l:98});return{fill:this.stacked?"origin":!1,backgroundColor:s,borderColor:r,pointHoverBackgroundColor:s,pointBorderColor:r,data:Object.keys(i).map(o=>({x:o,y:i[o]})),label:e,lineTension:0,borderWidth:1.2,pointBorderWidth:1.2,borderJoinStyle:"round"}}).sort((e,i)=>{const r=e.label,s=i.label;return r>s?1:r<s?-1:0}),labels:t.labels}}}},wt={class:"row"},vt={key:0},Ct=v(" Add a Gateway Service "),xt=v(" to see its traffic here "),Lt={key:1},Dt={key:1},St={key:1,class:"w-100"};function _t(t,a,e,i,r,s){const o=n("router-link"),c=n("RbacValidate"),y=n("VitalsEmptyState"),u=n("LineChart"),k=n("DashboardChartTooltip");return l(),h("div",wt,[e.showEmptyState||s.hasNoRequests?(l(),g(y,{key:0,"is-small":"",title:""},{message:m(()=>[e.showEmptyState?(l(),g(c,{key:0,workspace:e.workspace,restricted:[{path:"/services",actions:["create"]}]},{default:m(({isAllowed:f})=>[f?(l(),h("div",vt,[p(o,{to:{name:"create-service",params:{workspace:e.workspace}}},{default:m(()=>[Ct]),_:1},8,["to"]),xt])):(l(),h("div",Lt))]),_:1},8,["workspace"])):b("",!0),!e.showEmptyState&&s.hasNoRequests?(l(),h("div",Dt," No data available ")):b("",!0)]),_:1})):(l(),h("div",St,[p(u,{"chart-background-color":e.chartBackgroundColor,height:t.height,"chart-data":t.chartData,options:r.options,class:"col-12"},null,8,["chart-background-color","height","chart-data","options"]),p(k,{"tooltip-model":t.tooltipModel,title:"Status Codes"},null,8,["tooltip-model"])]))])}const Tt={name:"WorkspaceCardStatusCodesWrapper",components:{WorkspaceCardStatusCodesChart:w(ft,[["render",_t]]),VitalsDisabled:X,VitalsEmptyState:M},mixins:[V],props:{chartDataUrls:{type:Object,default:()=>({})},statusCodeDetailRoute:{type:String,default:""},infoTexts:{type:Object,default:()=>({})},cardTimeFrame:{type:Object,default:null},cardIsUtc:{type:Boolean,default:!1},showEmptyVitals:{type:Boolean,default:!1}},emits:["raw-data"],data(){return{chartWrapperClass:null,percentListWrapperClass:null,chartBackgroundColor:null,height:250,timeBlock:{param:"minutes",refreshInterval:9999999,stepSize:60,text:"",ticksMod:7200,timeFrameLength:43200},stacked:!0,padding:{top:0,bottom:0,right:0,left:0},percentListOptions:{category:{text:"Status Code",key:"title"},value:{text:"Count",key:"count"}},statusCodesList:[],codeClassDescriptions:{"1xx":"Informational","2xx":"Success","3xx":"Redirection","4xx":"Client Errors","5xx":"Server Errors"},charts:{statusCodes:{url:null,rawData:null,chartData:null},codeDetail:{url:null,rawData:null}}}},computed:{...x(T,{isFreeMode:t=>t.mode===F.FREE}),statusCode(){return this.$route.params.statusCode},chartKeys(){return this.statusCode?["codeDetail"]:["statusCodes"]},infoText(){const t=this.infoTexts[this.chartKeys];return typeof t=="function"?t(this.statusCode):t},titleStyle(){return{cursor:this.statusCode?"pointer":"auto"}}},watch:{chartKeys:{handler(){this.fetchData()},deep:!0},cardTimeFrame:{handler(){this.timeFrame=this.cardTimeFrame},immediate:!0},cardIsUtc:{handler(){this.isUtc=this.cardIsUtc},immediate:!0}},created(){this.chartDataUrls&&(this.charts.statusCodes.url=this.chartDataUrls.statusCodes,this.charts.codeDetail.url=this.chartDataUrls.codeDetail)},methods:{backToStatusCodes(){!this.statusCode||(this.$router.replace({path:this.$route.path.replace(`/code/${this.statusCode}`,"")}),this.fetchData())},handleChartData(t){this.formatPercentList(t.datasets),this.$emit("raw-data",this.charts.statusCodes.rawData)},viewStatusCodeDetails({title:t}){this.statusCodeDetailRoute&&(this.$router.replace({name:this.statusCodeDetailRoute,params:{statusCode:t}}),this.fetchData())},formatPercentList(t){this.statusCodesList=t.map(a=>{const e={color:a.backgroundColor,title:a.label,count:a.data.reduce((i,{y:r})=>(i+=r,i),0)};return this.codeClassDescriptions[a.label]&&(e.subTitle=" \u2014 "+this.codeClassDescriptions[a.label]),e})}}},Et={key:0,class:"row"},Ft=v(" Charts not available in free mode "),Rt={key:0,class:"row"};function Pt(t,a,e,i,r,s){const o=n("VitalsEmptyState"),c=n("VitalsDisabled"),y=n("WorkspaceCardStatusCodesChart");return l(),h("section",null,[t.isFreeMode?(l(),h("div",Et,[p(o,{"is-small":"",title:""},{message:m(()=>[Ft]),_:1})])):(l(),h(R,{key:1},[p(c,{"vitals-enabled":t.vitalsEnabled,"in-card":!0,"is-small":"","has-background":"",class:"workspace-vitals-disabled"},null,8,["vitals-enabled"]),!s.statusCode&&t.vitalsEnabled?(l(),h("div",Rt,[d("div",{class:_([r.chartWrapperClass,"col-12 mb-2"])},[p(y,{"show-empty-state":e.showEmptyVitals,workspace:t.workspace.name,padding:r.padding,"chart-background-color":r.chartBackgroundColor,stacked:r.stacked,"vitals-enabled":t.vitalsEnabled,height:r.height,"time-frame":t.timeFrame,"is-utc":t.isUtc,"raw-data":r.charts.statusCodes.rawData,onChartData:s.handleChartData},null,8,["show-empty-state","workspace","padding","chart-background-color","stacked","vitals-enabled","height","time-frame","is-utc","raw-data","onChartData"])],2)])):b("",!0),E(t.$slots,"statusCodeDetail",{statusCode:s.statusCode,timeFrame:t.timeFrame,vitalsEnabled:t.vitalsEnabled,rawData:r.charts.codeDetail.rawData},void 0,!0)],64))])}const Vt={name:"WorkspaceCard",components:{WorkspaceCardStatusCodesOverview:{name:"WorkspaceCardChartWrapper",extends:w(Tt,[["render",Pt],["__scopeId","data-v-ae84ba03"]]),props:{workspace:{type:Object,default:function(){return null},required:!1},chartDataUrls:{type:Object,default:()=>({statusCodes:"status_code_classes"})},infoTexts:{type:Object,default:()=>({statusCodes:J.statusCodesWorkspace})}},data(){return{padding:null,chartBackgroundColor:null,chartWrapperClass:"col-lg-12 flex-lg-last",percentListWrapperClass:"col-lg-12 flex-lg-first",stacked:!0,height:130}}},WorkspaceTitle:qe},props:{workspace:{type:Object,required:!0},timeFrame:{type:Object,default:null},isUtc:{type:Boolean,default:!1}},data(){return{metrics:null}},computed:{totalRequests(){const{metrics:{totalRequests:t}}=this.workspace,a=parseInt(!t||typeof t=="symbol"?0:t).toLocaleString("en");return a!=="NaN"?a:"0"},errorRate(){const{metrics:{errorRate:t}}=this.workspace;return!t||typeof t=="symbol"?"0%":t},hasConsumerMetrics(){const{metrics:t}=this.workspace;return t&&typeof t.totalConsumers=="number"&&t.totalConsumers>=0},hasServiceMetrics(){const{metrics:t}=this.workspace;return t&&typeof t.totalServices=="number"&&t.totalServices>=0},showEmptyVitals(){return this.workspace.metrics.totalServices===0}},methods:{handleChartData(t){const a=Z(t);this.workspace.metrics={...this.workspace.metrics,...a}}}},Mt={key:0,class:"card-subtitle"},Wt=v(" Requests"),It=v(" Error Rate"),Ot={class:"card-chart"},At={class:"card-data"},$t={key:0},jt=v(" Consumers"),Nt={key:1},qt=v(" Gateway Services");function Bt(t,a,e,i,r,s){const o=n("WorkspaceTitle"),c=n("WorkspaceCardStatusCodesOverview"),y=n("KCard"),u=n("router-link");return l(),h("div",{class:_(["workspace-card",`workspace-${e.workspace.name}`])},[p(u,{to:{name:"dashboard",params:{workspace:e.workspace.name}}},{default:m(()=>[p(y,{"has-hover":!0,"border-variant":"border"},{title:m(()=>[p(o,{title:e.workspace.name,"background-color":e.workspace.meta&&e.workspace.meta.color,icon:e.workspace.meta&&e.workspace.meta.thumbnail},null,8,["title","background-color","icon"])]),body:m(()=>[e.workspace.metrics?(l(),h("div",Mt,[d("span",null,[d("strong",null,C(s.totalRequests),1),Wt]),d("span",null,[d("strong",null,C(s.errorRate),1),It])])):b("",!0),d("div",Ot,[p(c,{"show-empty-vitals":s.showEmptyVitals,workspace:e.workspace,"card-time-frame":e.timeFrame,"card-is-utc":e.isUtc,onRawData:s.handleChartData},null,8,["show-empty-vitals","workspace","card-time-frame","card-is-utc","onRawData"])]),d("div",At,[s.hasConsumerMetrics?(l(),h("span",$t,[d("strong",null,C(e.workspace.metrics.totalConsumers),1),jt])):b("",!0),s.hasServiceMetrics?(l(),h("span",Nt,[d("strong",null,C(e.workspace.metrics.totalServices),1),qt])):b("",!0)])]),_:1})]),_:1},8,["to"])],2)}const zt={name:"WorkspaceCardGrid",components:{WorkspaceCard:w(Vt,[["render",Bt],["__scopeId","data-v-e0d56f23"]])},props:{workspaces:{type:Array,required:!0},timeFrame:{type:Object,default:null},isUtc:{type:Boolean,default:!1}}},Ut={class:"workspace-card-wrapper"};function Ht(t,a,e,i,r,s){const o=n("WorkspaceCard");return l(),h("div",Ut,[(l(!0),h(R,null,A(e.workspaces,c=>(l(),g(o,{key:c.name,workspace:c,"time-frame":e.timeFrame,"data-testid":`workspace-card-${c.name}`,"is-utc":e.isUtc},null,8,["workspace","time-frame","data-testid","is-utc"]))),128))])}const Kt=w(zt,[["render",Ht]]),Gt={name:"WorkspaceIcon",props:{name:{type:String,default:null},icon:{type:String,default:null},backgroundColor:{type:String,required:!1,default:"#3894f0"},textColor:{type:String,required:!1,default:"#fff"}},computed:{workspaceAbbreviation(){const t=this.name.match(/[-_]/)&&this.name.match(/[-_]/).index;return t?[this.name.slice(0,t),this.name.slice(t+1)].map(a=>a[0]).join(""):this.name.substring(0,2)}}},Jt={class:"workspace-icon-wrapper"};function Zt(t,a,e,i,r,s){return l(),h("div",Jt,[e.icon?(l(),h("div",{key:0,style:$({backgroundImage:`url('${e.icon}')`}),class:"ws-thumbnail"},null,4)):(l(),h("div",{key:1,style:$({color:e.textColor,background:e.backgroundColor}),class:"workspace-icon"},C(s.workspaceAbbreviation),5))])}const Qt={name:"WorkspaceTableList",components:{WorkspaceIcon:w(Gt,[["render",Zt],["__scopeId","data-v-93d30c73"]])},props:{workspaces:{type:Array,required:!0},hasVitalsPermissions:{type:Boolean,default:!0},timeFrame:{type:Object,default:null}},computed:{tableData(){return{headers:this.tableHeaders,data:this.table}},tableHeaders(){return this.hasVitalsPermissions?[{label:"",key:"icon",hideLabel:!0},{label:"Workspace",key:"workspace"},{label:"Requests",key:"totalRequests"},{label:"Error Rate",key:"errorRate"},{label:"Consumers",key:"totalConsumers"},{label:"Gateway Services",key:"totalServices"}]:[{label:"",key:"icon",hideLabel:!0},{label:"Workspace",key:"workspace"},{label:"Created at",key:"created_at"}]},table(){return this.workspaces.map(t=>{const a=this.flatten(t);return Object.keys(a).forEach(e=>{a.totalRequests||(a.totalRequests=0),a.errorRate||(a.errorRate="0%"),e==="errorRate"&&(a[e]=a[e]||"0%"),a[e]===0&&(a[e]="0")}),a})},tableAutoFieldKeys(){const t=["icon","workspace","errorRate","created_at"],a=e=>!t.includes(e);return this.tableHeaders.map(({key:e})=>e).filter(a)}},methods:{formatCreatedAt(t){return Be(t)},flatten(t){const a={};function e(i,r){Object.keys(i).forEach(s=>i[s]&&typeof i[s]=="object"&&!i[s].length?e(i[s],r?`${s}`:s):a[r?`${s}`:s]=i[s])}return e(t),a},rowClickHandler(t,a){this.$router.push(`/${a.name}/dashboard`)}}},Xt=["data-testid"],Yt={key:0,class:"danger"};function te(t,a,e,i,r,s){const o=n("WorkspaceIcon"),c=n("KSkeleton"),y=n("KTable");return l(),g(y,{headers:s.tableData.headers,fetcher:()=>({data:s.tableData.data}),"disable-pagination":!0,"onRow:click":s.rowClickHandler},ze({icon:m(({row:u})=>[p(o,{name:u.name,"background-color":u.color||void 0,icon:u.thumbnail},null,8,["name","background-color","icon"])]),workspace:m(({row:u})=>[d("span",{"data-testid":`workspace-link-${u.name}`},C(u.name),9,Xt)]),errorRate:m(({row:u})=>[u.errorRate!==u.symFetching?(l(),h("span",Yt,C(u.errorRate),1)):(l(),g(c,{key:1,type:"spinner"}))]),created_at:m(({row:u})=>[v(C(s.formatCreatedAt(u.created_at)),1)]),_:2},[A(s.tableAutoFieldKeys,u=>({name:u,fn:m(({row:k})=>[d("div",null,[k[u]!==k.symFetching?(l(),h(R,{key:0},[v(C(k[u]),1)],64)):(l(),g(c,{key:1,type:"spinner"}))])])}))]),1032,["headers","fetcher","onRow:click"])}const ee=w(Qt,[["render",te],["__scopeId","data-v-906ed858"]]),ae={name:"ClusterStatusCodesChart",components:{ChartComplexHeader:sa,LineChart:Q,DashboardChartTooltip:N,VitalsEmptyState:M},extends:q,props:{stacked:{type:Boolean,default:!0},chartBackgroundColor:{type:String,default:null},padding:{type:Object,default:()=>({top:0,bottom:0,right:0,left:0})},showEmptyState:{type:Boolean,default:!1},noBorder:{type:Boolean,default:!1}},data(){return{counters:{},options:{layout:{},hover:{mode:"index",intersect:!1,animationDuration:0},animation:{duration:0},plugins:{legend:{display:!1,position:"top"},tooltip:{enabled:!1,mode:"index",intersect:!1,titleFont:{size:16},bodyFont:{size:16},caretSize:0,caretPadding:0,xPadding:0,itemSort:(t,a)=>t.datasetIndex>a.datasetIndex?-1:t.datasetIndex<a.datasetIndex?1:0,external:this.drawTooltip,callbacks:{label:this.formatTooltipLabel}}},elements:{point:{radius:0,hitRadius:4,hoverRadius:4}},scales:{xAxes:[{grid:{display:!1,drawTicks:!1,drawBorder:!1},ticks:{callback:this.timeTicksFormat,padding:10,source:"labels",autoSkip:!1,display:!0},type:"time",time:{parser:this.timeParser,tooltipFormat:"h:mm:ss a",displayFormats:{second:"h:mm:ss a",minute:"h:mm:ss a"}}}],yAxes:[{ticks:{maxTicksLimit:10,display:!0},id:"y-axis-main",stacked:!0,grid:{lineWidth:0,drawBorder:!1,display:!1,drawTicks:!1}}]},responsive:!0,maintainAspectRatio:!1}}},computed:{stats:B,meta:z,formattedTotal:U,timestampKeys:H,noRequestsMessage(){return this.hasNoRequests&&!this.showEmptyState?"Try using a longer timeframe":"Once a Gateway Service has been added to any workspace and it receives requests, you'll see the traffic here."},hasNoRequests(){return Object.keys(this.stats).length===0},legend(){return!this.chartData||!this.chartData.datasets?[]:this.chartData.datasets.reduce((t,a)=>(t.push({color:P[a.label][0],label:`Status ${a.label}`,count:a.data.reduce((e,{y:i})=>e+i,0)}),t),[])},chartAriaLabel(){var e,i,r,s;const t=["Line chart showing the number of requests"],a=(i=(e=this.timeFrame)==null?void 0:e.text)==null?void 0:i.toLowerCase();if(a){t.push(`in ${a}.`);const o=[];(s=(r=this.chartData)==null?void 0:r.datasets)==null||s.forEach(c=>{const y=c.data.reduce((u,k)=>{const f={...u};return(!f.min||f.min.y>k.y)&&(f.min=k),(!f.max||f.max.y<k.y)&&(f.max=k),f},{min:null,max:null});if(y.max){const u=Ue(y.max.x*1e3),k=this.isUtc?u.utc().format("LT UTC on LL"):u.format("LT on LL"),f=y.max.y%1===0?Number.parseInt(y.max.y):y.max.y;o.push(`As for ${c.label} statuses, the most recent maximum value ${f} appears at ${k}.`)}}),t.push(o.join(" "))}return t.join(" ")},chartCanvasAttrs(){return{role:"img","aria-label":this.chartAriaLabel,"aria-live":"polite"}}},mounted(){this.options.scales.yAxes[0].stacked=this.stacked,this.options.layout.padding=this.padding||{top:0,bottom:0,right:0,left:0}},methods:{toCommaNumberStr:K,getColor(t,a){const e=`${t.charAt(0)}xx`,i=P[e];return i?a?i[1]:i[0]:this.colors.nonStandard},formatTooltipLabel:G,isNonStandardClass(t){return!P[t]},getChartData:fa,tooltipTitle(t){return`Traffic ${(t&&t.dataPoints?t.dataPoints.reduce((a,e)=>{const i=parseInt(e.raw.y);return i&&(a+=i),a},0):0).toLocaleString("en")}`}}},se={class:"row overview-chart"},re={key:1,class:"w-100"};function ie(t,a,e,i,r,s){const o=n("VitalsEmptyState"),c=n("ChartComplexHeader"),y=n("LineChart"),u=n("DashboardChartTooltip");return l(),h("div",se,[e.showEmptyState||s.hasNoRequests?(l(),g(o,{key:0,message:s.noRequestsMessage,"no-border":e.noBorder,title:"No data available"},null,8,["message","no-border"])):(l(),h("div",re,[p(c,{legend:s.legend,class:"px-4 pb-4",title:"Total traffic"},{extra:m(()=>[E(t.$slots,"extra")]),_:3},8,["legend"]),p(y,{"chart-background-color":e.chartBackgroundColor,height:t.height,"chart-data":t.chartData,"canvas-attrs":s.chartCanvasAttrs,options:r.options,class:"col-12 mb-2"},null,8,["chart-background-color","height","chart-data","canvas-attrs","options"]),p(u,{"tooltip-model":t.tooltipModel,title:s.tooltipTitle},null,8,["tooltip-model","title"])]))])}const oe={name:"ClusterStatusCodesWrapper",components:{ClusterStatusCodesChart:w(ae,[["render",ie]]),VitalsDisabled:X},mixins:[V],props:{chartDataUrls:{type:Object,default:()=>({})},statusCodeDetailRoute:{type:String,default:""},infoTexts:{type:Object,default:()=>({})},clusterTimeFrame:{type:Object,default:null},clusterIsUtc:{type:Boolean,default:!1},showEmptyVitals:{type:Boolean,default:!1},noBorder:{type:Boolean,default:!1}},emits:["raw-data"],data(){return{chartWrapperClass:null,percentListWrapperClass:null,chartBackgroundColor:null,height:250,stacked:!0,padding:{top:0,bottom:0,right:0,left:0},percentListOptions:{category:{text:"Status Code",key:"title"},value:{text:"Count",key:"count"}},statusCodesList:[],codeClassDescriptions:{"1xx":"Informational","2xx":"Success","3xx":"Redirection","4xx":"Client Errors","5xx":"Server Errors"},charts:{statusCodes:{url:null,rawData:null,chartData:null},codeDetail:{url:null,rawData:null}}}},computed:{statusCode(){return this.$route.params.statusCode},chartKeys(){return this.statusCode?["codeDetail"]:["statusCodes"]},infoText(){const t=this.infoTexts[this.chartKeys];return typeof t=="function"?t(this.statusCode):t},titleStyle(){return{cursor:this.statusCode?"pointer":"auto"}}},watch:{chartKeys:{handler(){this.fetchData()},deep:!0},clusterTimeFrame:{handler(){this.timeFrame=this.clusterTimeFrame},immediate:!0},clusterIsUtc:{handler(){this.isUtc=this.clusterIsUtc}}},created(){this.chartDataUrls&&(this.charts.statusCodes.url=this.chartDataUrls.statusCodes,this.charts.codeDetail.url=this.chartDataUrls.codeDetail)},methods:{backToStatusCodes(){!this.statusCode||(this.$router.replace({path:this.$route.path.replace(`/code/${this.statusCode}`,"")}),this.fetchData())},handleChartData(t){this.formatPercentList(t.datasets),this.$emit("raw-data",this.charts.statusCodes.rawData)},viewStatusCodeDetails({title:t}){this.statusCodeDetailRoute&&(this.$router.replace({name:this.statusCodeDetailRoute,params:{statusCode:t}}),this.fetchData())},formatPercentList(t){this.statusCodesList=t.map(a=>{const e={color:a.backgroundColor,title:a.label,count:a.data.reduce((i,{y:r})=>(i+=r,i),0)};return this.codeClassDescriptions[a.label]&&(e.subTitle=" \u2014 "+this.codeClassDescriptions[a.label]),e})}}},le={key:0,class:"row"};function ne(t,a,e,i,r,s){const o=n("VitalsDisabled"),c=n("ClusterStatusCodesChart");return l(),h("section",null,[p(o,{"vitals-enabled":t.vitalsEnabled,"has-background":"",class:"workspace-vitals-disabled"},null,8,["vitals-enabled"]),!s.statusCode&&t.vitalsEnabled?(l(),h("div",le,[d("div",{class:_([r.chartWrapperClass,"col-12 mb-2"])},[p(c,{"show-empty-state":e.showEmptyVitals,padding:r.padding,"chart-background-color":r.chartBackgroundColor,stacked:r.stacked,"vitals-enabled":t.vitalsEnabled,height:r.height,"time-frame":t.timeFrame,"is-utc":t.isUtc,"raw-data":r.charts.statusCodes.rawData,"no-border":e.noBorder,onChartData:s.handleChartData},{extra:m(()=>[E(t.$slots,"extra",{},void 0,!0)]),_:3},8,["show-empty-state","padding","chart-background-color","stacked","vitals-enabled","height","time-frame","is-utc","raw-data","no-border","onChartData"])],2)])):b("",!0),E(t.$slots,"statusCodeDetail",{statusCode:s.statusCode,timeFrame:t.timeFrame,vitalsEnabled:t.vitalsEnabled,rawData:r.charts.codeDetail.rawData},void 0,!0)])}const ce=w(oe,[["render",ne],["__scopeId","data-v-efc34050"]]),de={name:"ClusterStatusCodesOverview",extends:ce,props:{chartDataUrls:{type:Object,default:()=>({statusCodes:"status_code_classes"})},infoTexts:{type:Object,default:()=>({statusCodes:J.statusCodesOverview})},noBorder:{type:Boolean,default:!1}},data(){return{workspace:null,padding:null,chartBackgroundColor:null,chartWrapperClass:"col-lg-12 flex-lg-last",percentListWrapperClass:"col-lg-12 flex-lg-first",stacked:!0,height:250}}},he=[{text:"Last 5 Minutes",value:{text:"Last 5 Minutes",timeFrameLength:300,stepSize:1,param:"seconds",ticksMod:60,refreshInterval:9999999}},{text:"Last 30 Minutes",value:{text:"Last 30 Minutes",timeFrameLength:1800,stepSize:60,param:"minutes",ticksMod:300,refreshInterval:9999999}},{text:"Last 60 Minutes",value:{text:"Last 60 Minutes",timeFrameLength:3600,stepSize:60,param:"minutes",ticksMod:900,refreshInterval:9999999}},{text:"Last 6 Hours",value:{text:"Last 6 Hours",timeFrameLength:21600,stepSize:60,param:"minutes",ticksMod:3600,refreshInterval:9999999}},{text:"Last 12 Hours",value:{text:"Last 12 Hours",timeFrameLength:43200,stepSize:60,param:"minutes",ticksMod:7200,refreshInterval:9999999}}];function ue(t="card"){const a=localStorage.getItem("workspaceView");return a!==null?["card","list"].indexOf(a)>-1?a:(localStorage.setItem("workspaceView",t),t):t}const L=Symbol("fetching"),pe={name:"WorkspaceOverview",components:{WorkspaceCardList:Kt,WorkspaceTableList:ee,LicenseGrid:ra,PageHeader:He,DashboardWidget:ia,ClusterStatusCodesOverview:de,TimeFramePicker:Da,Pagination:_a,KMetricTabs:oa,LatencyCharts:kt,FreeModeCTA:la},mixins:[Ea,Ke,na],data(){return{hasInfoPermission:!0,workspaceListPageSize:12,currentPage:0,timeFrame:{},isUtc:null,timeFrameOptions:he,query:"",avgLatency:"-",charts:{vitalsGroup:{url:"status_code_classes",rawData:null}},workspaceList:[],workspaceCache:[],chartMetrics:{},machine:Ge({id:"overviewMachine",initial:ue(),states:{card:{initial:"idle",states:{idle:{on:{FETCH:"pending"}},pending:{on:{RESOLVE:"success",REJECT:"error"}},success:{type:"final"},error:{type:"final"}},on:{CLICK_LIST:"list.success"}},list:{initial:"idle",states:{idle:{on:{FETCH:"pending"}},pending:{on:{RESOLVE:"success",REJECT:"error"}},success:{type:"final"},error:{type:"final"}},on:{CLICK_CARD:"card.success"}}}})}},computed:{...x(T,{config:"infoConfig",workspacesEnabled:t=>t.mode===F.FULL,isFreeMode:t=>t.mode===F.FREE}),...x(O,{perms:"permissions",currentUser:"currentUser"}),...x(Je,["workspaces"]),hasVitalsPermissions(){return this.$rbac.isAllowed(this.perms,[{path:"/vitals/cluster",actions:["read"]},{path:"/vitals/status_code_classes",actions:["read"]}],"default")},vitalsEnabled(){return this.config.vitals},showEmptyVitals(){return!this.isEmpty&&this.licenseReport&&this.licenseReport.services_count===0},isEmpty(){return!this.workspaceList||this.workspaceList.length===0},totalPages(){return!this.isEmpty&&Math.ceil(this.workspaceList.length/this.workspaceListPageSize)},workspaceListFiltered(){return this.workspaceList.filter(t=>(this.query&&t.name.toLowerCase().indexOf(this.query.toLowerCase()))>-1).slice(this.currentPage*this.workspaceListPageSize,(this.currentPage+1)*this.workspaceListPageSize)},hasPrevious(){return this.totalPages>1&&this.currentPage>0},hasNext(){return this.currentPage+1<this.totalPages},licenseGridMetrics(){return{license:{metric:"License expiration",value:Math.floor(this.licenseExpirationDays),total:Math.floor(this.licenseTotalDays)},others:{totalServices:{metric:"API Services",helpText:"The total number of Gateway Services configured in the Kong node.",value:this.licenseReport&&this.licenseReport.services_count},totalConsumers:{metric:"API Consumers",helpText:"The total number of consumers configured in the Kong node.",value:this.licenseReport&&this.licenseReport.consumers_count},totalRequests:{metric:"API Requests",helpText:"The total number of restful API requests proxied by Kong in the current license term.",value:this.licenseReport&&this.licenseRequestCounters,notAvailable:this.isFreeMode}}}},averageErrorRate(){return this.chartMetrics.averageErrorRate||"0%"},clusterMetrics(){const t={totalRequests:{slot:!0,hash:"traffic",tip:"The total number of API requests proxied through Kong in the selected time frame.",metric:"Total traffic",value:this.chartMetrics.totalRequests,status:"info"},latency:{slot:!0,hash:"latency",tip:"The average latency of API requests proxied through Kong in the selected time frame.",metric:"Latency",value:this.avgLatency&&this.avgLatency!=="-"&&`${this.avgLatency} avg`||"-",status:"info"}},a=[];for(const e in t){const i=t[e];a.push({slot:i.slot,hash:i.hash,tip:i.tip,title:i.metric,value:i,status:i.status})}return a}},watch:{timeFrame:{handler(){this.fetchWorkspaceListData()}},workspaces:{handler(t){const a=["default",...t.map(({name:e})=>e)].find(e=>this.$rbac.isAllowed(this.perms,[{path:"/kong",actions:["read"]}],e));this.hasInfoPermission=Boolean(a),this.getInfo({workspace:a,silent:!0})},immediate:!0,deep:!0},currentPage(){this.fetchVitalsForVisibleWorkspaces()},query(){this.currentPage=0,this.workspaceList=[],this.buildWorkspaceList(this.workspaceCache),this.fetchVitalsForVisibleWorkspaces()}},created(){this.transition("FETCH"),(!this.hasVitalsPermissions||this.isFreeMode)&&this.fetchWorkspaceListData()},mounted(){this.$el.addEventListener("latencyEvent",t=>{this.avgLatency=t.avgLatency})},methods:{...Ze(T,["getInfo"]),async fetchWorkspaceListData(){this.currentPage=0;const t=[],a=[];if(this.$rbac.isAllowed(this.perms,[{path:"/workspaces",actions:["read"]}],"default")){const e=await this.$api.getWorkspaces(1e3,!0);t.push(...e.data),a.push(...e.data),await this.buildWorkspaceList(t),await this.fetchVitalsForVisibleWorkspaces()}else t.push(...this.workspaces),a.push(...this.workspaces),this.transition("RESOLVE"),this.workspaceList=t;this.workspaceCache=a},copyTransformer(){return this.licenseReport&&this.infoLicense&&(this.licenseReport.license=this.infoLicense),this.licenseReport},setView(t){this.transition(`CLICK_${t.toUpperCase()}`),localStorage.setItem("workspaceView",t),this.fetchVitalsForVisibleWorkspaces()},async buildWorkspaceList(t){const a=Qe("name"),e=[...t].sort((i,r)=>i.name==="default"?-1:r.name==="default"?1:a(i,r)).map(i=>{const r=`workspaces/${i.name}/meta`,s=this.$rbac.isAllowed(this.perms,[{path:`/${r}`,actions:["read"]}],i.name),o={...i,metrics:{...s?{totalConsumers:L,totalServices:L}:null},symFetching:L};return s&&this.fetchMetrics(o),o});this.workspaceList=e.filter(i=>(this.query&&i.name.toLowerCase().indexOf(this.query.toLowerCase()))>-1),this.transition("RESOLVE")},async fetchVitalsForVisibleWorkspaces(){if(this.currentMachineState.matches("list.success")){const t=this.currentPage*this.workspaceListPageSize;await Promise.all(this.workspaceList.slice(t,t+this.workspaceListPageSize).map(this.fetchVital))}},fetchMetrics(t){var a,e;t.metrics.totalConsumers=((a=t.counters)==null?void 0:a.consumers)||0,t.metrics.totalServices=((e=t.counters)==null?void 0:e.services)||0},async fetchVital(t){const a=this.timeFrame.param;if(!this.vitalsEnabled||!this.hasVitalsPermissions||!a)return;t.metrics={...t.metrics,totalRequests:L,totalErrors:L,errorRate:L};const e=Date.now()/1e3,i=Math.floor(e/this.timeFrame.stepSize)*this.timeFrame.stepSize-this.timeFrame.timeFrameLength,r=`${t.name}/vitals/status_code_classes?interval=${a}&start_ts=${i}`;try{const s=await this.$api.query(r),o=this.workspaceList.find(c=>c.id===t.id);if(!o)return;o.metrics={...o.metrics,totalRequests:0,totalErrors:0,errorRate:"0%",...Z(s.data)}}catch(s){if(s.isAxiosError&&s.response.status!==404)throw s}},handleClusterChartData(t){const a=t.stats,e=a.cluster?wa(Object.values(a.cluster)):null,i=a.cluster?va(Object.values(a.cluster)):null,r=Ca(e,i),s={totalRequests:e||0,averageErrorRate:isNaN(r)?0+"%":r.toFixed(2)+"%"};this.chartMetrics=s},updateControls(t,a){this[t]=a},goToNextPage(){this.currentPage=this.currentPage+1},goToPreviousPage(){this.currentPage=this.currentPage-1}}},D=t=>(ta("data-v-f6a1781e"),t=t(),ea(),t),me={class:"workspace-overview"},ye=D(()=>d("hr",{class:"mb-6"},null,-1)),be={class:"workspace-overview-content"},ge={class:"dashboard-control d-flex flex-wrap"},ke={style:{color:"var(--red-500)"}},fe=v(" Average error rate "),we={class:"workspace-list"},ve={class:"toggle-wrapper"},Ce={class:"view-toggle"},xe=D(()=>d("label",null,"View:",-1)),Le=D(()=>d("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16"},[d("path",{"fill-rule":"evenodd",d:"M1 0h5c.55228 0 1 .44772 1 1v5c0 .55228-.44772 1-1 1H1c-.55228 0-1-.44772-1-1V1c0-.55228.44772-1 1-1zm1 2v3h3V2H2zM1 9h5c.55228 0 1 .44772 1 1v5c0 .55228-.44772 1-1 1H1c-.55228 0-1-.44772-1-1v-5c0-.55228.44772-1 1-1zm1 2v3h3v-3H2zm8-11h5c.55228 0 1 .44772 1 1v5c0 .55228-.44772 1-1 1h-5c-.55228 0-1-.44772-1-1V1c0-.55228.44772-1 1-1zm1 2v3h3V2h-3zm-1 7h5c.55228 0 1 .44772 1 1v5c0 .55228-.44772 1-1 1h-5c-.55228 0-1-.44772-1-1v-5c0-.55228.44772-1 1-1zm1 2v3h3v-3h-3z"})],-1)),De=[Le],Se=D(()=>d("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16"},[d("path",{"fill-rule":"evenodd",d:"M9 6v2h5V6H9zM7 6H2v2h5V6zm2 6h5v-2H9v2zm-2 0v-2H2v2h5zM9 2v2h5V2H9zM7 2H2v2h5V2zM2 0h12c1.10457 0 2 .89543 2 2v10c0 1.10457-.89543 2-2 2H2c-1.10457 0-2-.89543-2-2V2C0 .89543.89543 0 2 0z"})],-1)),_e=[Se],Te=D(()=>d("h5",{class:"mb-0"}," Error: Something went wrong ",-1)),Ee=v(" No Results "),Fe=v(" No workspaces matching the search term. "),Re=D(()=>d("span",{style:{display:"none"}},"\xA0",-1));function Pe(t,a,e,i,r,s){const o=n("EntityButton"),c=n("PageHeader"),y=n("LicenseGrid"),u=n("KCard"),k=n("FreeModeCTA"),f=n("TimeFramePicker"),Ve=n("ClusterStatusCodesOverview"),W=n("DashboardWidget"),Me=n("LatencyCharts"),We=n("KMetricTabs"),Ie=n("WorkspaceCardList"),Oe=n("WorkspaceTableList"),Ae=n("KSkeleton"),I=n("KEmptyState"),$e=n("Pagination");return l(),h("section",me,[p(c,{title:"Workspaces"},{default:m(()=>[p(o,{"restricted-actions":["create"],"button-props":{appearance:"primary",class:"create-workspace-submit ml-2 mb-2",disabled:!t.workspacesEnabled},workspace:"default","path-name":"create-workspace",text:"New Workspace",entity:"workspaces/*"},null,8,["button-props"])]),_:1}),ye,d("div",be,[p(u,{title:"Overview"},{body:m(()=>[p(y,{"license-metric":s.licenseGridMetrics.license,"other-metrics":s.licenseGridMetrics.others,"hide-license":r.hasInfoPermission&&t.isFreeMode,"copy-transformer":s.copyTransformer,"metric-slots":4},null,8,["license-metric","other-metrics","hide-license","copy-transformer"])]),_:1}),r.hasInfoPermission&&t.isFreeMode?(l(),g(k,{key:0})):r.hasInfoPermission&&s.hasVitalsPermissions?(l(),g(We,{key:1,tabs:s.clusterMetrics},{actions:m(()=>[d("div",ge,[p(f,{"update-controls":s.updateControls,"is-disabled":!s.vitalsEnabled,options:r.timeFrameOptions},null,8,["update-controls","is-disabled","options"])])]),traffic:m(()=>[p(W,{"no-border":""},{content:m(()=>[p(Ve,{"show-empty-vitals":s.showEmptyVitals,"cluster-time-frame":r.timeFrame,"cluster-is-utc":r.isUtc,"no-border":"",onRawData:s.handleClusterChartData},{extra:m(()=>[d("div",ke,[d("b",null,C(s.averageErrorRate),1),fe])]),_:1},8,["show-empty-vitals","cluster-time-frame","cluster-is-utc","onRawData"])]),_:1})]),latency:m(()=>[p(W,{"no-border":""},{content:m(()=>[p(Me,{"latency-time-frame":r.timeFrame},null,8,["latency-time-frame"])]),_:1})]),_:1},8,["tabs"])):b("",!0),d("div",we,[s.hasVitalsPermissions?(l(),g(c,{key:0,size:4,title:"Workspaces"},{default:m(()=>[d("div",ve,[r.workspaceCache.length>r.workspaceListPageSize?Xe((l(),h("input",{key:0,"onUpdate:modelValue":a[0]||(a[0]=S=>r.query=S),class:"form-control mr-4",placeholder:"Filter Workspaces",type:"search"},null,512)),[[Ye,r.query]]):b("",!0),d("div",Ce,[xe,d("span",{class:_([{active:t.currentMachineState.matches("card")},"toggle-icon toggle-card"]),role:"button",tabindex:"0",onKeyup:a[1]||(a[1]=j(S=>s.setView("card"),["enter"])),onClick:a[2]||(a[2]=S=>s.setView("card"))},De,34),d("span",{class:_([{active:t.currentMachineState.matches("list")},"toggle-icon toggle-table"]),role:"button",tabindex:"0",onKeyup:a[3]||(a[3]=j(S=>s.setView("list"),["enter"])),onClick:a[4]||(a[4]=S=>s.setView("list"))},_e,34)])])]),_:1})):b("",!0),!s.isEmpty&&s.hasVitalsPermissions&&t.currentMachineState.matches("card.success")?(l(),g(Ie,{key:1,workspaces:s.workspaceListFiltered,"time-frame":r.timeFrame,"is-utc":r.isUtc},null,8,["workspaces","time-frame","is-utc"])):!s.isEmpty&&(t.currentMachineState.matches("list.success")||!s.hasVitalsPermissions)?(l(),g(Oe,{key:2,"has-vitals-permissions":s.hasVitalsPermissions,"time-frame":r.timeFrame,workspaces:s.workspaceListFiltered},null,8,["has-vitals-permissions","time-frame","workspaces"])):b("",!0),t.currentMachineState.matches("card.pending")||t.currentMachineState.matches("list.pending")?(l(),g(Ae,{key:3,type:t.currentMachineState.matches("card")?"card":"table","card-count":s.workspaceListFiltered.length,"table-rows":s.workspaceListFiltered.length},null,8,["type","card-count","table-rows"])):b("",!0),t.currentMachineState.matches("card.error")||t.currentMachineState.matches("list.error")?(l(),g(I,{key:4,"cta-is-hidden":"","is-error":""},{message:m(()=>[Te]),_:1})):b("",!0),(t.currentMachineState.matches("card.success")||t.currentMachineState.matches("list.success"))&&s.isEmpty?(l(),g(I,{key:5},{title:m(()=>[Ee]),message:m(()=>[Fe]),cta:m(()=>[Re]),_:1})):b("",!0),s.hasPrevious||s.hasNext?(l(),g($e,{key:6,"has-previous":s.hasPrevious,"has-next":s.hasNext,class:"ml-2 mr-2 mb-2",onNext:s.goToNextPage,onPrevious:s.goToPreviousPage},null,8,["has-previous","has-next","onNext","onPrevious"])):b("",!0)])])])}Y=w(pe,[["render",Pe],["__scopeId","data-v-f6a1781e"]])});export{Ma as __tla,Y as default};
