/*
  This software is copyright Kong Inc. and its licensors.
  Use of the software is subject to the agreement between your organization
  and Kong Inc. If there is no such agreement, use is governed by and
  subject to the terms of the Kong Master Software License Agreement found
  at https://konghq.com/enterprisesoftwarelicense/.
*/

import{y as N}from"./js-yaml.c564789b.3_3_0_0.js";import{o as n,c,af as C,r as u,a as i,b as p,k as _t,v as Et,t as y,V as j,h as E,R as $,U as V,_ as A,w as k,E as St,H as Ft,N as Pt,M as $t,z as U,J as Mt,Q as Tt,m as Dt,n as Lt,aS as Ot,at as It,l as w,O as Nt,d as M,p as Vt,e as At,__tla as Rt}from"./index.84d84090.3_3_0_0.js";import{W as zt,__tla as jt}from"./WorkspaceMixin.71f3f83c.3_3_0_0.js";import{s as S,i as F,c as Ut,F as Bt,__tla as Ht}from"./color.43b24a82.3_3_0_0.js";import{D as qt,__tla as Kt}from"./DisabledView.3ce50815.3_3_0_0.js";import{__tla as Xt}from"./monaco-editor.90904fcf.3_3_0_0.js";let B,Jt=Promise.all([(()=>{try{return Rt}catch{}})(),(()=>{try{return jt}catch{}})(),(()=>{try{return Ht}catch{}})(),(()=>{try{return Kt}catch{}})(),(()=>{try{return Xt}catch{}})()]).then(async()=>{const R={};var P={name:"Checkboard",props:{size:{type:[Number,String],default:8},white:{type:String,default:"#fff"},grey:{type:String,default:"#e6e6e6"}},computed:{bgStyle(){return{"background-image":`url(${q(this.white,this.grey,this.size)})`}}}};function H(e,t,a){if(typeof document>"u")return null;const s=document.createElement("canvas");s.width=s.height=a*2;const l=s.getContext("2d");return l?(l.fillStyle=e,l.fillRect(0,0,s.width,s.height),l.fillStyle=t,l.fillRect(0,0,a,a),l.translate(a,a),l.fillRect(0,0,a,a),s.toDataURL()):null}function q(e,t,a){const s=`${e},${t},${a}`;if(R[s])return R[s];const l=H(e,t,a);return R[s]=l,l}function K(e,t,a,s,l,o){return n(),c("div",{class:"vc-checkerboard",style:C(o.bgStyle)},null,4)}var X=".vc-checkerboard{background-size:contain;bottom:0;left:0;position:absolute;right:0;top:0}";S(X),P.render=K,P.__file="src/components/checkboard/checkboard.vue",P.install=F;var T={name:"Alpha",components:{Checkboard:P},props:{value:Object,onChange:Function},computed:{colors(){return this.value},gradientColor(){const{rgba:e}=this.colors,t=[e.r,e.g,e.b].join(",");return`linear-gradient(to right, rgba(${t}, 0) 0%, rgba(${t}, 1) 100%)`}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:a}=this.$refs;if(!a)return;const s=a.clientWidth,l=a.getBoundingClientRect().left+window.pageXOffset,o=(e.pageX||(e.touches?e.touches[0].pageX:0))-l;let r;o<0?r=0:o>s?r=1:r=Math.round(o*100/s)/100,this.colors.a!==r&&this.$emit("change",{h:this.colors.hsl.h,s:this.colors.hsl.s,l:this.colors.hsl.l,a:r,source:"rgba"})},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const J={class:"vc-alpha"},W={class:"vc-alpha-checkboard-wrap"},Y=i("div",{class:"vc-alpha-picker"},null,-1),Q=[Y];function G(e,t,a,s,l,o){const r=u("Checkboard");return n(),c("div",J,[i("div",W,[p(r)]),i("div",{class:"vc-alpha-gradient",style:C({background:o.gradientColor})},null,4),i("div",{ref:"container",class:"vc-alpha-container",onMousedown:t[0]||(t[0]=(...d)=>o.handleMouseDown&&o.handleMouseDown(...d)),onTouchmove:t[1]||(t[1]=(...d)=>o.handleChange&&o.handleChange(...d)),onTouchstart:t[2]||(t[2]=(...d)=>o.handleChange&&o.handleChange(...d))},[i("div",{class:"vc-alpha-pointer",style:C({left:`${o.colors.a*100}%`})},Q,4)],544)])}var Z=".vc-alpha,.vc-alpha-checkboard-wrap{bottom:0;left:0;position:absolute;right:0;top:0}.vc-alpha-checkboard-wrap{overflow:hidden}.vc-alpha-gradient{bottom:0;left:0;position:absolute;right:0;top:0}.vc-alpha-container{cursor:pointer;height:100%;margin:0 3px;position:relative;z-index:2}.vc-alpha-pointer{position:absolute;z-index:2}.vc-alpha-picker{background:#fff;border-radius:1px;box-shadow:0 0 2px rgba(0,0,0,.6);cursor:pointer;height:8px;margin-top:1px;transform:translateX(-2px);width:4px}";S(Z),T.render=G,T.__file="src/components/alpha/alpha.vue",T.install=F;var D={name:"EditableInput",props:{label:String,labelText:String,desc:String,value:[String,Number],max:Number,min:Number,arrowOffset:{type:Number,default:1}},computed:{val:{get(){return this.value},set(e){if(this.max!==void 0&&+e>this.max)this.$refs.input.value=this.max;else return e}},labelId(){return`input__label__${this.label}__${Math.random().toString().slice(2,5)}`},labelSpanText(){return this.labelText||this.label}},methods:{update(e){this.handleChange(e.target.value)},handleChange(e){const t={};t[this.label]=e,t.hex===void 0&&t["#"]===void 0?this.$emit("change",t):e.length>5&&this.$emit("change",t)},handleKeyDown(e){let{val:t}=this;const a=Number(t);if(a){const s=this.arrowOffset||1;e.keyCode===38&&(t=a+s,this.handleChange(t),e.preventDefault()),e.keyCode===40&&(t=a-s,this.handleChange(t),e.preventDefault())}}}};const ee={class:"vc-editable-input"},te=["aria-labelledby"],ae=["id","for"],oe={class:"vc-input__desc"};function se(e,t,a,s,l,o){return n(),c("div",ee,[_t(i("input",{ref:"input","onUpdate:modelValue":t[0]||(t[0]=r=>o.val=r),"aria-labelledby":o.labelId,class:"vc-input__input",onKeydown:t[1]||(t[1]=(...r)=>o.handleKeyDown&&o.handleKeyDown(...r)),onInput:t[2]||(t[2]=(...r)=>o.update&&o.update(...r))},null,40,te),[[Et,o.val]]),i("span",{id:o.labelId,for:a.label,class:"vc-input__label"},y(o.labelSpanText),9,ae),i("span",oe,y(a.desc),1)])}var le=".vc-editable-input{position:relative}.vc-input__input{border:0;outline:none;padding:0}.vc-input__label{text-transform:capitalize}";S(le),D.render=se,D.__file="src/components/editable-input/editable-input.vue",D.install=F;function z(e,t,a){return t<a?e<t?t:e>a?a:e:e<a?a:e>t?t:e}var L={name:"Saturation",props:{value:Object},computed:{colors(){return this.value},bgColor(){return`hsl(${this.colors.hsv.h}, 100%, 50%)`},pointerTop(){return`${-(this.colors.hsv.v*100)+1+100}%`},pointerLeft(){return`${this.colors.hsv.s*100}%`}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:a}=this.$refs;if(!a)return;const s=a.clientWidth,l=a.clientHeight,o=a.getBoundingClientRect().left+window.pageXOffset,r=a.getBoundingClientRect().top+window.pageYOffset,d=e.pageX||(e.touches?e.touches[0].pageX:0),g=e.pageY||(e.touches?e.touches[0].pageY:0),v=z(d-o,0,s),m=z(g-r,0,l),h=v/s,f=z(-(m/l)+1,0,1);this.onChange({h:this.colors.hsv.h,s:h,v:f,a:this.colors.hsv.a,source:"hsva"})},onChange(e){this.$emit("change",e)},handleMouseDown(e){window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const ie=i("div",{class:"vc-saturation--white"},null,-1),re=i("div",{class:"vc-saturation--black"},null,-1),ne=i("div",{class:"vc-saturation-circle"},null,-1),ce=[ne];function he(e,t,a,s,l,o){return n(),c("div",{ref:"container",class:"vc-saturation",style:C({background:o.bgColor}),onMousedown:t[0]||(t[0]=(...r)=>o.handleMouseDown&&o.handleMouseDown(...r)),onTouchmove:t[1]||(t[1]=(...r)=>o.handleChange&&o.handleChange(...r)),onTouchstart:t[2]||(t[2]=(...r)=>o.handleChange&&o.handleChange(...r))},[ie,re,i("div",{class:"vc-saturation-pointer",style:C({top:o.pointerTop,left:o.pointerLeft})},ce,4)],36)}var de=".vc-saturation,.vc-saturation--black,.vc-saturation--white{bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.vc-saturation--white{background:linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.vc-saturation--black{background:linear-gradient(0deg,#000,transparent)}.vc-saturation-pointer{cursor:pointer;position:absolute}.vc-saturation-circle{border-radius:50%;box-shadow:0 0 0 1.5px #fff,inset 0 0 1px 1px rgba(0,0,0,.3),0 0 1px 2px rgba(0,0,0,.4);cursor:head;height:4px;transform:translate(-2px,-2px);width:4px}";S(de),L.render=he,L.__file="src/components/saturation/saturation.vue",L.install=F;var O={name:"Hue",props:{value:Object,direction:{type:String,default:"horizontal"}},data(){return{oldHue:0,pullDirection:""}},computed:{colors(){return this.value},directionClass(){return{"vc-hue--horizontal":this.direction==="horizontal","vc-hue--vertical":this.direction==="vertical"}},pointerTop(){return this.direction==="vertical"?this.colors.hsl.h===0&&this.pullDirection==="right"?0:`${-(this.colors.hsl.h*100/360)+100}%`:0},pointerLeft(){return this.direction==="vertical"?0:this.colors.hsl.h===0&&this.pullDirection==="right"?"100%":`${this.colors.hsl.h*100/360}%`}},watch:{value:{handler(e,t){const{h:a}=e.hsl;a!==0&&a-this.oldHue>0&&(this.pullDirection="right"),a!==0&&a-this.oldHue<0&&(this.pullDirection="left"),this.oldHue=a},deep:!0,immediate:!0}},methods:{handleChange(e,t){!t&&e.preventDefault();const{container:a}=this.$refs;if(!a)return;const s=a.clientWidth,l=a.clientHeight,o=a.getBoundingClientRect().left+window.pageXOffset,r=a.getBoundingClientRect().top+window.pageYOffset,d=e.pageX||(e.touches?e.touches[0].pageX:0),g=e.pageY||(e.touches?e.touches[0].pageY:0),v=d-o,m=g-r;let h,f;this.direction==="vertical"?(m<0?h=360:m>l?h=0:(f=-(m*100/l)+100,h=360*f/100),this.colors.hsl.h!==h&&this.$emit("change",{h,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"})):(v<0?h=0:v>s?h=360:(f=v*100/s,h=360*f/100),this.colors.hsl.h!==h&&this.$emit("change",{h,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"}))},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}};const ue=["aria-valuenow"],pe=i("div",{class:"vc-hue-picker"},null,-1),me=[pe];function ge(e,t,a,s,l,o){return n(),c("div",{class:j(["vc-hue",[o.directionClass]])},[i("div",{ref:"container",class:"vc-hue-container",role:"slider","aria-valuenow":o.colors.hsl.h,"aria-valuemin":"0","aria-valuemax":"360",onMousedown:t[0]||(t[0]=(...r)=>o.handleMouseDown&&o.handleMouseDown(...r)),onTouchmove:t[1]||(t[1]=(...r)=>o.handleChange&&o.handleChange(...r)),onTouchstart:t[2]||(t[2]=(...r)=>o.handleChange&&o.handleChange(...r))},[i("div",{class:"vc-hue-pointer",style:C({top:o.pointerTop,left:o.pointerLeft}),role:"presentation"},me,4)],40,ue)],2)}var ve=".vc-hue{border-radius:2px;bottom:0;left:0;position:absolute;right:0;top:0}.vc-hue--horizontal{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.vc-hue--vertical{background:linear-gradient(0deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.vc-hue-container{cursor:pointer;height:100%;margin:0 2px;position:relative}.vc-hue-pointer{position:absolute;z-index:2}.vc-hue-picker{background:#fff;border-radius:1px;box-shadow:0 0 2px rgba(0,0,0,.6);cursor:pointer;height:8px;margin-top:1px;transform:translateX(-2px);width:4px}";S(ve),O.render=ge,O.__file="src/components/hue/hue.vue",O.install=F;const fe=["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF","rgba(0,0,0,0)"];var I={name:"Sketch",components:{Saturation:L,Hue:O,Alpha:T,EdIn:D,Checkboard:P},mixins:[Ut],props:{presetColors:{type:Array,default(){return fe}},disableAlpha:{type:Boolean,default:!1},disableFields:{type:Boolean,default:!1}},computed:{hex(){let e;return this.colors.a<1?e=this.colors.hex8:e=this.colors.hex,e.replace("#","")},activeColor(){const{rgba:e}=this.colors;return`rgba(${[e.r,e.g,e.b,e.a].join(",")})`}},methods:{handlePreset(e){this.colorChange(e)},childChange(e){this.colorChange(e)},inputChange(e){!e||(e.hex?this.isValidHex(e.hex)&&this.colorChange({hex:e.hex,source:"hex"}):(e.r||e.g||e.b||e.a)&&this.colorChange({r:e.r||this.colors.rgba.r,g:e.g||this.colors.rgba.g,b:e.b||this.colors.rgba.b,a:e.a||this.colors.rgba.a,source:"rgba"}))}}};const be={class:"vc-sketch-saturation-wrap"},Ce={class:"vc-sketch-controls"},ke={class:"vc-sketch-sliders"},we={class:"vc-sketch-hue-wrap"},ye={key:0,class:"vc-sketch-alpha-wrap"},xe={class:"vc-sketch-color-wrap"},_e=["aria-label"],Ee={key:0,class:"vc-sketch-field"},Se={class:"vc-sketch-field--double"},Fe={class:"vc-sketch-field--single"},Pe={class:"vc-sketch-field--single"},$e={class:"vc-sketch-field--single"},Me={key:0,class:"vc-sketch-field--single"},Te={class:"vc-sketch-presets",role:"group","aria-label":"A color preset, pick one to set as current color"},De=["aria-label","onClick"],Le=["aria-label","onClick"];function Oe(e,t,a,s,l,o){const r=u("Saturation"),d=u("Hue"),g=u("Alpha"),v=u("Checkboard"),m=u("EdIn");return n(),c("div",{role:"application","aria-label":"Sketch color picker",class:j(["vc-sketch",[a.disableAlpha?"vc-sketch__disable-alpha":""]])},[i("div",be,[p(r,{value:e.colors,onChange:o.childChange},null,8,["value","onChange"])]),i("div",Ce,[i("div",ke,[i("div",we,[p(d,{value:e.colors,onChange:o.childChange},null,8,["value","onChange"])]),a.disableAlpha?E("v-if",!0):(n(),c("div",ye,[p(g,{value:e.colors,onChange:o.childChange},null,8,["value","onChange"])]))]),i("div",xe,[i("div",{"aria-label":`Current color is ${o.activeColor}`,class:"vc-sketch-active-color",style:C({background:o.activeColor})},null,12,_e),p(v)])]),a.disableFields?E("v-if",!0):(n(),c("div",Ee,[E(" rgba "),i("div",Se,[p(m,{label:"hex",value:o.hex,onChange:o.inputChange},null,8,["value","onChange"])]),i("div",Fe,[p(m,{label:"r",value:e.colors.rgba.r,onChange:o.inputChange},null,8,["value","onChange"])]),i("div",Pe,[p(m,{label:"g",value:e.colors.rgba.g,onChange:o.inputChange},null,8,["value","onChange"])]),i("div",$e,[p(m,{label:"b",value:e.colors.rgba.b,onChange:o.inputChange},null,8,["value","onChange"])]),a.disableAlpha?E("v-if",!0):(n(),c("div",Me,[p(m,{label:"a",value:e.colors.a,"arrow-offset":.01,max:1,onChange:o.inputChange},null,8,["value","arrow-offset","onChange"])]))])),i("div",Te,[(n(!0),c($,null,V(a.presetColors,h=>(n(),c($,null,[e.isTransparent(h)?(n(),c("div",{key:h,"aria-label":`Color:${h}`,class:"vc-sketch-presets-color",onClick:f=>o.handlePreset(h)},[p(v)],8,Le)):(n(),c("div",{key:`!${h}`,class:"vc-sketch-presets-color","aria-label":`Color:${h}`,style:C({background:h}),onClick:f=>o.handlePreset(h)},null,12,De))],64))),256))])],2)}var Ie=".vc-sketch{background:#fff;border-radius:4px;box-shadow:0 0 0 1px rgba(0,0,0,.15),0 8px 16px rgba(0,0,0,.15);box-sizing:initial;padding:10px 10px 0;position:relative;width:200px}.vc-sketch-saturation-wrap{overflow:hidden;padding-bottom:75%;position:relative;width:100%}.vc-sketch-controls{display:flex}.vc-sketch-sliders{flex:1;padding:4px 0}.vc-sketch-sliders .vc-alpha-gradient,.vc-sketch-sliders .vc-hue{border-radius:2px}.vc-sketch-alpha-wrap,.vc-sketch-hue-wrap{height:10px;position:relative}.vc-sketch-alpha-wrap{margin-top:4px;overflow:hidden}.vc-sketch-color-wrap{border-radius:3px;height:24px;margin-left:4px;margin-top:4px;position:relative;width:24px}.vc-sketch-active-color{border-radius:2px;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.15),inset 0 0 4px rgba(0,0,0,.25);left:0;position:absolute;right:0;top:0;z-index:2}.vc-sketch-color-wrap .vc-checkerboard{background-size:auto}.vc-sketch-field{display:flex;padding-top:4px}.vc-sketch-field .vc-input__input{border:none;box-shadow:inset 0 0 0 1px #ccc;font-size:10px;padding:4px 0 3px 10%;width:90%}.vc-sketch-field .vc-input__label{color:#222;display:block;font-size:11px;padding-bottom:4px;padding-top:3px;text-align:center;text-transform:capitalize}.vc-sketch-field--single{flex:1;padding-left:6px}.vc-sketch-field--double{flex:2}.vc-sketch-presets{border-top:1px solid #eee;margin-left:-10px;margin-right:-10px;padding-left:10px;padding-top:10px}.vc-sketch-presets-color{cursor:pointer;display:inline-block;height:16px;margin:0 10px 10px 0;overflow:hidden;position:relative;vertical-align:top;width:16px}.vc-sketch-presets-color,.vc-sketch-presets-color .vc-checkerboard{border-radius:3px;box-shadow:inset 0 0 0 1px rgba(0,0,0,.15)}.vc-sketch__disable-alpha .vc-sketch-color-wrap{height:10px}";S(Ie),I.render=Oe,I.__file="src/components/sketch/sketch.vue",I.install=F;const Ne={name:"PortalColorPicker",components:{ColorPicker:I},props:{colorString:{type:String,required:!0},label:{type:String,required:!0},description:{type:String,default:()=>{}},palette:{type:Object,default:()=>{}},switchColor:{type:Function,required:!0}},computed:{normalLabel(){return this.label.replace(/_/g," ")},actualColor(){return this.getColor(this.colorString)},pickerPalette(){return[...new Set(Object.keys(this.palette).filter(e=>e!==this.label).map(e=>this.getColor(this.palette[e].value)))]}},methods:{handleColorPicker(e){this.switchColor(this.label,e.hex.toUpperCase())},getColor(e){if(!e.startsWith("var("))return e;const t=/\w*(?=\))/.exec(e)[0];return this.palette[t].value}}},Ve=["for"],Ae={class:"color-picker-title"},Re={class:"truncate"},ze={class:"color-picker-content"};function je(e,t,a,s,l,o){const r=u("KButton"),d=u("ColorPicker"),g=u("KPop");return n(),c("div",null,[i("label",{for:a.label,class:"color-label capitalize truncate"},y(o.normalLabel),9,Ve),p(g,{title:a.description,width:"254",trigger:"hover"},{title:k(()=>[i("div",Ae,y(a.description),1)]),content:k(()=>[i("div",ze,[p(d,{"model-value":o.actualColor,"preset-colors":o.pickerPalette,class:"vue-color","onUpdate:modelValue":o.handleColorPicker},null,8,["model-value","preset-colors","onUpdate:modelValue"])])]),default:k(()=>[p(r,{id:a.label,"is-rounded":!1,class:"color-button",appearance:"outline"},{default:k(()=>[i("div",{style:C({backgroundColor:o.actualColor}),class:"color-square"},null,4),i("p",Re,y(a.colorString),1)]),_:1},8,["id"])]),_:1},8,["title"])])}const Ue=A(Ne,[["render",je],["__scopeId","data-v-832f7d30"]]),Be={name:"ImagePicker",components:{FileUpload:Bt},props:{label:{type:String,required:!0},previousName:{type:String,default:null},previousThumbnail:{type:String,default:null},switchImage:{type:Function,required:!0},errorHandler:{type:Function,required:!0},imgAttrs:{type:Object,default:()=>({})}},data(){return{file:{name:null,thumbnail:null}}},watch:{file(){this.switchImage(this.label,this.file)}},methods:{updateFile(e){this.file=e}}},He=["id"],qe=["for"],Ke={class:"mt-2 capitalize"},Xe={key:0},Je={key:1},We=["src"];function Ye(e,t,a,s,l,o){const r=u("KCard"),d=u("FileUpload");return n(),c("div",{id:a.label},[i("label",{for:a.label},[i("h6",Ke,y(a.label),1)],8,qe),p(r,{class:"image-holder"},{body:k(()=>[!l.file.name&&!a.previousName?(n(),c("p",Xe," No File Chosen ")):!l.file.thumbnail&&!a.previousThumbnail?(n(),c("p",Je," Image could not be loaded ")):(n(),c("img",St({key:2},a.imgAttrs,{src:l.file.thumbnail||a.previousThumbnail,class:"image-preview",alt:"thumbnail"}),null,16,We))]),_:1}),p(d,{"previous-name":a.previousName,class:"file-upload",onInput:o.updateFile,onError:t[0]||(t[0]=g=>a.errorHandler(g))},null,8,["previous-name","onInput"])],8,He)}const Qe=A(Be,[["render",Ye],["__scopeId","data-v-cc3e6c1e"]]),Ge={name:"FontPicker",props:{label:{type:String,required:!0},selectedFont:{type:String,required:!0},switchFont:{type:Function,required:!0},fonts:{type:Array,required:!0}},computed:{updatedFont:{get(){return this.selectedFont},set(e){this.switchFont(this.label,e)}}}},Ze=["for"],et={class:"capitalize"};function tt(e,t,a,s,l,o){const r=u("KSelect");return n(),c("div",null,[i("label",{for:a.label},[i("h6",et,y(a.label),1)],8,Ze),p(r,{id:a.label,modelValue:o.updatedFont,"onUpdate:modelValue":t[0]||(t[0]=d=>o.updatedFont=d),appearance:"select",width:"auto",items:a.fonts.map(d=>({value:d,label:d}))},null,8,["id","modelValue","items"])])}const at=A(Ge,[["render",tt]]),ot=["Roboto","Open Sans","Lato","Slabo 27px","Slabo 13px","Oswald","Source Sans Pro","Montserrat","Raleway","PT Sans","Lora","Roboto Mono","Inconsolata","Source Code Pro","PT Mono","Ubuntu Mono","IBM Plex Mono"],st={name:"PortalAppearance",components:{PageHeader:Ft,PortalColorPicker:Ue,ImagePicker:Qe,FontPicker:at,DisabledView:qt},mixins:[Pt,zt],data(){return{portalConf:{},themeConf:{},combinedConf:{colors:{},fonts:{}},fonts:ot,portalConfFile:{},images:{logo:{name:null,thumbnail:null,previousName:null,previousThumbnail:null},favicon:{name:null,thumbnail:null,previousName:null,previousThumbnail:null}},errorMessage:"Failed to load portal.conf.yaml, check if file exists",errorMessageNoThemeDeclared:"Please set theme.name in portal.conf.yaml",machine:$t({id:"developerFormMachine",initial:"loading",states:{loading:{on:{RESOLVE:"idle",REJECT:"error"}},idle:{on:{SUBMIT:"submitting"}},submitting:{on:{RESOLVE:"idle",SAVE_FAILED:"idle"}},error:{on:{type:"final"}}}})}},computed:{...U(Mt,["workspaceConfig"]),errorMessageNoThemeConf(){return`Failed to load themes/${this.portalConf.theme.name}/theme.conf.yaml, check if theme exists`},portalEnabled(){return this.workspaceConfig.portal},...U(Tt,{portalDocs:"docsPortal"})},mounted(){!this.portalEnabled||this.getPortalConf().then(()=>this.getThemeConf()).then(()=>this.getCombinedConf()).then(()=>this.getImagePreviews()).then(()=>this.transition("RESOLVE")).catch(()=>{this.transition("REJECT")})},methods:{...Dt(Lt,["notify"]),getPortalConf(){return this.$api.findRecord("files","portal.conf.yaml").then(e=>{this.portalConf=N.load(e.data.contents),this.portalConfFile=e.data})},getThemeConf(){if(!this.portalConf.theme||!this.portalConf.theme.name)throw this.errorMessage=this.errorMessageNoThemeDeclared,new Error;return this.errorMessage=this.errorMessageNoThemeConf,this.$api.findRecord("files",`themes/${this.portalConf.theme.name}/theme.conf.yaml`).then(e=>{this.themeConf=N.load(e.data.contents)})},getCombinedConf(){const e=JSON.parse(JSON.stringify(this.themeConf));if(e.fonts=e.fonts||{},Object.keys(e.fonts).forEach(t=>{typeof e.fonts[t]!="object"&&(e.fonts[t]={value:e.fonts[t]})}),e.colors=e.colors||{},Object.keys(e.colors).forEach(t=>{typeof e.colors[t]!="object"&&(e.colors[t]={value:e.colors[t]})}),!this.portalConf)return e;this.portalConf.theme&&this.portalConf.theme.fonts&&Object.keys(this.portalConf.theme.fonts).forEach(t=>{e.fonts[t]=typeof this.portalConf.theme.fonts[t]=="object"?{...e.fonts[t],...this.portalConf.theme.fonts[t]}:{...e.fonts[t],value:this.portalConf.theme.fonts[t]}}),this.portalConf.theme&&this.portalConf.theme.colors&&(e.colors=e.colors||{},Object.keys(this.portalConf.theme.colors).forEach(t=>{e.colors[t]=typeof this.portalConf.theme.colors[t]=="object"?{...e.colors[t],...this.portalConf.theme.colors[t]}:{...e.colors[t],value:this.portalConf.theme.colors[t]}})),this.combinedConf=e},getImagePreviews(){Object.keys(this.images).forEach(async e=>{const t=this.combinedConf.images[e];if(!t)return;if(this.images[e].previousName=t,Ot(t)){this.images[e].previousThumbnail=t;return}const a=await this.getWorkspaceConfig(),s=It(a,this.workspace);this.images[e].previousThumbnail=`${s}/${t}`})},handleSave(){this.transition("SUBMIT"),this.portalConfFile.contents=this.calculateValueToSave();const e=[];let t=!1;if(Object.keys(this.images).forEach(a=>{const s=this.images[a];s.thumbnail&&(t=!0,this.themeConf.images=this.themeConf.images||{},this.themeConf.images[a]=`assets/images/${s.name}`,e.push(this.saveImage(s.thumbnail,s.name)))}),t){const a={path:`themes/${this.portalConf.theme.name}/theme.conf.yaml`,contents:N.dump(this.themeConf)};e.push(this.$api.upsertRecord(`files/${a.path}`,a))}e.push(this.$api.updateRecord("files",this.portalConfFile.id,this.portalConfFile)),Promise.all(e).then(()=>{this.transition("RESOLVE"),this.notify({message:"Portal Appearance settings saved",type:"success"})}).catch(()=>{this.errorHandler("Failed to save Portal Appearance settings"),this.transition("SAVE_FAILED")})},errorHandler(e){this.notify({message:e,type:"danger"})},saveImage(e,t){const a={path:`themes/${this.portalConf.theme.name}/assets/images/${t}`,contents:e};return this.$api.upsertRecord(`files/${a.path}`,a)},calculateValueToSave(){let e=JSON.parse(JSON.stringify(this.portalConf));return e=this.insertValuesFromCombined(e,["colors","fonts"]),N.dump(e)},insertValuesFromCombined(e,t){return t.forEach(a=>{Object.keys(this.combinedConf[a]).forEach(s=>{const l=this.combinedConf[a][s];(!this.isNestedValueEqual(this.themeConf,l,a,s)||this.isNestedPropValid(e,"theme",a,s)&&!this.isNestedValueEqual(e,l,"theme",a,s))&&(e.theme=e.theme||{},e.theme[a]=e.theme[a]||{},e.theme[a][s]=l)})}),e},isNestedValueEqual(e,t,...a){return this.isNestedPropValid(e,...a)?(a.forEach(s=>{e=e[s]}),this.isValueEqual(e,t)):!1},isNestedPropValid(e,...t){if(typeof e!="object"||e===null)return!1;for(let a=0;a<t.length;a++)if(e=e[t[a]],e==null)return!1;return!0},isValueEqual(e,t){return e===void 0||t===void 0?!1:(typeof e=="object"&&(e=e.value),typeof t=="object"&&(t=t.value),e===t)},switchColor(e,t){const a=Object.keys(this.combinedConf.colors);for(let s=0;s<a.length;s++){if(a[s]===e)continue;const l=this.combinedConf.colors[a[s]].value;if(t===l){t=`var(--${a[s]})`,a.forEach(o=>{this.combinedConf.colors[o].value===`var(--${e})`&&(this.combinedConf.colors[o].value=t)});break}}this.combinedConf.colors[e].value=t},switchImage(e,t){this.images[e].name=t.name,this.images[e].thumbnail=t.thumbnail},switchFont(e,t){this.combinedConf.fonts[e].value=t},normalize(e){return e.replace(/_/g," ")}}},_=e=>(Vt("data-v-9edd1469"),e=e(),At(),e),lt=_(()=>i("strong",null,"The Dev Portal is disabled!",-1)),it=M(" To enable visit the "),rt=M(" Portal Settings "),nt=M(" page or visit our "),ct=["href"],ht=M(" to learn more. "),dt={key:2},ut=_(()=>i("h5",{class:"mt-1 mb-4"}," Branding ",-1)),pt={key:1,class:"images block"},mt=_(()=>i("hr",null,null,-1)),gt=_(()=>i("h5",{class:"mt-4 mb-1"}," Colors ",-1)),vt={key:3,class:"colors block"},ft=_(()=>i("hr",null,null,-1)),bt=_(()=>i("h5",{class:"mt-4 mb-4"}," Fonts ",-1)),Ct={key:5,class:"fonts block"};function kt(e,t,a,s,l,o){const r=u("router-link"),d=u("DisabledView"),g=u("PageHeader"),v=u("KAlert"),m=u("KSkeleton"),h=u("ImagePicker"),f=u("PortalColorPicker"),wt=u("FontPicker"),yt=u("KIcon"),xt=u("KButton");return n(),c("section",null,[o.portalEnabled?E("",!0):(n(),w(d,{key:0,class:"mb-7"},Nt({_:2},[o.portalEnabled?void 0:{name:"disabledMessage",fn:k(()=>[lt,it,p(r,{to:{name:"portal-settings"}},{default:k(()=>[rt]),_:1}),nt,i("a",{href:e.portalDocs.url},"documentation",8,ct),ht])}]),1024)),p(g,{title:"Dev Portal Appearance"}),e.currentState==="error"?(n(),w(v,{key:1,"alert-message":l.errorMessage,appearance:"danger",class:"mb-4"},null,8,["alert-message"])):(n(),c("section",dt,[ut,e.currentState==="loading"&&o.portalEnabled?(n(),w(m,{key:0,type:"form"})):(n(),c("div",pt,[(n(!0),c($,null,V(l.images,(x,b)=>(n(),w(h,{key:b,class:j(b),label:b,"previous-name":x.previousName,"previous-thumbnail":x.previousThumbnail,"switch-image":o.switchImage,"error-handler":o.errorHandler,"img-attrs":{alt:b}},null,8,["class","label","previous-name","previous-thumbnail","switch-image","error-handler","img-attrs"]))),128))])),mt,gt,e.currentState==="loading"&&o.portalEnabled?(n(),w(m,{key:2,type:"form"})):(n(),c("div",vt,[(n(!0),c($,null,V(l.combinedConf.colors,(x,b)=>(n(),w(f,{key:b,palette:l.combinedConf.colors,"color-string":x.value,label:b,description:x.description,"switch-color":o.switchColor,class:"mt-6 mr-6"},null,8,["palette","color-string","label","description","switch-color"]))),128))])),ft,bt,e.currentState==="loading"&&o.portalEnabled?(n(),w(m,{key:4,type:"form"})):(n(),c("div",Ct,[(n(!0),c($,null,V(l.combinedConf.fonts,(x,b)=>(n(),w(wt,{key:b,label:b,"selected-font":x.value,fonts:l.fonts,"switch-font":o.switchFont,class:"font-picker"},null,8,["label","selected-font","fonts","switch-font"]))),128))])),p(xt,{disabled:e.currentState==="submitting","data-testid":"submit-button",appearance:"primary",class:"mt-6",onClick:o.handleSave},{icon:k(()=>[e.currentState==="submitting"?(n(),w(yt,{key:0,icon:"spinner",size:"16"})):E("",!0)]),default:k(()=>[M(" "+y(e.currentState==="submitting"?"Submitting...":"Save Changes"),1)]),_:1},8,["disabled","onClick"])]))])}B=A(st,[["render",kt],["__scopeId","data-v-9edd1469"]])});export{Jt as __tla,B as default};
