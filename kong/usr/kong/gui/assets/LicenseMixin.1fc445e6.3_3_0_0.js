/*
  This software is copyright Kong Inc. and its licensors.
  Use of the software is subject to the agreement between your organization
  and Kong Inc. If there is no such agreement, use is governed by and
  subject to the terms of the Kong Master Software License Agreement found
  at https://konghq.com/enterprisesoftwarelicense/.
*/

import{m as ne,n as Dt,_ as w,r as u,o,c as n,R as b,U as f,V as C,af as x,a as t,t as d,l as M,w as m,d as g,h as y,b as T,j as ce,G as k,i as de,p as me,e as he,O as Ct,ag as Mt,k as St,ah as $t,ad as _e,z as pe,Z as ue,J as Lt,__tla as At}from"./index.84d84090.3_3_0_0.js";import{_ as ge}from"./icon-help.699f8c28.3_3_0_0.js";import{g as Kt}from"./chartHelpers.1bf67333.3_3_0_0.js";let be,ve,fe,ye,ke,we,xe,Te,De,Et=Promise.all([(()=>{try{return At}catch{}})()]).then(async()=>{const Ce="/__km_base__/assets/logo-simple.a33de25b.3_3_0_0.svg?external",Me={name:"LicenseGrid",props:{licenseMetric:{type:Object,require:!0,default:()=>null},otherMetrics:{type:Object,default:()=>({})},hideLicense:{type:Boolean,default:!1},metricSlots:{type:Number,default:0},copyTransformer:{type:Function,default:null}},computed:{filteredMetrics(){return Object.fromEntries(Object.entries(this.otherMetrics).filter(([e,a])=>a.value!==null))},metricGridStyle(){return{width:`${100/(this.metricSlots||Object.keys(this.filteredMetrics).length+1)}%`}},licenseReport(){return JSON.stringify(typeof this.copyTransformer=="function"?this.copyTransformer():{})}},methods:{...ne(Dt,["notify"]),formatValue(e){return e?e.toLocaleString("en"):"0"},downloadLicense(){const e=document.createElement("a");e.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(this.licenseReport)),e.setAttribute("download","licenseReport"),e.style.display="none",e.click()},copyLicense(e){if(!e(this.licenseReport))return this.notify({message:"error, failed to copy",type:"danger"});this.notify({message:"Successfully copied to clipboard",type:"success"})},formatError(e){return e==="--"?"error calculating":e},hasError(e){return e.value==="--"}}},Se={class:"license-grid"},$e=["data-testid"],Le={class:"value-display"},Ae={class:"metric-desc"},Ke=t("div",{tabindex:"0",role:"button"},[t("img",{class:"metric-help-icon",src:ge,alt:""})],-1),Ee={class:"metric-value"},Oe={key:0},Re={key:2},je={class:"value-display"},Ie=t("img",{class:"logo",src:Ce,alt:""},null,-1),Pe=[Ie],Fe={class:"value-body"},Ne={class:"metric-desc"},Ue=g(" Download license report "),Be=g(" Copy license report ");function Ge(e,a,s,p,c,i){const r=u("KTooltip"),l=u("KButton"),_=u("KDropdownItem"),v=u("KClipboardProvider"),Tt=u("KDropdownMenu");return o(),n("div",Se,[(o(!0),n(b,null,f(i.filteredMetrics,(h,le)=>(o(),n("div",{key:le,"data-testid":h.metric,class:C(["license-grid-metric","metric-secondary",{"has-error":i.hasError(h),"not-available":h.notAvailable}]),style:x(i.metricGridStyle)},[t("div",Le,[t("div",Ae,[t("div",null,d(h.metric),1),h.helpText?(o(),M(r,{key:0},{content:m(()=>[g(d(h.helpText),1)]),default:m(()=>[Ke]),_:2},1024)):y("",!0)]),t("div",Ee,[h.notAvailable?(o(),n("strong",Oe,"--")):h.total?(o(),n(b,{key:1},[g(d(i.formatError(i.formatValue(h.value)))+"/",1),t("strong",null,d(i.formatValue(h.total)),1)],64)):(o(),n("strong",Re,d(i.formatError(i.formatValue(h.value))),1))])])],14,$e))),128)),t("div",{class:C(["license-grid-metric","metric-primary",{"metric-hidden":s.hideLicense}]),style:x(i.metricGridStyle)},[t("div",je,[Number.isNaN(Number(s.licenseMetric.value)/Number(s.licenseMetric.total))?y("",!0):(o(),n("div",{key:0,style:x(`--value: ${(100*Number(s.licenseMetric.value)/Number(s.licenseMetric.total)).toFixed(2)}`),class:"progress"},Pe,4)),t("div",Fe,[t("span",Ne,d(s.licenseMetric.metric),1),t("span",{class:C([{"has-error":i.hasError(s.licenseMetric)},"metric-value"])},[T(Tt,null,{default:m(()=>[t("strong",null,[T(l,{"show-caret":"",appearance:"btn-link"},{default:m(()=>[g(d(i.formatError(i.formatValue(s.licenseMetric.value)))+" days ",1)]),_:1})])]),items:m(()=>[T(_,{"data-testaction":"action-download",onClick:a[0]||(a[0]=h=>i.downloadLicense(e.item))},{default:m(()=>[Ue]),_:1}),T(v,null,{default:m(({copyToClipboard:h})=>[T(_,{"data-testaction":"action-copy",onClick:le=>i.copyLicense(h)},{default:m(()=>[Be]),_:2},1032,["onClick"])]),_:1})]),_:1})],2)])])],6)])}ke=w(Me,[["render",Ge]]);const qe={name:"KMetricTabs",props:{tabs:{type:Array,required:!0},value:{type:String,default:"",validator(e){return e===""||e.includes("#")&&!e.includes(" ")}}},emits:["changed"],data(){return{activeTab:this.value?this.value:this.tabs[0].hash}},watch:{value(e){this.activeTab=e,this.$emit("changed",e)}},methods:{handleTabChange(e){e.slot&&(this.activeTab=e.hash,this.$emit("changed",this.activeTab))}}},Ve=e=>(me("data-v-bc6766ff"),e=e(),he(),e),ze={class:"k-tabs k-metric-tabs","data-testid":"k-metric-tabs"},We={class:"tab-header"},He={class:"tab-labels",role:"tablist","aria-label":"kMetricTabs"},Je=["aria-selected","aria-controls","data-testid","onKeydown","onClick"],Xe={class:"tab-link"},Ze={class:"tab-label"},Qe=Ve(()=>t("div",{tabindex:"0",role:"button"},[t("img",{class:"tab-icon",src:ge,alt:""})],-1)),Ye={class:"tab-value"},et=["data-testid"],tt={class:"tab-actions"},st={class:"tab-content"},at=["id","aria-labelledby"];function it(e,a,s,p,c,i){const r=u("KTooltip");return o(),n("div",ze,[t("div",We,[t("ul",He,[(o(!0),n(b,null,f(s.tabs,(l,_)=>(o(),n("li",{key:l.hash,"aria-selected":c.activeTab===l.hash?"true":"false","aria-controls":`panel-${_}`,class:C([{active:c.activeTab===l.hash},"tab-item"]),"data-testid":`${l.hash.replace("#","")}-tab`,tabindex:"0",role:"tab",onKeydown:[ce(de(v=>i.handleTabChange(l.hash),["prevent"]),["enter"]),ce(de(v=>i.handleTabChange(l.hash),["prevent"]),["space"])],onClick:v=>i.handleTabChange(l)},[t("a",Xe,[t("div",Ze,[k(e.$slots,`${l.hash.replace("#","")}-anchor`,{},()=>[g(d(l.title),1)],!0),l.tip?(o(),M(r,{key:0},{content:m(()=>[g(d(l.tip),1)]),default:m(()=>[Qe]),_:2},1024)):y("",!0)]),t("div",Ye,[t("span",{"data-testid":`${l.hash.replace("#","")}`},d(l.value.value),9,et)])])],42,Je))),128))]),t("div",tt,[k(e.$slots,"actions",{},void 0,!0)])]),t("div",st,[(o(!0),n(b,null,f(s.tabs,(l,_)=>(o(),n("div",{id:`panel-${_}`,key:l.hash,"aria-labelledby":`${l.hash.replace("#","")}-tab`,role:"tabpanel",tabindex:"0",class:"tab-container"},[c.activeTab===l.hash?k(e.$slots,l.hash.replace("#",""),{key:0},void 0,!0):y("",!0)],8,at))),128))])])}ye=w(qe,[["render",it],["__scopeId","data-v-bc6766ff"]]);const ot={name:"DashboardWidget",props:{title:{type:String,default:""},noBorder:{type:Boolean,default:!1}}};function rt(e,a,s,p,c,i){const r=u("KCard");return o(),M(r,{"border-variant":s.noBorder?"noBorder":void 0},Ct({actions:m(()=>[k(e.$slots,"widgetActions")]),body:m(()=>[t("div",null,[k(e.$slots,"content")])]),_:2},[s.title?{name:"title",fn:m(()=>[g(d(s.title),1)])}:void 0]),1032,["border-variant"])}let S,$,L,A,K,E,O,R,j,I,P,F,N,U,B,G,q,V,z,W,H,D,J,X,Z,Q,Y,ee,te,se,ae,ie,oe,re;xe=w(ot,[["render",rt]]),S="/__km_base__/assets/icon-add.4bfde7b3.3_3_0_0.svg",$="/__km_base__/assets/icon-arrow-dropdown.965ae91e.3_3_0_0.svg",L="/__km_base__/assets/icon-chart.7beaca79.3_3_0_0.svg",A="/__km_base__/assets/icon-chevron-right.3b236775.3_3_0_0.svg",K="/__km_base__/assets/icon-cloud.2f6f62cd.3_3_0_0.svg",E="/__km_base__/assets/icon-descendent.07004225.3_3_0_0.svg",O="/__km_base__/assets/icon-empty-table.dbb0b754.3_3_0_0.svg",R="/__km_base__/assets/icon-error.9a9f8931.3_3_0_0.svg",j="/__km_base__/assets/icon-expand-less.8cedaa2c.3_3_0_0.svg",I="/__km_base__/assets/icon-grow.31da522d.3_3_0_0.svg",P="/__km_base__/assets/icon-help.1393df2a.3_3_0_0.svg",F="/__km_base__/assets/icon-kong-entity.fc5f0b6e.3_3_0_0.svg",N="/__km_base__/assets/icon-lock.6241987d.3_3_0_0.svg",U="/__km_base__/assets/icon-more-horiz.68908f49.3_3_0_0.svg",B="/__km_base__/assets/icon-more-vert.fb51b2fc.3_3_0_0.svg",G="/__km_base__/assets/icon-multiple.a8ee62d4.3_3_0_0.svg",q="/__km_base__/assets/icon-speed.0c583c06.3_3_0_0.svg",V="/__km_base__/assets/icon-stardust.ccde125d.3_3_0_0.svg",z="/__km_base__/assets/icon-warning-filled.121ffedb.3_3_0_0.svg",W="/__km_base__/assets/icon-warning.827c2d49.3_3_0_0.svg",H="/__km_base__/assets/kong-text-black.53297d6f.3_3_0_0.svg?external",D=e=>(me("data-v-b637b02d"),e=e(),he(),e),J={class:"free-mode-container"},X={class:"free-mode-content"},Z=D(()=>t("p",{class:"free-mode-title"},[t("img",{class:"free-mode-kong",src:H,alt:"Kong"}),t("span",{class:"free-mode-gradient"}," Konnect ")],-1)),Q=D(()=>t("p",{class:"free-mode-description"}," The easiest way to get started with Kong Gateway. ",-1)),Y={class:"free-mode-list"},ee=["src"],te={class:"free-mode-item-description"},se={class:"free-mode-footer"},ae=g(" Get Started "),ie=D(()=>t("span",{class:"free-mode-footer-description"}," No credit card required & free plan available ",-1)),oe=D(()=>t("div",{class:"free-mode-image"},null,-1)),re=Mt({__name:"FreeModeCTA",setup(e){const a=[{icon:"cloud",text:"Simplify Gateway operations with Konnect's SaaS control plane"},{icon:"multiple",text:"Test drive enterprise-grade plugins like OpenID Connect, mTLS, and OPA"},{icon:"chart",text:"Out of the box API Analytics"},{icon:"speed",text:"Streamline Kong Gateway upgrades"},{icon:"grow",text:"Deploy an API Dev Portal with registration management"}],s=c=>new URL(Object.assign({"../../assets/images/icon-add.svg":S,"../../assets/images/icon-arrow-dropdown.svg":$,"../../assets/images/icon-chart.svg":L,"../../assets/images/icon-chevron-right.svg":A,"../../assets/images/icon-cloud.svg":K,"../../assets/images/icon-descendent.svg":E,"../../assets/images/icon-empty-table.svg":O,"../../assets/images/icon-error.svg":R,"../../assets/images/icon-expand-less.svg":j,"../../assets/images/icon-grow.svg":I,"../../assets/images/icon-help.svg":P,"../../assets/images/icon-kong-entity.svg":F,"../../assets/images/icon-lock.svg":N,"../../assets/images/icon-more-horiz.svg":U,"../../assets/images/icon-more-vert.svg":B,"../../assets/images/icon-multiple.svg":G,"../../assets/images/icon-speed.svg":q,"../../assets/images/icon-stardust.svg":V,"../../assets/images/icon-warning-filled.svg":z,"../../assets/images/icon-warning.svg":W})[`../../assets/images/icon-${c}.svg`],self.location).href,p="https://konghq.com/products/kong-konnect/register?utm_medium=product&utm_source=gateway-free-ui&utm_campaign=gateway-konnect&utm_content=main-cta";return(c,i)=>{const r=u("KButton"),l=u("KCard");return o(),M(l,null,{body:m(()=>[t("div",J,[t("div",X,[Z,Q,t("ul",Y,[(o(),n(b,null,f(a,_=>t("li",{key:_.text,class:"free-mode-item"},[t("img",{src:s(_.icon),alt:"",class:"free-mode-icon"},null,8,ee),t("span",te,d(_.text),1)])),64))]),t("div",se,[T(r,{appearance:"primary",to:p,size:"small"},{default:m(()=>[ae]),_:1}),ie])]),oe])]),_:1})}}}),fe=w(re,[["__scopeId","data-v-b637b02d"]]);const lt={name:"DashboardChartTooltip",props:{tooltipModel:{type:Object,default:null},title:{type:[String,Function],default:""}},data(){return{formattedTitle:"",show:!1,top:"45px",left:0,time:"",colors:null,body:null}},computed:{toolTipStyle(){return{top:this.top,left:this.left}}},watch:{tooltipModel:{handler(){if(!this.tooltipModel||this.tooltipModel.opacity===0||!this.tooltipModel.dataPoints||!this.tooltipModel.dataPoints[0]){this.show=!1;return}const e=this.tooltipModel.caretX,a=e-250,s=e+50,p=Array(5).fill(0).reduce((c,i,r)=>({...c,[`${r+1}xx`]:`Status ${r+1}xx`}),{});this.left=(a>0?a:s)+"px",this.time=this.tooltipModel.title[0],this.colors=this.tooltipModel.labelColors,this.body=this.tooltipModel.body||[],this.body.forEach(c=>{c.lines[0]=p[c.lines[0]]}),this.formattedTitle=typeof this.title=="function"?this.title(this.tooltipModel):this.title,this.show=!0}}},methods:{itemStyle(e){const{backgroundColor:a}=this.colors[e];return{"background-color":a}}}},nt={class:"tooltip-body"},ct={class:"tooltip-title"},dt={class:"pr-2 font-bold"},mt={class:"ml-auto"},ht={class:"tooltip-list"},_t={class:"tooltip-text"};function pt(e,a,s,p,c,i){return St((o(),n("ul",{style:x(i.toolTipStyle),class:"chart-tooltip"},[t("div",nt,[t("div",ct,[t("div",dt,d(c.formattedTitle),1),t("div",mt,d(c.time),1)]),t("div",ht,[(o(!0),n(b,null,f(c.body,(r,l)=>(o(),n("div",{key:l,class:"tooltip-item"},[t("div",{style:x(i.itemStyle(l)),class:"tooltip-key"},null,4),t("div",_t,[(o(!0),n(b,null,f(r.lines,(_,v)=>(o(),n("div",{key:_,class:C(["tooltip-text-item",{"tooltip-text-label":v===0,"tooltip-text-value":v===1}])},d(_),3))),128))])]))),128))])])],4)),[[$t,c.show]])}ve=w(lt,[["render",pt],["__scopeId","data-v-ec2f7625"]]),we={name:"DashboardLineChartWrapper",props:{vitalsEnabled:{type:Boolean,default:!1},height:{type:Number,default:200},rawData:{type:Object,default:null},timeFrame:{type:Object,default:null},isUtc:{type:Boolean,default:!1}},emits:["chart-data"],data(){return{tooltipModel:null,chartData:{labels:[],datasets:[]}}},watch:{rawData:{handler(){this.chartData=this.getChartData(),this.$emit("chart-data",this.chartData)}},isUtc:{handler(){this.chartData=Object.assign({},this.chartData)}}},methods:{getHslaFromColorObj:Kt,drawTooltip({tooltip:e}){this.tooltipModel=Object.assign({},e)},getChartData(){throw new Error("chart must implement getChartData")},getTimeRange(e){let a=e.interval_width||this.timeFrame.stepSize;a=parseInt(a,10);const s=Math.floor(e.clientEndTimestamp/a)*a,p=s-this.timeFrame.timeFrameLength+a,c=[];for(let r=p;r<=s;r+=a)c.push(r);const i=c.filter(r=>r%this.timeFrame.ticksMod===0);return{range:c,labels:i}},initDataset(e,a){return e.reduce((s,p)=>(s[p]=a,s),{})},timeTicksFormat(e,a,s){return e=_e(s[a].value),this.isUtc&&(e=e.utc()),e.format("h:mm A")},timeParser(e){return e=_e.unix(e),this.isUtc&&(e=e.utc()),e}}};const ut={name:"ChartComplexHeader",props:{title:{type:String,default:""},legend:{type:Array,default:()=>[]}},methods:{formatCount(e){return e.toLocaleString("en")}}},gt={class:"chart-complex-header"},bt={class:"chart-header-title"},vt={key:0,class:"chart-header-legend"},ft={class:"chart-header-legend-item-text"},yt={key:0,class:"chart-header-legend-item-count"},kt={class:"chart-header-legend-item-extra"},wt={key:1,class:"chart-header-extra"};function xt(e,a,s,p,c,i){return o(),n("div",gt,[t("div",bt,d(s.title),1),s.legend?(o(),n("div",vt,[(o(!0),n(b,null,f(s.legend,r=>(o(),n("div",{key:r.label,class:"chart-header-legend-item"},[t("div",{style:x({backgroundColor:r.color}),class:"chart-header-legend-item-box"},null,4),t("div",ft,d(r.label),1),r.count!==null&&r.count!==void 0?(o(),n("div",yt,d(i.formatCount(r.count)),1)):y("",!0),t("div",kt,[k(e.$slots,"itemExtra",{item:r},void 0,!0)])]))),128))])):y("",!0),s.legend&&s.legend.length>0?(o(),n("div",wt,[k(e.$slots,"extra",{},void 0,!0)])):y("",!0)])}be=w(ut,[["render",xt],["__scopeId","data-v-cf3e8029"]]),De={"2xx":["rgba(132, 229, 174, 1)","rgba(192, 242, 213, 1)"],"3xx":["rgba(22, 159, 204, 1)","rgba(145, 225, 252, 1)"],"4xx":["rgba(255, 154, 153, 1)","rgba(255, 204, 204, 1)"],"5xx":["rgba(255, 120, 119, 1)","rgba(255, 154, 153, 1)"]},Te={data(){return{licenseReport:null}},computed:{...pe(ue,["infoLicense"]),...pe(Lt,["workspaces"]),workspacePermissions(){return this.workspaces.reduce((e,a)=>(e[a.name]={admins:this.$rbac.isAllowed(this.perms,[{path:"/admins/",actions:["read"]}],a.name),rbacUsers:this.$rbac.isAllowed(this.perms,[{path:"/rbac/users/",actions:["read"]}],a.name),roles:this.$rbac.isAllowed(this.perms,[{path:"/rbac/roles/",actions:["read"]}],a.name)},e),{})},workspacesWithAdminPermission(){return this.workspaces.filter(e=>this.workspacePermissions[e.name].admins)},hasLicenseInfo(){return this.infoLicense},licenseUsageDays(){if(!this.infoLicense)return 0;const e=new Date().getTime()-new Date(this.infoLicense.license_creation_date).getTime();return e<0?this.licenseExpirationDays:e/(24*60*60*1e3)},licenseExpirationDays(){return this.licenseTotalDays-this.licenseUsageDays>0?this.licenseTotalDays-this.licenseUsageDays:0},licenseTotalDays(){return this.infoLicense?(new Date(this.infoLicense.license_expiration_date).getTime()-new Date(this.infoLicense.license_creation_date).getTime())/(24*60*60*1e3):0},licenseRequestCounters(){return!this.licenseReport||!this.licenseReport.counters?0:this.licenseReport.counters.reduce((e,a)=>e+a.request_count,0)}},watch:{workspacesWithAdminPermission:{async handler(e){e.length>0&&(this.getInfo({workspace:e[0].name,silent:!0}),this.licenseReport=(await this.$api.getLicenseReport(e[0].name)).data)},deep:!0,immediate:!0}},methods:{...ne(ue,["getInfo"])}}});export{be as C,ve as D,fe as F,ye as K,ke as L,we as _,Et as __tla,xe as a,Te as b,De as s};
