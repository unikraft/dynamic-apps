/*
  This software is copyright Kong Inc. and its licensors.
  Use of the software is subject to the agreement between your organization
  and Kong Inc. If there is no such agreement, use is governed by and
  subject to the terms of the Kong Master Software License Agreement found
  at https://konghq.com/enterprisesoftwarelicense/.
*/

import{_ as M,H as k,z as l,Q as D,Z as F,Y as P,aF as L,aG as q,a8 as d,a4 as u,r as n,c as N,l as c,w as m,h as p,b as _,o as h,d as C,__tla as T}from"./index.84d84090.3_3_0_0.js";import{E as x,__tla as A}from"./EntityForm.c5492e4f.3_3_0_0.js";import{F as U,__tla as B}from"./FormActions.1911524f.3_3_0_0.js";import{F as w,__tla as V}from"./FormPage.4b74a91a.3_3_0_0.js";import{F as I}from"./FormActionsMixin.54cda7d6.3_3_0_0.js";import{R as O}from"./RedirectMixin.efeb36f2.3_3_0_0.js";import{g as H,__tla as W}from"./Route.a29fff26.3_3_0_0.js";import{c as j}from"./index.6d4e40f9.3_3_0_0.js";import{__tla as z}from"./monaco-editor.90904fcf.3_3_0_0.js";import{__tla as G}from"./ConfirmModalDialog.af276128.3_3_0_0.js";import{__tla as K}from"./EntityDeleteModal.673d985c.3_3_0_0.js";import{__tla as Q}from"./EntityMixin.2764673d.3_3_0_0.js";import{__tla as Y}from"./EntityButton.1838e0e9.3_3_0_0.js";import{__tla as Z}from"./EntityFilter.bf4158bc.3_3_0_0.js";import"./ArrayCardContainerFields.468b3825.3_3_0_0.js";import"./typedefs.6c779761.3_3_0_0.js";import"./transform.db23dc95.3_3_0_0.js";import"./marked.esm.77963db0.3_3_0_0.js";let f,J=Promise.all([(()=>{try{return T}catch{}})(),(()=>{try{return A}catch{}})(),(()=>{try{return B}catch{}})(),(()=>{try{return V}catch{}})(),(()=>{try{return W}catch{}})(),(()=>{try{return z}catch{}})(),(()=>{try{return G}catch{}})(),(()=>{try{return K}catch{}})(),(()=>{try{return Q}catch{}})(),(()=>{try{return Y}catch{}})(),(()=>{try{return Z}catch{}})()]).then(async()=>{const g={name:"RouteForm",components:{EntityForm:x,PageHeader:k,FormActions:U},mixins:[w,I,O],props:{redirectRouteNames:{type:Object,default:()=>({})},hideAutoSuggest:{type:Boolean,default:!1},hideBreadcrumbs:{type:Boolean,required:!1,default:!1},hidePageTitle:{type:Boolean,required:!1,default:!1},hideSubmit:{type:Boolean,required:!1,default:!1},serviceId:{type:String,required:!1,default:""}},emits:["clicked-submit","model-updated"],data(){return{fields:this.$route.params.fields,formModel:null,originalModel:null}},computed:{...l(D,{getSupportDocs:"entityDoc"}),...l(F,{config:"infoConfig"}),schema(){return H(this.config.router_flavor)},docsLink(){return this.getSupportDocs("route")},id(){return this.$route.params.id},title(){if(!this.isEditing)return"Create Route";let t=P(this.originalModel,"routes");return t?(L(t)&&(t=t.split("-")[0].trim()),`Edit Route: ${t}`):"Edit Route"},resourceEndpoint(){var i,s;const t=!!(this.$route.query.entity_type&&this.$route.query.entity_id),e=((i=this.formModel)==null?void 0:i["service-id"])??((s=this.originalModel)==null?void 0:s["service-id"])??this.serviceId;return!this.isEditing&&t||this.isEditing&&e?`services/${e}/routes`:this.isEditing&&this.fields&&this.fields.service_id?`services/${this.fields.service_id}/routes`:"routes"},returnLink(){const t=this.resourceEndpoint.match(new RegExp(q));if(!this.hideSubmit)return this.redirectPath?this.redirectPath:t&&this.$route.query.entity_id?`/services/${t}`:this.isEditing?`/routes/${this.id}`:this.$route.params.returnLink}},methods:{createRecord(t){var s;const e=this.$route.params.services;d.trackEvent(e?d.EVENTS.ROUTE_ADDED_FROM_SERVICE:d.EVENTS.ROUTE_ADDED);let i="routes";return(s=t.service)!=null&&s.id&&(i=`services/${t.service.id}/routes`),this.$api.createRecord(i,t).then(o=>{if(this.hideSubmit)return o.data;const r=this.redirectRouteNames.create;return r?r==="-1"?this.$router.go(-1):this.$router.push({name:r,params:this.$router.params}):(this.returnLink?this.$router.push({path:this.returnLink}):u(this.$router,201,this.redirectRoute)(o),o.data)})},updateRecord(t){var i,s;let e="routes";return((i=t.service)==null?void 0:i.id)&&((s=this.originalModel)==null?void 0:s["service-id"])&&(e=`services/${this.originalModel["service-id"]}/routes`),this.$api.updateRecord(e,this.id,t).then(o=>{const r=this.redirectPath||this.returnLink||this.$route.params.returnLink,a=this.redirectRouteNames&&this.redirectRouteNames.update;return a?a==="-1"?this.$router.go(-1):this.$router.push({name:a,params:this.$router.params}):r?this.$router.push({path:r}):(u(this.$router,200,{name:this.resourceEndpoint})(o),o.data)})},deleteRecord(){if(this.hideSubmit)return;const t=this.$route.query.entity_id;let e=this.originalModel&&this.originalModel["service-id"],i;return this.postDeletePath&&!this.$route.path.startsWith(this.postDeletePath)?i={path:this.postDeletePath}:this.redirectRouteNames.delete?i={name:this.redirectRouteNames.delete}:t?(e=e.split(",")[0],i={path:`/services/${e}`}):e?i={path:"/routes"}:i={name:this.resourceEndpoint},this.$api.deleteRecord(this.resourceEndpoint,this.id).then(u(this.$router,204,i,{replace:!0}))},handleModelUpdate(t,e){this.formModel=t,this.originalModel=e,this.$emit("model-updated",t)},transformRecord(t){const e=j(t);return this.schema.snis&&this.schema.snis.visible&&!this.schema.snis.visible(t)&&(e.snis=null),e.service&&!e.service.id&&(e.service=null),e}}},y={class:"route-form form-container"},E=C(" View documentation ");function $(t,e,i,s,o,r){const a=n("KExternalLink"),v=n("FormActions"),b=n("PageHeader"),R=n("EntityForm");return h(),N("section",y,[i.hidePageTitle?p("",!0):(h(),c(b,{key:0,title:r.title},{default:m(()=>[_(a,{href:r.docsLink},{default:m(()=>[E]),_:1},8,["href"]),t.isEditing&&!i.hideSubmit?(h(),c(v,{key:0,"primary-disabled":t.isSaveActionDisabled,onSave:t.handleFormSave,onCancel:t.handleFormCancel},null,8,["primary-disabled","onSave","onCancel"])):p("",!0)]),_:1},8,["title"])),_(R,{ref:"form","is-editing":t.isEditing,"show-confirmation-dialog":t.isEditing,"prevent-submission-before-change":t.isEditing,schema:r.schema,fields:o.fields,"button-text":t.buttonText,"on-load":t.onFormLoad,"on-submit":t.onFormSubmit,"on-delete":t.onDeleteWhenEditing,"resource-endpoint":r.resourceEndpoint,"hide-submit":i.hideSubmit,"redirect-route-after-delete":{name:"routes"},"entity-name":"Route",entity:"routes",onClickedSubmit:e[0]||(e[0]=S=>t.$emit("clicked-submit",S)),onModelUpdated:r.handleModelUpdate},null,8,["is-editing","show-confirmation-dialog","prevent-submission-before-change","schema","fields","button-text","on-load","on-submit","on-delete","resource-endpoint","hide-submit","onModelUpdated"])])}f=M(g,[["render",$]])});export{J as __tla,f as default};
