/*
  This software is copyright Kong Inc. and its licensors.
  Use of the software is subject to the agreement between your organization
  and Kong Inc. If there is no such agreement, use is governed by and
  subject to the terms of the Kong Master Software License Agreement found
  at https://konghq.com/enterprisesoftwarelicense/.
*/

import{_ as D,z as R,Z as L,D as Z,r as o,c as f,a as u,b as y,w as d,h as v,l as p,o as r,d as m,t as b,R as G,U as H,p as J,e as N,__tla as W}from"./index.84d84090.3_3_0_0.js";let x,Q=Promise.all([(()=>{try{return W}catch{}})()]).then(async()=>{const F={services:["id","name"],routes:["id","name"],consumers:["id","username"],plugins:["id"],certificates:["id"],ca_certificates:["id"],snis:["id","name"],upstreams:["id","name"],developers:["id"]},k={name:"EntityFilter",props:{entity:{type:String,default:()=>"",required:!0},fields:{type:Object,default:()=>({}),required:!0},schema:{type:Object,default:()=>({}),required:!1}},data:function(){return{showMenus:!1,params:{},filterText:"Filters",exactMatchFields:F}},computed:{...R(L,{datastore:"infoDatastore"}),isExactMatch(){return!(this.datastore&&this.datastore.type==="postgres")&&this.exactMatchFields[this.entity]},searchableFields(){return this.isExactMatch?this.exactMatchFields[this.entity].map(e=>({text:e,value:e})):Object.keys(this.fields).filter(e=>this.fields[e].searchable).map(e=>({text:this.fields[e].label||e,value:e}))},filterParams(){if(!this.isExactMatch)return this.params;const e=this;return new Proxy(this.params,{set(a,s,c){return e.params={[s]:c},!0}})}},methods:{capitalize:Z,clearFilters(e){e!==null&&e.length>0?(delete this.params[e],this.applyFilters()):(this.params={},this.$parent.$parent.$refs.entitylist.clearSearch(),this.filterText="Filters")},applyFilters(e=!1){e&&(this.showMenus=!1);const a=new URLSearchParams;if(this.isExactMatch){const c=Object.entries(this.params).filter(([n,t])=>t!==null&&t.length>0).map(([n,t])=>t);c.length>0&&a.append("id",c[0])}else for(let[c,n]of Object.entries(this.params))n!==null&&(Array.isArray(n)&&(n=n.join(",")),a.append(c,n));this.filterText=Array.from(a).length>0?"Filters ("+Array.from(a).length+")":"Filters";const s=a.toString();this.$parent.$parent.$refs.entitylist.query=s},buildSelectOption(e){const a=[];return e.forEach(s=>{a.push({label:s,value:s})}),a},toggleMenus(){this.showMenus=!this.showMenus},getFieldId(e){return`${this.entity}-filter-${e}`}}},M=e=>(J("data-v-ee7e5ba9"),e=e(),N(),e),w={key:0,class:"flex items-center mx-5 dropdown-panel entity-filter"},_={class:"flex"},V={class:"filter-label"},C={key:0,class:"filter-indicator"},P={class:"flex-col w-full mt-1"},E={class:"flex w-full justify-between"},I=M(()=>u("span",{class:"self-center mr-3"},"Filter By: ",-1)),U=["for"],j={class:"flex wt-1 w-full menu-ctx-button"},$=m(" Apply "),O=m(" Clear "),S={class:"w-full flex menu-ctx-button ml-2"},z=m(" Clear all sorting and filters ");function A(e,a,s,c,n,t){const h=o("KButton"),K=o("KSelect"),g=o("KInput"),T=o("KMenuItem"),q=o("KMenu");return t.searchableFields.length?(r(),f("div",w,[u("div",_,[y(h,{class:"filter-button ml-auto",appearance:"btn-link","data-testid":"filter-button",onClick:t.toggleMenus},{default:d(()=>[m(b(e.filterText),1)]),_:1},8,["onClick"])]),e.showMenus?(r(),f("div",{key:0,class:"panel-background",onClick:a[0]||(a[0]=(...l)=>t.toggleMenus&&t.toggleMenus(...l))})):v("",!0),e.showMenus?(r(),p(q,{key:1,class:"mt-2 btn-panel filter-menus"},{body:d(()=>[(r(!0),f(G,null,H(t.searchableFields,(l,B)=>(r(),p(T,{key:l.value,"last-menu-item":B===t.searchableFields.length-1,"data-testid":l.value,expandable:"",class:"my-2",size:"small"},{itemTitle:d(()=>[u("span",V,[m(b(t.capitalize(l.text))+" ",1),l.value in e.params&&e.params[l.value]!==null?(r(),f("span",C)):v("",!0)])]),itemBody:d(()=>[u("div",P,[u("div",E,[I,u("label",{for:t.getFieldId(l.value),class:"sr-only"},b(s.entity)+" "+b(l.value),9,U),s.schema[l.value].type==="select"?(r(),p(K,{key:0,id:t.getFieldId(l.value),modelValue:t.filterParams[l.value],"onUpdate:modelValue":i=>t.filterParams[l.value]=i,width:"auto",appearance:"select",items:s.schema[l.value].values.map(i=>({value:i,label:i}))},null,8,["id","modelValue","onUpdate:modelValue","items"])):s.schema[l.value].type==="number"?(r(),p(g,{key:1,id:t.getFieldId(l.value),modelValue:t.filterParams[l.value],"onUpdate:modelValue":i=>t.filterParams[l.value]=i,type:"number",size:"small",class:"w-full",placeholder:"Enter a value"},null,8,["id","modelValue","onUpdate:modelValue"])):(r(),p(g,{key:2,id:t.getFieldId(l.value),modelValue:t.filterParams[l.value],"onUpdate:modelValue":i=>t.filterParams[l.value]=i,placeholder:"Enter a value"},null,8,["id","modelValue","onUpdate:modelValue"]))]),u("div",j,[y(h,{class:"pl-0 pb-0",appearance:"outline","data-testid":"apply-filters",onClick:t.applyFilters},{default:d(()=>[$]),_:1},8,["onClick"]),y(h,{class:"ml-auto pr-0 pb-0",appearance:"outline","data-testid":"clear-filters",onClick:i=>t.clearFilters(l.value)},{default:d(()=>[O]),_:2},1032,["onClick"])])])]),_:2},1032,["last-menu-item","data-testid"]))),128))]),actionButton:d(()=>[u("div",S,[y(h,{onClick:t.clearFilters},{default:d(()=>[z]),_:1},8,["onClick"])])]),_:1})):v("",!0)])):v("",!0)}x=D(k,[["render",A],["__scopeId","data-v-ee7e5ba9"]])});export{x as E,Q as __tla};
