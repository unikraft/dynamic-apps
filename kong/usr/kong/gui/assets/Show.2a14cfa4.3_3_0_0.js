/*
  This software is copyright Kong Inc. and its licensors.
  Use of the software is subject to the agreement between your organization
  and Kong Inc. If there is no such agreement, use is governed by and
  subject to the terms of the Kong Master Software License Agreement found
  at https://konghq.com/enterprisesoftwarelicense/.
*/

import{$ as T,aR as V,J as na,av as da,z as F,m,_ as C,r as p,o as r,c as h,af as ca,R as k,U as I,l as v,w as u,d as y,t as x,h as w,a as o,b as c,V as Y,j as ha,i as pa,k as N,ah as ua,p as B,e as R,aN as ma,T as U,n as z,g as O,v as L,F as P,O as Aa,__tla as fa}from"./index.84d84090.3_3_0_0.js";import{f as ga}from"./fileHelper.9aab3c0f.3_3_0_0.js";import{E,__tla as ya}from"./EntityMixin.2764673d.3_3_0_0.js";import{W as Fa,__tla as ba}from"./WorkspaceMixin.71f3f83c.3_3_0_0.js";import{e as J}from"./extensionsMap.44b2ff6b.3_3_0_0.js";import{__tla as va}from"./monaco-editor.90904fcf.3_3_0_0.js";import{__tla as Ca}from"./EntityButton.1838e0e9.3_3_0_0.js";import{__tla as wa}from"./EntityFilter.bf4158bc.3_3_0_0.js";let q,Ma=Promise.all([(()=>{try{return fa}catch{}})(),(()=>{try{return ya}catch{}})(),(()=>{try{return ba}catch{}})(),(()=>{try{return va}catch{}})(),(()=>{try{return Ca}catch{}})(),(()=>{try{return wa}catch{}})()]).then(async()=>{const K=T("editor-contextmenu",{state:()=>({actionCtx:null,actionType:null,contextMenuX:0,contextMenuY:0,showContextMenu:!1}),getters:{contextMenuStyle:({contextMenuX:e,contextMenuY:t})=>({left:`${e}px`,top:`${t+64}px`})},actions:{openContextMenu(e){var d;const t=document.querySelector(".editor-sidebar"),{top:a=0}=((d=t==null?void 0:t.getBoundingClientRect)==null?void 0:d.call(t))??{},{event:n,type:i,ctx:l}=e;this.contextMenuX=n.clientX,this.contextMenuY=n.clientY-a,this.actionType=i,this.actionCtx=l,this.showContextMenu=!0},closeContextMenu(){this.actionType=null,this.actionCtx=null,this.showContextMenu=!1},clearContextMenuState(){this.$reset()}}}),Q=T("editor-errors",{state:()=>({showErrorPanel:!1,errorMessage:null}),actions:{openErrorPanel(e){this.showErrorPanel=!0,this.errorMessage=e||'Please select file with type "Page" to see Kong Portal Preview'},closeErrorPanel(){this.showErrorPanel=!1,this.errorMessage=null},toggleErrorPanel(e){this.showErrorPanel=e},clearErrorsState(){this.$reset()}}}),M={buildSidebarData(e){const t=[],a=[],n=[],i=[],l=[];return e.forEach(d=>{let s=d.path.split("/");s[0]==="content"?(s=s.slice(1),this.buildTreeNode(t,d,s[0],s)):s[0]==="specs"?(s=s.slice(1),this.buildTreeNode(n,d,s[0],s)):s[0]==="themes"?(s=s.slice(1),this.buildTreeNode(a,d,s[0],s)):s[0]==="emails"?(s=s.slice(1),this.buildTreeNode(i,d,s[0],s)):this.buildTreeNode(l,d,s[0],s)}),{root:this.sortTree(l,[{prop:"type",direction:-1},{prop:"name",direction:1}]),content:this.sortTree(t,[{prop:"type",direction:-1},{prop:"name",direction:1}]),themes:this.sortTree(a,[{prop:"type",direction:-1},{prop:"name",direction:1}]),specs:this.sortTree(n,[{prop:"type",direction:-1},{prop:"name",direction:1}]),emails:this.sortTree(i,[{prop:"type",direction:-1},{prop:"name",direction:1}])}},sortTree(e,t){for(const a in e){const n=e[a];n.children&&(n.children=this.sortTree(n.children,t))}return e.sort((a,n)=>{let i=0,l=0;for(;l<t.length&&i===0;)a[t[l].prop].toString()<n[t[l].prop].toString()?i=t[l].direction*-1:a[t[l].prop].toString()>n[t[l].prop].toString()?i=t[l].direction*1:i=t[l].direction*0,l++;return i}),e},buildTreeNode(e,t,a,n){if(!n||!n.length)return;const i=n[0];let l="folder";if(n.length===1){const s=ga.getFileType(t.type,t.contents);l="file",e.push({type:l,key:i,name:s?`${i}.${s}`:i,file:t,path:t.name||t.path});return}let d=e.find(s=>s.type===l&&s.key===i);d||(d={type:l,key:i,name:i,path:a,children:[]},e.push(d)),n.shift(),n[0]&&(a=`${a}/${n[0]}`),this.buildTreeNode(d.children,t,a,n)},findFilesInNode(e,t){if(e.type==="file"&&t.push(e.file),e.type==="folder"){const a=e;Object.keys(a.children).forEach(n=>{this.findFilesInNode(a.children[n],t)})}},replaceFolderName(e,t,a){return e.replace(t,a)},isContent(e){return e.path.startsWith("content/")||e.path.startsWith("specs/")||e.path.startsWith("emails/")},isImage(e){const t=/themes\/[\w-]+\/assets\/images\//;return e.path&&e.path.match(t)}},f=T("editor-modals",{state:()=>({modalCtx:null,errorCount:-1,showCreateFileModal:!1,showEditFileModal:!1,showDeleteFileModal:!1,showRenameFolderModal:!1,showDeleteFolderModal:!1,showUpdateFileServerErrorModal:!1,showUpdateFileErrorModal:!1,showUnsavedChangesModal:!1}),actions:{openCreateFileModal(){this.showCreateFileModal=!0},closeCreateFileModal(){this.showCreateFileModal=!1},openEditFileModal(e){this.modalCtx=e,this.showEditFileModal=!0},closeEditFileModal(){this.modalCtx=null,this.showEditFileModal=!1},openDeleteFileModal(e){this.modalCtx=e,this.showDeleteFileModal=!0},closeDeleteFileModal(){this.modalCtx=null,this.showDeleteFileModal=!1},openRenameFolderModal(e){this.modalCtx=e,this.showRenameFolderModal=!0},closeRenameFolderModal(){this.modalCtx=null,this.showRenameFolderModal=!1},openDeleteFolderModal(e){this.modalCtx=e,this.showDeleteFolderModal=!0},closeDeleteFolderModal(){this.modalCtx=null,this.showDeleteFolderModal=!1},openUpdateFileServerErrorModal(e){this.modalCtx=e,this.showUpdateFileServerErrorModal=!0},closeUpdateFileServerErrorModal(){this.modalCtx=null,this.showUpdateFileServerErrorModal=!1},openUpdateFileErrorModal(){this.errorCount=this.errorCount+1,this.showUpdateFileErrorModal=!0},closeUpdateFileErrorModal(){this.errorCount=-1,this.showUpdateFileErrorModal=!1},openUnsavedChangesModal(e){this.modalCtx=e,this.showUnsavedChangesModal=!0},closeUnsavedChangesModal(){this.modalCtx=null,this.showUnsavedChangesModal=!1},clearModalsState(){this.$reset()}}}),b=T("editor-files",{state:()=>({pages:[],selectedFile:null,code:null}),getters:{areChangesSaved:e=>!e.selectedFile||!e.selectedFile.file.contents?!0:e.selectedFile.file.contents===e.code},actions:{async fetchAllFiles(e=1e3){await V.getFilesByType(null,e).then(t=>{this.pages=t})},setCode(e){this.code=e},setSelectedFile(e,t=!1){let a=e;if(e&&!e.file&&(a={key:e.path,name:e.path,type:e.type||"file",file:e,path:e.path}),this.selectedFile=a,window.location.pathname.split("/").slice(3).join("/")!==(a==null?void 0:a.path)){const n=na();this.$router[t?"replace":"push"]({path:`/${n.workspace}/portal-editor/${e==null?void 0:e.path}`,state:a})}e&&(this.code=e.contents)},createFileAndRefresh(e){return V.createRecord("files",e).then(t=>{const a=t.data;this.fetchAllFiles().then(()=>{this.setSelectedFile(a)})})},async updateFile(e){let{contents:t=""}=e;e.path.trim().split(".").pop().toLowerCase()==="svg"&&(t=da(t)),V.updateRecord("files",e.id,{...e,contents:t}).then(a=>{const n=a.data;this.fetchAllFiles().then(()=>{this.setSelectedFile(n)})}).catch(a=>{const n=f();if(a.response&&a.response.data){n.openUpdateFileServerErrorModal(a.response.data);return}n.openUpdateFileErrorModal()})},async openFile(e,t){if(!this.areChangesSaved){f().openUnsavedChangesModal(e);return}return V.findRecord("files",e.path||e.file.path).then(a=>{this.setSelectedFile(a.data,t)})},async forceOpenFile(e){return V.findRecord("files",e.path||e.file.path).then(t=>{this.setSelectedFile(t.data)})},async deleteFile(e){return V.deleteRecord("files",e.id).then(()=>{this.fetchAllFiles().then(()=>{const t=this.selectedFile;t&&t.path===e.path&&this.setSelectedFile(null)})})},async deleteFolder(e){const t=[];M.findFilesInNode(e,t);for(let a=0;a<t.length;a++){const n=t[a];await V.deleteRecord("files",n.id)}this.fetchAllFiles()},async renameFolder({folder:e,oldName:t,newName:a}){const n=[];M.findFilesInNode(e,n);for(let i=0;i<n.length;i++){const l=n[0];l.name?l.name=M.replaceFolderName(l.name,t,a):l.path=M.replaceFolderName(l.path,t,a),await V.updateRecord("files",l.id,l)}this.fetchAllFiles()},clearFilesState(){this.$reset()}}}),D=T("editor",{state:()=>({layout:"split",iFrameFile:null}),actions:{setLayout(e){this.layout=e},setIframeFile(e){this.iFrameFile=e},clearEditorState(){this.$reset();const e=K(),t=Q(),a=b(),n=f();e.clearContextMenuState(),t.clearErrorsState(),a.clearFilesState(),n.clearModalsState()}}}),W={name:"ContextMenu",computed:{...F(K,{isVisible:"showContextMenu",actionCtx:"actionCtx",actionType:"actionType",contextMenuStyle:"contextMenuStyle"}),actions(){switch(this.actionType){case"file":return{open:{name:"Open File",action:"open"},rename:{name:"Rename File",action:"edit"},delete:{name:"Delete File",action:"delete"}};case"folder":return{rename:{name:"Rename Folder",action:"rename"},delete:{name:"Delete Folder",action:"delete"}};default:return{}}}},mounted(){window.onclick=()=>{this.isVisible&&this.closeContextMenu()}},methods:{...m(K,["closeContextMenu"]),...m(b,["openFile","setSelectedFile"]),...m(f,["openEditFileModal","openDeleteFileModal","openRenameFolderModal","openDeleteFolderModal"]),handleClick(e){this.actionType==="file"?this.handleFileAction(e):this.handleFolderAction(e),this.closeContextMenu()},handleFileAction(e){const t=this.actionCtx,a=t.file;switch(e){case"open":this.openFile(t);break;case"edit":this.openEditFileModal(a);break;case"delete":this.openDeleteFileModal(a);break}},handleFolderAction(e){const t=this.actionCtx;switch(e){case"rename":this.openRenameFolderModal(t);break;case"delete":this.openDeleteFolderModal(t);break}}}};function X(e,t,a,n,i,l){const d=p("KButton");return r(),h("section",null,[e.isVisible?(r(),h("div",{key:0,style:ca(e.contextMenuStyle),class:"context-menu"},[(r(!0),h(k,null,I(l.actions,s=>(r(),v(d,{key:s.name,"data-testid":`context-menu-action-${s.action}`,appearance:"primary",onClick:A=>l.handleClick(s.action)},{default:u(()=>[y(x(s.name),1)]),_:2},1032,["data-testid","onClick"]))),128))],4)):w("",!0)])}const Z=C(W,[["render",X]]),$="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAADg0lEQVR42tRWO28cVRQ+586d3dmHH8QxxokBF0g8lAYpCCILJVgoDRItLXRUNDSIIqmS9OQHEImKgiYRDaDECCWWQKLgISGFgGWCgr2D7YFld2bvvedw7sx4PY48pohSMKuZqz1zz/nu953HLjIzPMxLwUO+dPXLDxfPfiqEXn6QgIjw1Yn3P3vtQABg9I+JBzoyYb1EgcJfqJISvu/+T7vQDzT+WitRI+A4dQWqQvhOlm/JcRdVTr0MhvJ+X2H0GfCkxD5B4ht2sVcLkFqOtQ8k/hiqj4H4YhQqcM7fnIMUEBUqgXxDeo+NuySnh3RIcS0AAca5FzK4ESxGUQDtbgDJNj/ppStIsHzGEMQOjQCcHJsI6hnInh7nK0oQN8/y2qb6EUeDNRbPytn3X7zHS1jWM1BIPce7OuBsZqx33hEnC3xfxVUSi4iVMqV6BlGz1RukmSUirZSaBSLITMYKg2cVBO1cgL0zKyZgFWDogK6Jz3HxsVEzqgewxFuyJOI/E6A6qrWGoUm96j+z2i8JiWdbctRpatjaztplYSVljIMBhmk6UoibiGrGkpsgplXJx1BkSESGHR4XKmrR5mvj6PJffbNAxNNeJtm36WMckgOfXojLKkdi7kln3hPzGxJ8aq8jhcTO6GgKeDmYjmaxqIvcVyHWzyLlWwgl6HjC8rtRN7gtDXRvOLTnpdNza7adwvHlxe9Ff7j7+dqxcLKxm+GegkMAaHsI0NIxdMRsBUSp54nxNiv3kZZBIsCn85NaWGkuTFxxfevTXswuAaO+7eFwVA/w1NsvwtaPv/f+uHlXWl5Dozv1jMsMWGPuhFqf263gaK4D65/8JEo1oLNw5OksScAkFh5bWoiPPDdfD5AaAus49jJiEIAdDM6JTGdF4OuM7rqQWCmoujNiWxZmy2YweMnvRaEl4yROhVSr2rzVX7Rv3jkFutN8M5yKPmRH5VCqTB/EtbK7Fsf1ykX7oihokvQt+0925YUPVg9m0J6f9ss6OZc759h+yIXlKB0HLjDZcD52UWaXP1BjsrUud71EnWPzwt7eGGxsLIHDVyTwGQmzxJZb+YgrSzAfD5IQ1QykKvCmFMSKJORGa252VQX6kDIVLf2AlMctMnCr+8TkhWiuPbP55W+vhhONU0zu9WKfvmr+Hq0+evrxL9KNwZ/9O4nYvF2VMWpy8L/8V/GvAAMACCitjbm2noIAAAAASUVORK5CYII=",ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAWlBMVEUAAABVqv8zmf9Nmf9HqvE9o/VApPZDpPNCo/VBpfVBpvZCpfZDpPRBpPVCpfRBpvVCpPRBpPVCpvRCpfVCpfVCpfVCpfVBpfVCpfVCpfZCpfVCpfVCpfVCpfUmhWYrAAAAHXRSTlMAAwUKEhkcKjJKU1VfYo6gqbfCys7V3+Lj8vX3/pfpk5kAAABfSURBVCjP1dE3DoAwEAXRIWNyDoa9/zVpXBgji4aGaV+z+gufpla5tSoDmzhtBuTRT2Av9AMmETlLKhf6oBNpgPYOS0w0DiEQzTYcOZAmAGTagtoeu3o/1zu791EfdQG79x9oA7UZGAAAAABJRU5ErkJggg==",te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAAMFBMVEX///+BgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHndNq1AAAAD3RSTlMAECAwQGBwgJCgsMDQ4PC8YWy5AAAAd0lEQVQY02NgIBdwbkTi2H9F4sz/g2Azvv9vAOewfv/fAOfwXLj/AKG/oB9hwnwF+19wzisGnv8KMP2/y6v/F0A53P+B4AKUo7/FxeX+FyinPwCIf0I570Cy/wXAbLYfIHuhJuT/Ahqr9/8bmPP//xcQ8Z9o3wMAmKktHOfJHfkAAAAASUVORK5CYII=",le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAAJ1BMVEUAAAD///9Ao/hBp/ZEo/NBo/VDpPZCpfVCpfVCpfVCpfVCpfVCpfV3UDGGAAAADHRSTlMAACQ3QE5XaX/q9fwBnrneAAAAVklEQVQY02MQRAIM9OOcaWDgOMPAcOYAA4hzgqEHwdnTcRrByT6zDcFh251whmnOmTOTQByGNIYzDFZnThmAOUA1DKx7tjLAOQw1BSAOAwSwMDBQ1wsAlKsupIt8k6oAAAAASUVORK5CYII=",ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAAJFBMVEUAAAD/vy7/wSz6vi78wS37wC37wS77wC38wC36wC37wC37wC3v3VOxAAAAC3RSTlMAHB03SrXE0N7i4zzsXT4AAABVSURBVBjTY2AgErDM3gCiuHc6AEmu3RDO7gUgcgNEBZgmkiMN42xkYGCKXgDhcG1VYNgNNh9s325UDooyFAOARrIlgCDUHhQOLhdwIHuBuRrJc0QBADb3JTCSI1vYAAAAAElFTkSuQmCC",ie="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAC80lEQVR42rRWTWsUMRh+k0lmR7dQaetSFdRDoeKt0h+g6D8QevHmwYOggqIUBC+iB+/qQUGL4En/QYX2JGjx4kV6ELwUrF8t1v3IJHl9MjuzO3W3dZU28O7MJJPneZ8nbyYrmJl2s6nw82vhxh1cphFDCI34X1aBSBEbiKXqyXs3VT5wFjG5w8kfQXQIvrX5xUX8viuUdd1jDIk8R0HsXH4vi66iWcQJTHxQYBYEcY7zCiKXOdcayWK2yMjYe/JpSlGSABv91mbj3nM2nhN9L2MWBD6/1tjTskZvLJG1BEN48JIaJiWPwcrIGOmx/SQ2gLOO0BGFQjEtT6kNSqlWxlT9zItye7xjLLw/hocmk38hABYPoQZMnVy9eZocEiK/AqcWZVDUpzZ6CILMlgt6w8u8j1P/DA5QouU55eVzWmmQ12tH663mPAM5MfqCJL1IAnbJVm5ut8ne/HMzJbiFnhcymguPzvItWU2IJobJsJpl2AXCtzHFjxQ0s+xf2bJ/p6AYqDFG44iuQ72zzk5a1lMuWSPHG+eFVxQPx1doHOw1T07BcjcQgcgWU3PYcRDP+osW+nYoKbP+c7a11Ljm60Kr4WheTcev6bgkngBB03ZLebs1yE0iYyMQxBmhFOYuyfQyeztDiZgRNnhGl9IVg5eRUN22rZc0GEHIxPgWpWmz6Eox9yp8exrIVSV6Ii19cO9N2CEU+Kgitv4W9TQkFu2DPYeKz5IIRTXX+mgesvF7OKLHPlRZNdvj7Yr3PQW0jUUpplUVqYOVDgGukj4ZFxbSM0dcAhS86XMxgILOSvguAbPGrcpB460AByrTsJW5wf1eSf6e2CCLjAVzPxw1lhqkD2tSNR08SMF1Cgr2wpI3HZ1cOgn+xSKhQPLVZaHGLakDYSfRQmF2z0HI2y9y4cPqJpKkPcN+tlkEZSIStOUp2yZZLWOqbmFm7Qxi5E9loiIGtdyCZKqMWQCN5inc38Ejc7RM8HI3Dv32Htnlvy2/BRgAaoYq7RFYKjsAAAAASUVORK5CYII=",oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAACuUlEQVR42uxVPWgUQRR+b3bWu9vcGaJGTaOi2CiCRBREJBY2GrANiIVoZStYCPEnhSio2AuijQja2KhBsQiINqKNoMYicMQkxkCinrmfnZnnN3u5eMHbaJNGMjB783Zm3/fN976ZYxGhpWyKlrgtA/y16eZgduhCUyQdRNUzRC4PHqOwwlVmFnZlomgjqfy6XjP2qpfDtq1YzEIypYiHhHgw6rky0hJA62pz2BHHchbfEvJOI8M1FZCQypAtT5525amLpHOFZhc6kj5x7iiGrQHAumWAHD+ZSRiCilUnyZrrPh2p0M++x+MH+k70FZlc5k2qRJ7tQgCx+A3wuuZjF0MIkn5SKimfYuoD6v2EiqutFWe3h9HK4UUAWrcGrJNk1OmxvTJK03QYrKBqbZYku3pS51ZNukpxgXP+yUUNmTVWg/xzH0IyMsY9jU18S2xlH+e7KLN+F9HMzGI2Tb82hBrC0Cm46W1jb7ExJxyFL1xp/Jn58novh4V0gFACqrsmkWUeDXGija2/GoMdu5lVP4CK88UuTx0sf3330upcTyoAO0XOMhlxvtvf8nsEFov8Ac99xHwJVd6iuf1YIOFHgodZ56kmlRupAAKzG2uJrabAhhFKqebkqcLjSYl9V7CPd4etWqM7g7tBQe0Hp7oFyO1YzEVZny9gL5WcaxwixCOqEmN3FTJRdBi0CjgWj8hQSdpKyhk5Qg5C+nNCaiIVoOzMAyzbXXNVh+Rd0BoKo4Rld1Nv2ERmTaQqH4bvUC3u5ECVVJaLcdFmwX4za04qFLA6nwqABYf8BvygXldGRWgAUj2kwHibhgD95pKzQLijaJuYOd2Yv4PcAMa3UwGw7jKeeyCmwp0yHgbREyvVe5LFzMQEyefRWCt93Gp9ADvrBol20Ikx+wmfD4LX4z8O6fJf5v8P8EuAAQDOXyBdsB1RZQAAAABJRU5ErkJggg==",se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABs1BMVEUYsmUZsmY0ur00ur47vns9R249qnM/u3Y/u3g/vH0/vKc/va0/wNBBsoRBupdFrHhFrXlJsolJtIlNs5lPsZ1Wqa1apbRgx5RgyJRjXXRxzp6Gx4ye37+i4MGj4MKq1Kq22bLF7djJ79vN4L3PzcPv+PX///+vtLbC48q05s6g4so/v4M/voNJtZJcxZRCv6dSt5pOu4dDVmdOvIYvrn4vQVIwSVglq2Mwt3pQv4xFuYwmPVQzOlk0R108knZBuIRCyIhBuoBLv409uoE3tn5Au4YySmA+vYo/vYpCuoYwR14VrWsVrWwpQVguRFkxNVcxtHwyNlgyOFgys3ozO1kzPFozPlozQVszQlwztHo0RVw0R100SV40Sl40Sl80tHw1S141TmA2Sl82V2M2tn43Ymc3uIQ4bWo5eG45tH45tX85u3s6eW46toA7iXQ7t4I8lXc+oXs/q38/toI/uIM/uIQ/u4JAsYBAtoJAtoNAt4JAt4NAuINAu4RAvIRAvYRBt4NBuXlBuoRBv4VBwIZBw4dBxYdBxohBy4lCt4NCt4RCuIRCyYhCyYlCy4lCzIpDzYqKfftQAAAAS3RSTlMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACCAsdIyQwQkRhZ2xtc32EjZawtbu7u7u7u7y8wtvd8fLy9vtGlJYUAAABcklEQVQYGXXBf2+TQBgH8O9z90BBcLSFI5q0y6JJs/f/GjS+gE2jJsZmJtt6o1npD0o5uLN023/b50MzvE7gDYyzpCVrye63AOJQOCEcl2tGe6l4o3d1vesgsyCI8vftw1fItCll+KF6TA9madRQ7dT56ua6JAEql8lGjdepKgqVrsdqkxQlQaaHPft5UK9E5H2cdiZX9Ofvg2OZWt9AiOSw9lWGKp1s7+YL4aSAL62+NX4sO2s7GfvmdmGlD4aG26dtNal0jH0+2bXb7yEhZwxAkW5KLxoYDKKmbHVmHcBIANRXo3Da/MN0upw/1jGOGDXgnP7EVRwgrnj0qyICAsYNALqPw/PhCEN5f/2zcwBmNDM4osHFRWYhivn84HDkMTz0Oj0cM9qV7hgnjAI9dzf+3IGK30zoZYwVehRqz8DTbu3Qy2Ra8QnKJm+//bCST84YFifOagFtLOEJI8KzxRcs3uEFQ+AZbSAcXtAMrxN4w3/ZIaVUR3Y9WgAAAABJRU5ErkJggg==",re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAACvklEQVR42rSWa4iMURjHZ3bW5JaNWFnJh2Xd1v1WSsqlkVtSduWDXEspK4R8kJBcsqQ2NLIbLRKKsiSJTW65lZRE1mVj3SZFzGLH/6nfW6/j1MyXPfVr3vfMmfM85//8z7MbzWQykdYc+bPqX/nmJ4gq0V48EXvENWfNWLFBDBO/xVpxzt0oz7N5R3EE5hLghDhoCbFmmzgvLLs5Yos4JLr/dwJPgHGiRVTyfl8cIMhp8ZnsJxLcxkNRISaL2mwBisRbZ84yHS8+is6im/jkrHkmeuQi0S8R98xvZJPLYrvn+xgnzyrRG9HVmZtKAJPvA9LcFYdDa3qKd7kEaKTQlmWJKBSjxE+RFFGRpi4LkcpqUOyR9h+JemPHOtFFTBd30PuqGC6mcZoxolr0ETfEJE5djb1L3ABLxS3RVywS+3DPGYKtEA3ciwKKbr5vJsBFcVLMJ6F6sTqQyDbcLcopoI0mcYGLk2TDNfg/RgLreA9suYS6lFErSy4enXm9wYq6nA3Dw6QaiXTmqtdkHwyT54V4RKKlzu9HiLN5ZPTdU+x0iBi4toxQ/BbP77+ZISzADnFcjHYsN0j8QZoUMqaZq+JOlLO2gIsYjFIUqbWj7ceWJskx7DcPPSuZP0q/Mb3biKeiHVY27Ycis9VumVggauzuBC6yhVPQ9ZJYj3vs6r8Xe3n+wrs9byaIOWsIxTU3DRAz2CNiRXa1GyyuYFvrS205cooAllQHOudj8QO5Ely8umw32eT6KmbzHqdtJ/G5tYrbYpPYyV2IYPHCXFpFMV0zGM1ob7d3K+3gAc9uDyvKJUAc67mjgj6V8LVl3JWfS7tuwnrh0QmHNaLxKdHLWdPf1019AW7iDCtYPz7vkXWCJvicOqxijblmIObIKlEKOXZxW1PYuCa0ZjGB7G/ESubMli/dzaKt/W/LXwEGANgjsMpO7QqpAAAAAElFTkSuQmCC",ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAADK0lEQVR42uxVz0tUURQ+59z7fumUzpTmDwihVYVWEBRUFrSKonATtCnqb4hWLduEELVo0a5FRYsWESjYIhLCCqwETSx3ZRrlyEyjju+9+6PzZhjFZkIT3HWHx33vzX3nO+f7vnsuWmthMwfBJo9NB5C1Xt4ZeHv99eTXk9tSdRuJiYD46u6lU9dXAYx8+b684lcxPO85snPDaVsoVFXQ2zdUuW1NuW7nVt8DszEDLApBT6sA0oFfuc1YxCEOrblUtT5OoIXduBs4IST6jEhjVQBG2dJScuVHgfoI2PWyAUncazzd5ISSFyM6Vp+qALyOVkgW6NncLluM2pCEXk98DhlZsD0VNPTgA0rIVQFkjnaC4Xlu4M2DeC46TCuU/Zu+BsasqmHT2SeDydSsdHwYA29j7kGYJwYAXQMgDpeSiamhCUKKbZJL2dR/4Z5/1ipEbOLHnYnhhMBP0qcfiDUALAkQhCPIbkiEI171p0tLj5pxlQLjOiCZbEDTy3a+WtLX2HdxUdfeyYEjSWndwp9nkqwtqCluJDmyDu8HU2bAGMB6D6i+EYIcQX2Qhmxx6oBSRV7KXcdxh41IQprqXnSxu2t3OuU//rUUjkY2Gq3HbccaqRkUhAwnOGkLmQYXtuxogML2DBzqaIT2ZgPZhfkuprRsdWKBBVNHNSro+zC5P78YHqxzJWukwEHZwxRMc/bvHCjT5XsSlpgKoTXM5PPdBbDnBUJTaash/MQoHocwAqilweT37GnflYEUAqQVMKtmLvO+uOyA95JzesCvny+Epi0s5s8FpnB2OFfYyy0BtnBLiY0GH8R0GoO8QVtbg5TnjDP0OAu1J8lAYPkvA/YEq3qCPTA3l1/KJKUQa+JxpYnqxlg2hxzj9nK7YFZnv0oDtHiDBHVRQKdZ5IfsimzFjqXZYsaSLn1hUDCAGHV9cQt8c1xKdx8IeX8BIigyvclVfR6U42jmp58I+zmTdqPtGQF0gas4brgWH+omyLXPIogHGrb6LxRXk12MQSRNLqm6tGtwjQNnhcJvfN1zQbwPUV/RNm5IU/ujWC4MKsov9/u1Ojr+P/TXGr8FGADJOk57I+26YwAAAABJRU5ErkJggg==",de="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAM1BMVEUAAAD/////cEP/cEP/cEP/cEP/cEP/cEP/cEP/cEP/cEP/cEP/cEP/cEP/cEP/cEP/cEOq1nWIAAAAEHRSTlMAABAgMEBQYHCAn6+/z9/vPwUefgAAAGdJREFUKM/dkDsSgDAIRNfEiIbv/U/rYGJh4QH0NcACswxYXsDvG4PGIkcphwi3KZFrAUWieoUdUCe4Sd3jQa9sgXDiUbuIj4zJAzrHZBteszSslsO9TkvUnmu2ZtruQ+4TW8rf+u4JWMMHpqyZqq4AAAAASUVORK5CYII=",ce="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAAGFBMVEUAAABAp/dBpfVCpfVCpfVBpfVCpfVCpfVo2UVyAAAAB3RSTlMAIEp/3+LjoElP7QAAAEFJREFUGNNjYMAD1MqBwADKSQeyS4qhHJBEobsBglMgUozEYYRKgTkMUCkIh9EdzgGBQcJJh7DLwBxVCCcIX9AAAFIoQngIXmAwAAAAAElFTkSuQmCC",he={name:"SidebarItemIcon",props:{name:{required:!0,type:String}},methods:{isType(e){let t=this.name.split("."),a=t[t.length-1];return a===e||(t=this.name.split(".")[0].split("-"),a=t[t.length-1],a===e)?!0:this.name.includes(e)}}},pe={key:0,class:"file-icon",src:$,alt:""},ue={key:1,class:"file-icon",src:ee,alt:""},me={key:2,class:"file-icon",src:te,alt:""},Ae={key:3,class:"file-icon",src:le,alt:""},fe={key:4,class:"file-icon",src:ae,alt:""},ge={key:5,class:"file-icon",src:ie,alt:""},ye={key:6,class:"file-icon",src:oe,alt:""},Fe={key:7,class:"file-icon",src:se,alt:""},be={key:8,class:"file-icon",src:re,alt:""},ve={key:9,class:"file-icon",src:ne,alt:""},Ce={key:10,class:"file-icon",src:de,alt:""},we={key:11,class:"file-icon",src:ce,alt:""};function Me(e,t,a,n,i,l){return r(),h("section",null,[l.isType("html")?(r(),h("img",pe)):l.isType("svg")||l.isType("jpg")||l.isType("png")||l.isType("gif")?(r(),h("img",ue)):l.isType("eot")||l.isType("ttf")||l.isType("woff")||l.isType("woff2")?(r(),h("img",me)):l.isType("markdown")||l.isType("md")?(r(),h("img",Ae)):l.isType("json")?(r(),h("img",fe)):l.isType("yaml")?(r(),h("img",ge)):l.isType("js")?(r(),h("img",ye)):l.isType("vue")?(r(),h("img",Fe)):l.isType("jsx")?(r(),h("img",be)):l.isType("css")?(r(),h("img",ve)):l.isType("hbs")?(r(),h("img",Ce)):(r(),h("img",we))])}const Ee={name:"SidebarItem",components:{SidebarItemIcon:C(he,[["render",Me],["__scopeId","data-v-770845be"]])},props:{type:{required:!0,type:String},model:{required:!0,type:Object}},data(){return{open:!1,isSelected:!1}},computed:{...F(D,["iFrameFile"]),...F(b,["selectedFile"]),isFolder(){return this.model.type==="folder"},isFile(){return this.model.type==="file"},isSelectedFileSameType(){return this.isFile&&this.selectedFile&&this.model.file.type!==this.selectedFile.file.type},isViewed(){return!!(this.iFrameFile&&this.iFrameFile.path===this.model.path)}},watch:{"selectedFile.path":{handler(){this.isSelected=this.computeIsSelected()}},open:{handler(){this.isSelected=this.computeIsSelected()}}},mounted(){this.isSelected=this.computeIsSelected()},methods:{...m(b,["openFile"]),...m(K,["openContextMenu"]),computeIsSelected(){return this.isFolder&&this.selectedFile&&!this.open&&this.model.path?this.selectedFile.path.includes(this.model.path):this.isFile&&this.selectedFile&&this.selectedFile.file!=={}?this.selectedFile.path===this.model.path:!1},openNode(){this.isFile&&this.openFile(this.model),this.isFolder&&(this.open=!this.open)},handler(e){const t=this.model.type,a=this.model;this.openContextMenu({event:e,ctx:a,type:t})}}},Se=e=>(B("data-v-bb43ab7e"),e=e(),R(),e),ke={class:"container"},Ve=["data-testid","data-testname"],xe={key:0,class:"bold"},Be={key:0,class:"material-icons"},Re={key:1,class:"material-icons"},Ue={key:1,class:"bold"},Pe={class:"name"},De=Se(()=>o("div",{class:"eye-container"},[o("i",{class:"material-icons eye"}," remove_red_eye ")],-1)),Ie={key:0};function Ye(e,t,a,n,i,l){const d=p("SidebarItemIcon"),s=p("SidebarItem",!0);return r(),h("li",ke,[o("div",{class:Y([{selected:i.isSelected,viewed:l.isViewed},"main"]),"data-testid":l.isFile?"editor-sidebar-item-file":"editor-sidebar-item-folder","data-testname":a.model.name,role:"button",tabindex:"0",onKeyup:t[0]||(t[0]=ha((...A)=>l.openNode&&l.openNode(...A),["enter"])),onContextmenu:t[1]||(t[1]=pa((...A)=>l.handler&&l.handler(...A),["prevent"])),onClick:t[2]||(t[2]=(...A)=>l.openNode&&l.openNode(...A))},[l.isFolder?(r(),h("div",xe,[i.open?w("",!0):(r(),h("i",Be,"keyboard_arrow_right")),i.open?(r(),h("i",Re,"keyboard_arrow_down")):w("",!0)])):w("",!0),l.isFile?(r(),h("div",Ue,[c(d,{name:a.model.name},null,8,["name"])])):w("",!0),o("div",Pe,x(a.model.name),1),De],42,Ve),l.isFolder?N((r(),h("ul",Ie,[(r(!0),h(k,null,I(a.model.children,(A,g)=>(r(),v(s,{key:g,"selected-file":e.selectedFile,model:A,type:a.type,class:"item"},null,8,["selected-file","model","type"]))),128))],512)),[[ua,i.open]]):w("",!0)])}const Te={name:"EditorSidebar",components:{SidebarItem:C(Ee,[["render",Ye],["__scopeId","data-v-bb43ab7e"]])},data(){return{open:!1}},computed:{...F(b,["pages"]),model(){return M.buildSidebarData(this.pages)}},methods:{...m(f,["openCreateFileModal"])}},_=e=>(B("data-v-7c65289c"),e=e(),R(),e),Ke={class:"sidebar container"},_e=y(" New File + "),Ne={id:"custom-scrollbar",class:"sidebar content"},Oe={class:"content container"},Qe=_(()=>o("div",{class:"content header"}," CONTENT ",-1)),ze={class:"specs container"},Le=_(()=>o("div",{class:"specs header"}," SPECS ",-1)),Ge={class:"themes container"},He=_(()=>o("div",{class:"themes header column"}," THEMES ",-1)),je={class:"emails container"},Je=_(()=>o("div",{class:"emails header"}," EMAILS ",-1));function qe(e,t,a,n,i,l){const d=p("KButton"),s=p("SidebarItem");return r(),h("div",null,[o("div",Ke,[c(d,{class:"add-file",onClick:e.openCreateFileModal},{default:u(()=>[_e]),_:1},8,["onClick"]),o("div",Ne,[(r(!0),h(k,null,I(l.model.root,(A,g)=>(r(),v(s,{key:`${g}-root`,model:A,type:"root",class:"item"},null,8,["model"]))),128)),o("div",Oe,[Qe,(r(!0),h(k,null,I(l.model.content,(A,g)=>(r(),v(s,{key:`${g}-content`,model:A,type:"content",class:"item"},null,8,["model"]))),128))]),o("div",ze,[Le,(r(!0),h(k,null,I(l.model.specs,(A,g)=>(r(),v(s,{key:`${g}-specs`,model:A,type:"specs",class:"item"},null,8,["model"]))),128))]),o("div",Ge,[He,(r(!0),h(k,null,I(l.model.themes,(A,g)=>(r(),v(s,{key:`${g}-themes`,model:A,type:"partial",class:"item"},null,8,["model"]))),128))]),o("div",je,[Je,(r(!0),h(k,null,I(l.model.emails,(A,g)=>(r(),v(s,{key:`${g}-emails`,model:A,type:"email",class:"item"},null,8,["model"]))),128))])])])])}const We=C(Te,[["render",qe],["__scopeId","data-v-7c65289c"]]),Xe="/__km_base__/assets/layout-code.012d3f30.3_3_0_0.svg?external",Ze="/__km_base__/assets/layout-split.5afbe3ad.3_3_0_0.svg?external",$e="/__km_base__/assets/layout-viewer.99163e27.3_3_0_0.svg?external",et={name:"EditorToolbar",props:{opener:{type:String,default:null}},computed:{...F(D,["layout"]),...F(b,["areChangesSaved","selectedFile","code"]),isMac(){return window.navigator.platform.includes("Mac")}},mounted(){window.addEventListener("keydown",e=>{e.keyCode===83&&(this.isMac?e.metaKey:e.ctrlKey)&&(e.preventDefault(),this.save())})},methods:{...m(D,["setLayout"]),...m(b,["updateFile"]),...m(f,["openUpdateFileErrorModal"]),exitEditor(){this.$router.push(this.opener?{path:this.opener}:{name:"portal-overview"})},save(){this.updateFile({id:this.selectedFile.file.id,path:this.selectedFile.file.path,contents:this.code}).catch(()=>{this.openUpdateFileErrorModal("Syncing")})}}},S=e=>(B("data-v-40227440"),e=e(),R(),e),tt={class:"toolbar"},lt={class:"toolbar-item context"},at={class:"context-action"},it=S(()=>o("i",{class:"border_vertical material-icons"},"close",-1)),ot=S(()=>o("h4",null,"Editor Mode",-1)),st={class:"toolbar-item layout"},rt={class:"view-swtich row"},nt=S(()=>o("h6",null,"View:",-1)),dt=S(()=>o("img",{src:Xe,alt:""},null,-1)),ct=S(()=>o("p",null,"Code",-1)),ht=S(()=>o("img",{src:Ze,alt:""},null,-1)),pt=S(()=>o("p",null,"Split",-1)),ut=S(()=>o("img",{src:$e,alt:""},null,-1)),mt=S(()=>o("p",null,"Page",-1)),At={class:"row"},ft={class:"saved"},gt={key:0},yt=y(" Save Changes ");function Ft(e,t,a,n,i,l){const d=p("KButton");return r(),h("section",null,[o("div",tt,[o("div",lt,[o("div",at,[c(d,{onClick:l.exitEditor},{default:u(()=>[it,ot]),_:1},8,["onClick"])])]),o("div",st,[o("div",rt,[nt,c(d,{class:Y([{selected:e.layout==="code"},"layout-switch left"]),onClick:t[0]||(t[0]=s=>e.setLayout("code"))},{default:u(()=>[dt,ct]),_:1},8,["class"]),c(d,{class:Y([{selected:e.layout==="split"},"layout-switch"]),appearance:"primary",onClick:t[1]||(t[1]=s=>e.setLayout("split"))},{default:u(()=>[ht,pt]),_:1},8,["class"]),c(d,{class:Y([{selected:e.layout==="portal"},"layout-switch right"]),onClick:t[2]||(t[2]=s=>e.setLayout("portal"))},{default:u(()=>[ut,mt]),_:1},8,["class"])])]),o("div",At,[o("div",ft,[e.areChangesSaved?(r(),h("p",gt," All Changes Saved! ")):w("",!0)]),c(d,{disabled:e.areChangesSaved,class:"save-button",appearance:"primary",onClick:t[3]||(t[3]=s=>l.save())},{default:u(()=>[yt]),_:1},8,["disabled"])])])])}const bt=C(et,[["render",Ft],["__scopeId","data-v-40227440"]]),vt={name:"PortalEditor",components:{MonacoEditor:ma},mixins:[E],data(){return{options:{automaticLayout:!0,theme:"vs-dark"},defaultLanguage:"html",language:"html",resizeTimer:()=>{},isLoading:!1}},computed:{...F(b,["selectedFile","code"]),localCode:{get(){return this.code??""},set(e){this.setCode(e)}}},watch:{"selectedFile.file.path":{handler(){this.setEditorState()}}},mounted(){this.setEditorState(),window.addEventListener("resize",this.handleResize)},beforeUnmount(){window.removeEventListener("resize",this.handleResize)},methods:{...m(b,["setCode"]),...m(f,["openUpdateFileErrorModal"]),handleResize(){this.isLoading=!0,clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(()=>{this.isLoading=!1},250)},setEditorState(){if(!this.selectedFile)return;const e=this.selectedFile.name.split(".");e.length<1&&(this.language=this.defaultLanguage);const t=e.splice(-1)[0].toLowerCase();J[t]?this.language=J[t]:this.language=t}}},Ct={class:"column"};function wt(e,t,a,n,i,l){const d=p("MonacoEditor");return r(),h("section",null,[o("div",Ct,[i.isLoading?w("",!0):(r(),v(d,{key:0,ref:"editor",modelValue:l.localCode,"onUpdate:modelValue":t[0]||(t[0]=s=>l.localCode=s),options:i.options,language:i.language,theme:"vs-dark",class:"editor monaco"},null,8,["modelValue","options","language"]))])])}const Mt=C(vt,[["render",wt],["__scopeId","data-v-acd224f2"]]),Et={name:"PortalViewer",mixins:[E],data(){return{iframeUrl:null,imgSrc:null,pageErrorStates:[],checksum:null}},computed:{...F(D,["iFrameFile","layout"]),...F(b,["selectedFile"]),...F(Q,["showErrorPanel","errorMessage"])},watch:{layout:{handler(){this.setErrorPanelState(),this.showErrorPanel||this.setPortalViewerState()}},selectedFile:{handler(){this.setErrorPanelState(),this.showErrorPanel||this.setPortalViewerState()}}},mounted(){this.setErrorPanelState(),this.showErrorPanel||this.setPortalViewerState()},methods:{...m(D,["setIframeFile"]),...m(Q,["toggleErrorPanel","openErrorPanel"]),setErrorPanelState(){if(!this.selectedFile){this.openErrorPanel("Select a file from the sidebar to get started.");return}if(!this.iFrameFile&&!M.isContent(this.selectedFile)&&!M.isImage(this.selectedFile)){this.openErrorPanel('Click on files contained under "Content" or "Specs" to enable preview.');return}this.toggleErrorPanel(!1)},resolveView(){this.$api.editorQuery(this.iframeUrl).then(e=>{document.getElementById("portal-window").srcdoc=e.data})},setPortalViewerState(){if(this.selectedFile&&this.selectedFile.type==="file"&&M.isContent(this.selectedFile))this.imgSrc=null,this.setIframeFile(this.selectedFile.file),this.iframeUrl=this.iFrameFile.path,this.resolveView();else if(this.selectedFile&&this.selectedFile.type==="file"&&M.isImage(this.selectedFile)){this.setIframeFile(this.selectedFile.file);const e=this.selectedFile.file.contents;if(e.startsWith("data:")){this.imgSrc=e;return}const t=new Blob([e],{type:"image/svg+xml"}),a=URL.createObjectURL(t);this.imgSrc=a}else this.selectedFile&&this.selectedFile.type==="file"&&this.iFrameFile&&!M.isImage(this.iFrameFile)?(this.imgSrc=null,this.iframeUrl=this.iFrameFile.path,this.resolveView()):this.selectedFile&&this.selectedFile.type==="file"&&(this.imgSrc=null,this.setIframeFile(null),this.openErrorPanel("Select a content file to see your changes to theme files"))}}},St={class:"column"},kt={key:0,class:"error-panel"},Vt={key:1,class:"img-panel"},xt=["src"],Bt={key:2,id:"portal-window",class:"iframe",title:"portal-window"};function Rt(e,t,a,n,i,l){return r(),h("section",null,[o("div",St,[e.showErrorPanel?(r(),h("div",kt,[o("p",null,x(e.errorMessage),1)])):i.imgSrc?(r(),h("div",Vt,[o("img",{src:i.imgSrc,class:"img-preview",alt:"preview"},null,8,xt)])):(r(),h("iframe",Bt,`
        <div></div>
      `))])])}const Ut=C(Et,[["render",Rt],["__scopeId","data-v-15ae490d"]]),Pt={name:"EditFileModal",mixins:[U],data(){return{id:null,path:null,type:"content",contents:null}},computed:{...F(f,{isVisible:"showEditFileModal",file:"modalCtx"})},watch:{file:{handler(){this.isVisible&&this.file&&this.parseFile()}}},methods:{...m(b,["updateFile"]),...m(f,["closeEditFileModal"]),...m(z,["notify"]),parseFile(){if(this.id=this.file.id,this.path=this.file.path,this.contents=this.file.contents,this.file.path.includes("specs/")){this.type="specs",this.path=this.file.path.split("specs/")[1];return}else if(this.file.path.includes("themes/")){this.type="themes",this.path=this.file.path.split("themes/")[1];return}else if(this.file.path.includes("content/"))return this.type="content",this.path=this.file.path.split("content/")[1],this.file.path.split("content/")[1];this.type="__ROOT__",this.path=this.file.path},updateFileAction(){const e={path:`${this.type}/${this.path.replace(/^\/+/g,"")}`,id:this.id,contents:this.contents};this.updateFile(e).then(()=>{this.closeEditFileModal()}).catch(t=>{this.notify({message:O(t),type:"danger"})})}}},G=e=>(B("data-v-9e60b3c2"),e=e(),R(),e),Dt={class:"column form-item"},It=G(()=>o("label",{for:"filetype"},"File Type",-1)),Yt={class:"column form-item"},Tt=G(()=>o("label",{for:"filename"},"File Name",-1)),Kt={class:"row filename"},_t=["placeholder"],Nt=y(" Dismiss "),Ot=y(" Update File ");function Qt(e,t,a,n,i,l){const d=p("KSelect"),s=p("KButton"),A=p("KPrompt");return r(),v(P,{to:"#app"},[c(A,{"is-visible":e.isVisible,title:"Rename File","tabbable-options":e.tabbableOptions,onCanceled:e.closeEditFileModal},{"body-content":u(()=>[o("form",null,[o("div",Dt,[It,c(d,{modelValue:i.type,"onUpdate:modelValue":t[0]||(t[0]=g=>i.type=g),appearance:"select",width:"100%",items:[{value:"content",label:"content"},{value:"specs",label:"specs"},{value:"themes",label:"themes"}]},null,8,["modelValue"])]),o("div",Yt,[Tt,o("div",Kt,[i.type!=="__ROOT__"?(r(),h("input",{key:0,class:Y([i.type,"form-control prefix"]),placeholder:i.type+" /",readonly:"",name:"filename-type"},null,10,_t)):w("",!0),N(o("input",{"onUpdate:modelValue":t[1]||(t[1]=g=>i.path=g),class:"user-input form-control",name:"filename"},null,512),[[L,i.path]])])])])]),"action-buttons":u(()=>[c(s,{appearance:"outline",onClick:e.closeEditFileModal},{default:u(()=>[Nt]),_:1},8,["onClick"]),c(s,{appearance:"primary",onClick:l.updateFileAction},{default:u(()=>[Ot]),_:1},8,["onClick"])]),_:1},8,["is-visible","tabbable-options","onCanceled"])])}const zt=C(Pt,[["render",Qt],["__scopeId","data-v-9e60b3c2"]]),Lt={"invite.txt":`---
  layout: emails/email_base.html

  subject: We invite you to access Developer Portal {{ portal.url }}"
  heading: Hello Developer!

  ---
  You have been invited to create a Developer Portal account at {{portal.url}}.
  <br>
  Please visit <a href="{{portal.url}}/register">{{portal.url}}/register</a> to create your account.
`,"account-verification.txt":`---
layout: emails/email_base.html

subject: Developer Portal Account Verification {{portal.url}}
heading: Hello {{email.developer_name}}!
---
To verify your Developer Portal account at {{portal.url}}, please click the link below.
<br>
<a href="{{email.verify_url}}">Verify Account</a>
<br>
If you didn't make this request, please click the link below to invalidate this request.
<br>
<a href="{{email.invalidate_url}}">Invalidate Validation Request</a>
`,"account-verification-approved.txt":`---
layout: emails/email_base.html

subject: Your account at {{portal.url}} is Approved!
heading: Hello {{email.developer_name}}!
---
We are emailing you to let you know that your Developer Portal account at <a href="{{portal.url}}">{{portal.url}}</a> has been verified.
<br>
Click the link below to Sign in.
<br>
<a href="{{portal.url}}/login">{{portal.url}}/login</a>
`,"account-verification-pending.txt":`---
layout: emails/email_base.html

subject: Developer Portal ({{portal.url}}) Account Verification Success
heading: Hello {{email.developer_name}}!
---
We are emailing you to let you know that your Developer Portal account at <a href="{{portal.url}}">{{portal.url}}</a> has been verified.
<br>
Your account is still pending approval.
<br>
You will receive another email when your account has been approved.
`,"approved-access.txt":`---
layout: emails/email_base.html

subject: Developer Portal access approved {{portal.url}}
heading: Hello {{email.developer_name}}!
---
You have been approved to access {{portal.url}}.
<br>
Please visit <a href="{{portal.url}}/login">{{portal.url}}/login</a> to login.
`,"password-reset-success.txt":`---
layout: emails/email_base.html

subject: Developer Portal {{portal.url}} Password reset successfully
heading: Hello {{email.developer_name}}!
---

We are emailing you to let you know that your Developer Portal password at <a href="{{portal.url}}">{{portal.url}}</a> has been changed.
<br>
Click the link below to sign in with your new credentials.
<br>
<a href="{{portal.url}}/login">{{portal.url}}/login</a>
`,"password-reset.txt":`---
layout: emails/email_base.html

subject: Password Reset Instructions for Developer Portal {{portal.url}}
heading: Hello {{email.developer_name}}!
---
Please click the link below to reset your Developer Portal password.
  <br>
  <a href="{{email.reset_url}}">{{email.reset_url}}</a>
  <br>
  This link will expire in {{email.token_exp}}.
  <br>
  If you didn't make this request, keep your account secure by clicking the link above to change your password.
`,"request-access.txt":`---
layout: emails/email_base.html

title: Email

subject: Request to access Developer Portal {{portal.url}} {{email.developer_email}}
heading: Hello Admin!
---
{{email.developer_name}} ({{email.developer_email}}) has requested Developer Portal access for {{portal.url}}.
<br>
Please visit <a href="{{email.admin_gui_url}}/developers/requested">{{email.admin_gui_url}}/developers/requested</a> to review this request.
`},Gt={name:"CreateFileModal",mixins:[E,U],data(){return{path:null,type:"content"}},computed:{...F(f,["showCreateFileModal"])},methods:{...m(b,["createFileAndRefresh"]),...m(f,["closeCreateFileModal"]),...m(z,["notify"]),createFile(){const e=`${this.type}/${this.path.replace(/^\/+/g,"")}`,t={path:e},a=e.split(".").pop(),n=e.split("/").pop().split(".")[0].replace(/-|_/g," ");this.type==="themes"?t.contents=`<h1>${n}</h1>`:this.type==="specs"&&a==="json"?t.contents=`{
  "info": {
    "title": "${n}"
  }
}
`:this.type==="specs"&&(a==="yml"||a==="yaml")?t.contents=`info:
  title: ${n}
`:this.type==="emails"?t.contents=Lt[this.path]||"":this.type===""?(t.path=this.path.replace(/^\/+/g,""),t.contents=""):t.contents=`---
title: ${n}
layout:
---
`,this.createFileAndRefresh(t).then(()=>{this.closeCreateFileModal()}).catch(i=>{this.notify({message:O(i),type:"danger"})})}}},H=e=>(B("data-v-794ddc24"),e=e(),R(),e),Ht={class:"column form-item"},jt=H(()=>o("label",{for:"filetype"},"File Type",-1)),Jt={class:"column form-item"},qt=H(()=>o("label",{for:"filename"},"File Path",-1)),Wt={class:"row filename"},Xt=["placeholder"],Zt=y(" Create File "),$t=y(" Dismiss ");function el(e,t,a,n,i,l){const d=p("KSelect"),s=p("KButton"),A=p("KPrompt");return r(),v(P,{to:"#app"},[c(A,{"is-visible":e.showCreateFileModal,title:"New File","tabbable-options":e.tabbableOptions,onCanceled:e.closeCreateFileModal},{"body-content":u(()=>[o("form",null,[o("div",Ht,[jt,c(d,{id:"filetype",modelValue:i.type,"onUpdate:modelValue":t[0]||(t[0]=g=>i.type=g),appearance:"select",width:"100%",items:[{value:"content",label:"content"},{value:"specs",label:"specs"},{value:"themes",label:"themes"},{value:"emails",label:"emails"},{value:"",label:"conf"}]},null,8,["modelValue"])]),o("div",Jt,[qt,o("div",Wt,[o("input",{placeholder:`${i.type} /`,class:Y([i.type,"form-control prefix"]),readonly:"",name:"filename-type"},null,10,Xt),N(o("input",{"onUpdate:modelValue":t[1]||(t[1]=g=>i.path=g),class:"form-control user-input",name:"filename"},null,512),[[L,i.path]])])])])]),"action-buttons":u(()=>[c(s,{appearance:"primary",onClick:l.createFile},{default:u(()=>[Zt]),_:1},8,["onClick"]),c(s,{appearance:"outline",onClick:e.closeCreateFileModal},{default:u(()=>[$t]),_:1},8,["onClick"])]),_:1},8,["is-visible","tabbable-options","onCanceled"])])}const tl=C(Gt,[["render",el],["__scopeId","data-v-794ddc24"]]),ll={name:"DeleteFileModal",mixins:[E,U],data(){return{name:null}},computed:{...F(f,{isVisible:"showDeleteFileModal",file:"modalCtx"})},watch:{file:{handler(){this.file&&(this.name=this.file.name)}}},methods:{...m(b,["deleteFile"]),...m(f,["closeDeleteFileModal"]),...m(z,["notify"]),deleteFileAction(){this.deleteFile(this.file).then(()=>{this.closeDeleteFileModal()}).catch(e=>{this.notify({message:O(e),type:"danger"})})}}},al=y(" Delete File "),il=y(" Dismiss ");function ol(e,t,a,n,i,l){const d=p("KButton"),s=p("KPrompt");return r(),v(P,{to:"#app"},[c(s,{"is-visible":e.isVisible,title:"Delete File","tabbable-options":e.tabbableOptions,onCanceled:e.closeDeleteFileModal},{"body-content":u(()=>[o("form",null," Are you sure you want to delete "+x(i.name)+"? ",1)]),"action-buttons":u(()=>[c(d,{appearance:"danger",onClick:l.deleteFileAction},{default:u(()=>[al]),_:1},8,["onClick"]),c(d,{appearance:"outline",onClick:e.closeDeleteFileModal},{default:u(()=>[il]),_:1},8,["onClick"])]),_:1},8,["is-visible","tabbable-options","onCanceled"])])}const sl=C(ll,[["render",ol]]),rl={name:"RenameFolderModal",mixins:[E,U],data(){return{oldName:null,newName:null}},computed:{...F(f,{isVisible:"showRenameFolderModal",folder:"modalCtx"})},watch:{folder:{handler(){this.folder&&(this.oldName=this.folder.name,this.newName=this.folder.name)}}},methods:{...m(b,["renameFolder"]),...m(f,["closeRenameFolderModal"]),renameFolderAction(){this.renameFolder({folder:this.folder,oldName:this.oldName,newName:this.newName}),this.closeRenameFolderModal()}}},nl=e=>(B("data-v-e51f4576"),e=e(),R(),e),dl={class:"column form-item"},cl=nl(()=>o("label",{for:"foldername"},"Folder Name",-1)),hl={class:"row foldername"},pl=y(" Dismiss "),ul=y(" Rename Folder ");function ml(e,t,a,n,i,l){const d=p("KButton"),s=p("KPrompt");return r(),v(P,{to:"#app"},[c(s,{"is-visible":e.isVisible,title:"Rename Folder","tabbable-options":e.tabbableOptions,onCanceled:e.closeRenameFolderModal},{"body-content":u(()=>[o("form",null,[o("div",dl,[cl,o("div",hl,[N(o("input",{"onUpdate:modelValue":t[0]||(t[0]=A=>i.newName=A),class:"form-control",name:"foldername"},null,512),[[L,i.newName]])])])])]),"action-buttons":u(()=>[c(d,{appearance:"outline",onClick:e.closeRenameFolderModal},{default:u(()=>[pl]),_:1},8,["onClick"]),c(d,{disabled:i.oldName===i.newName,appearance:"primary",onClick:l.renameFolderAction},{default:u(()=>[ul]),_:1},8,["disabled","onClick"])]),_:1},8,["is-visible","tabbable-options","onCanceled"])])}const Al=C(rl,[["render",ml],["__scopeId","data-v-e51f4576"]]),fl={name:"DeleteFolderModal",mixins:[E,U],data(){return{name:null}},computed:{...F(f,{isVisible:"showDeleteFolderModal",folder:"modalCtx"})},watch:{folder:{handler(){this.folder&&(this.name=this.folder.name)}}},methods:{...m(b,["deleteFolder"]),...m(f,["closeDeleteFolderModal"]),deleteFolderAction(){this.deleteFolder(this.folder),this.closeDeleteFolderModal()}}},gl=y(" Dismiss "),yl=y(" Delete Folder ");function Fl(e,t,a,n,i,l){const d=p("KButton"),s=p("KPrompt");return r(),v(P,{to:"#app"},[c(s,{"is-visible":e.isVisible,title:"Delete Folder","tabbable-options":e.tabbableOptions,onCanceled:e.closeDeleteFolderModal},{"body-content":u(()=>[o("form",null," Are you sure you want to delete "+x(i.name)+" folder? ",1)]),"action-buttons":u(()=>[c(d,{appearance:"outline",onClick:e.closeDeleteFolderModal},{default:u(()=>[gl]),_:1},8,["onClick"]),c(d,{appearance:"danger",onClick:l.deleteFolderAction},{default:u(()=>[yl]),_:1},8,["onClick"])]),_:1},8,["is-visible","tabbable-options","onCanceled"])])}const bl=C(fl,[["render",Fl]]),vl={name:"UpdateFileErrorModal",mixins:[E,U],data(){return{errorMessages:[" failed","your changes failed, try again?","your changes failed again, try once more?","your changes still failed, this may be a network issue"],action:"Syncing",errorMessage:"failed",loading:!1}},computed:{...F(b,["selectedFile"]),...F(f,{isVisible:"showUpdateFileErrorModal",errorCount:"errorCount"})},watch:{errorCount:{handler(){let e=this.errorCount;e>3&&(e%2===0?e=2:e=3),this.loading=!1,this.errorMessage=this.errorMessages[e]}}},methods:{...m(b,["updateFile","openFile"]),...m(f,["closeUpdateFileErrorModal","openUpdateFileErrorModal"]),sync(){this.loading=!0,this.action="Syncing",this.updateFile(this.selectedFile).then(()=>{this.closeUpdateFileErrorModal()}).catch(()=>{this.openUpdateFileErrorModal()})},reset(){this.loading=!0,this.action="Resetting",this.openFile(this.selectedFile).then(()=>{this.closeUpdateFileErrorModal()}).catch(()=>{this.openUpdateFileErrorModal()})}}},j=e=>(B("data-v-481e6b8f"),e=e(),R(),e),Cl=y(" Loading "),wl=j(()=>o("form",null," Sync to attempt to push your changes to the server ",-1)),Ml=j(()=>o("form",null," Reset to fetch the last saved state on the server ",-1)),El=y(" Sync "),Sl=y(" Reset ");function kl(e,t,a,n,i,l){const d=p("KButton"),s=p("KPrompt");return r(),v(P,{to:"#app"},[c(s,{"is-visible":e.isVisible,title:i.loading?"Loading":`${i.action} ${i.errorMessage}`,"tabbable-options":e.tabbableOptions,class:"update-file-error-prompt"},Aa({"header-content":u(()=>[i.loading?(r(),h(k,{key:1},[Cl],64)):(r(),h(k,{key:0},[y(x(i.action)+" "+x(i.errorMessage),1)],64))]),"action-buttons":u(()=>[c(d,{appearance:"primary",onClick:l.sync},{default:u(()=>[El]),_:1},8,["onClick"]),c(d,{appearance:"outline",onClick:l.reset},{default:u(()=>[Sl]),_:1},8,["onClick"])]),_:2},[i.loading?void 0:{name:"body-content",fn:u(()=>[wl,Ml])}]),1032,["is-visible","title","tabbable-options"])])}const Vl=C(vl,[["render",kl],["__scopeId","data-v-481e6b8f"]]),xl={name:"UpdateFileErrorModal",mixins:[E,U],computed:{...F(b,["selectedFile"]),...F(f,{isVisible:"showUpdateFileServerErrorModal",serverError:"modalCtx"}),errorMessage(){return this.serverError?O(this.serverError):"Saving failed, but no error reported"},isRoleError(){return!!(this.serverError&&this.serverError.message&&this.serverError.message.match("could not find role"))},name(){return this.selectedFile&&this.selectedFile.path?this.selectedFile.path.split("/").pop():""}},methods:{...m(f,["closeUpdateFileServerErrorModal"])}},Bl={key:0},Rl=y(" The file contains unrecognized values (roles) in the \u2018readable_by\u2019 property. You can view the roles you have created and create more roles on the "),Ul=y(" Permissions page. "),Pl=o("br",null,null,-1),Dl=o("form",null," To save this file remove the roles from readable_by that don't exist in the Permissions page. ",-1),Il={key:1},Yl=o("br",null,null,-1),Tl=o("form",null," To save this file, resolve any issues first. ",-1),Kl=y(" Dismiss this message ");function _l(e,t,a,n,i,l){const d=p("KIcon"),s=p("router-link"),A=p("KButton"),g=p("KPrompt");return r(),v(P,{to:"#app"},[c(g,{"is-visible":e.isVisible,title:`Failed to save ${l.name}`,"tabbable-options":e.tabbableOptions,onCanceled:e.closeUpdateFileServerErrorModal},{"body-content":u(()=>[l.isRoleError?(r(),h("section",Bl,[o("form",null,[Rl,c(s,{to:{name:"portal-permissions-list"}},{default:u(()=>[Ul,c(d,{icon:"externalLink",width:"12",height:"12","view-box":"0 0 12 12"})]),_:1})]),Pl,Dl])):(r(),h("section",Il,[o("form",null,x(l.errorMessage),1),Yl,Tl]))]),"action-buttons":u(()=>[c(A,{appearance:"outline",onClick:e.closeUpdateFileServerErrorModal},{default:u(()=>[Kl]),_:1},8,["onClick"])]),_:1},8,["is-visible","title","tabbable-options","onCanceled"])])}const Nl=C(xl,[["render",_l]]),Ol={name:"UnsavedChangesModal",mixins:[E,U],computed:{...F(f,{isVisible:"showUnsavedChangesModal",file:"modalCtx"})},methods:{...m(b,["forceOpenFile"]),...m(f,["closeUnsavedChangesModal"]),discard(){this.forceOpenFile(this.file),this.closeUnsavedChangesModal()}}},Ql=e=>(B("data-v-0d318cfe"),e=e(),R(),e),zl=Ql(()=>o("form",null," There are unsaved changes in this file, do you want to discard them, or stay here to save them? ",-1)),Ll=y(" Discard Changes "),Gl=y(" Stay Here ");function Hl(e,t,a,n,i,l){const d=p("KButton"),s=p("KPrompt");return r(),v(P,{to:"#app"},[c(s,{"is-visible":e.isVisible,title:"Unsaved Changes","tabbable-options":e.tabbableOptions,class:"unsaved-changes-prompt"},{"body-content":u(()=>[zl]),"action-buttons":u(()=>[c(d,{appearance:"outline",onClick:l.discard},{default:u(()=>[Ll]),_:1},8,["onClick"]),c(d,{appearance:"primary",onClick:e.closeUnsavedChangesModal},{default:u(()=>[Gl]),_:1},8,["onClick"])]),_:1},8,["is-visible","tabbable-options"])])}const jl=C(Ol,[["render",Hl],["__scopeId","data-v-0d318cfe"]]),Jl={name:"EditorShow",components:{EditorSidebar:We,EditorToolbar:bt,PortalEditor:Mt,PortalViewer:Ut,CreateFileModal:tl,ContextMenu:Z,EditFileModal:zt,DeleteFileModal:sl,RenameFolderModal:Al,DeleteFolderModal:bl,UpdateFileErrorModal:Vl,UpdateFileServerErrorModal:Nl,UnsavedChangesModal:jl},mixins:[E,Fa],data(){var e;return{opener:(e=this.$route.query)==null?void 0:e.editorOpener}},computed:{...F(D,["layout"]),showEditor(){return this.layout==="code"||this.layout==="split"},showViewer(){return this.layout==="split"||this.layout==="portal"}},watch:{"$route.path"(){this.selectFileFromPath()}},async mounted(){this.fetchAllFiles(),this.selectFileFromPath()},unmounted(){this.clearEditorState()},methods:{...m(D,["clearEditorState"]),...m(b,["fetchAllFiles","openFile"]),selectFileFromPath(){let e=this.$route.params.pathMatch;!e||(e=e.slice(1),this.openFile({path:e},Boolean(this.opener)))}}},ql={class:"h-100"},Wl={class:"editor-window"},Xl={class:"row flex-grow-1"};function Zl(e,t,a,n,i,l){const d=p("EditorToolbar"),s=p("EditorSidebar"),A=p("PortalEditor"),g=p("PortalViewer"),$l=p("CreateFileModal"),ea=p("EditFileModal"),ta=p("DeleteFileModal"),la=p("RenameFolderModal"),aa=p("DeleteFolderModal"),ia=p("UpdateFileErrorModal"),oa=p("UpdateFileServerErrorModal"),sa=p("UnsavedChangesModal"),ra=p("ContextMenu");return r(),h("section",ql,[o("div",Wl,[c(d,{opener:i.opener},null,8,["opener"]),o("div",Xl,[c(s,{class:"editor-sidebar"}),o("div",{class:Y([e.layout,"editor-interfaces"])},[l.showEditor?(r(),v(A,{key:0,class:"widget editor"})):w("",!0),l.showViewer?(r(),v(g,{key:1,class:"widget viewer"})):w("",!0)],2)])]),c($l),c(ea),c(ta),c(la),c(aa),c(ia),c(oa),c(sa),c(ra)])}q=C(Jl,[["render",Zl],["__scopeId","data-v-2dd4fc0d"]])});export{Ma as __tla,q as default};
