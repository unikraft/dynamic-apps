/*
  This software is copyright Kong Inc. and its licensors.
  Use of the software is subject to the agreement between your organization
  and Kong Inc. If there is no such agreement, use is governed by and
  subject to the terms of the Kong Master Software License Agreement found
  at https://konghq.com/enterprisesoftwarelicense/.
*/

import{_ as ie,H as se,T as ne,z as pe,Q as ce,at as de,m as he,n as me,X as ue,g as _e,r as p,c as u,b as c,w as r,o as n,l as _,a as l,h as d,d as a,t as b,k as C,v as fe,ai as ye,p as ge,e as be,__tla as ke}from"./index.84d84090.3_3_0_0.js";import{E as we,__tla as Ce}from"./EntityList.9d5d453d.3_3_0_0.js";import{f as y}from"./fileHelper.9aab3c0f.3_3_0_0.js";import{D as ve,__tla as $e}from"./DisabledView.3ce50815.3_3_0_0.js";import{W as Me,__tla as Se}from"./WorkspaceMixin.71f3f83c.3_3_0_0.js";import{__tla as De}from"./monaco-editor.90904fcf.3_3_0_0.js";import{__tla as Fe}from"./preferences.ea825a88.3_3_0_0.js";import{__tla as Pe}from"./EntityListEmptyState.9b958bba.3_3_0_0.js";import{__tla as Ee}from"./EntityToggleBadge.6a1cd1fb.3_3_0_0.js";import{__tla as Te}from"./ConfirmModalDialog.af276128.3_3_0_0.js";import{__tla as Ae}from"./EntityDeleteModal.673d985c.3_3_0_0.js";import"./RedirectMixin.efeb36f2.3_3_0_0.js";let v,Le=Promise.all([(()=>{try{return ke}catch{}})(),(()=>{try{return Ce}catch{}})(),(()=>{try{return $e}catch{}})(),(()=>{try{return Se}catch{}})(),(()=>{try{return De}catch{}})(),(()=>{try{return Fe}catch{}})(),(()=>{try{return Pe}catch{}})(),(()=>{try{return Ee}catch{}})(),(()=>{try{return Te}catch{}})(),(()=>{try{return Ae}catch{}})()]).then(async()=>{const $={name:"DevPortal",components:{PageHeader:se,EntityList:we,DisabledView:ve},mixins:[Me,ne],data(){return{isLoading:!0,portalEnabled:null,fileName:null,authSettings:null,showDeleteModal:!1,showCreateModal:this.$route.params&&this.$route.params.showCreateModal,portalURL:null,pageType:this.$route.params.name,entityListOptions:{entity:"files",entityName:"File",params:{type:this.$route.params.name},fields:{name:{},type:{},created_at:{}}}}},computed:{...pe(ce,{portalDocs:"docsPortal"})},watch:{$route(){this.entityListOptions.params.type=this.$route.params.name,this.pageType=this.$route.params.name}},mounted(){this.getWorkspaceConfig().then(e=>{this.portalURL=de(e,this.workspace),this.portalEnabled=e.portal,this.isLoading=!1})},methods:{...he(me,["notify"]),formatCreatedAt(e){return ue(e)},openCreateModal(){this.showCreateModal=!0},closeCreateModal(){this.showCreateModal=!1},getPortalHref(e){return`${this.portalURL}/${e.name}`},isTypePage(e){return e.type==="page"},createFile(){return this.$api.createRecord("files",{name:this.fileName,type:this.pageType,auth:this.authSettings||!1,contents:"<h1>your content goes here</h1>"}).then(this.handleSubmit).catch(this.handleError)},handleSubmit(e){const i=e.data.id;return this.showCreateModal=!1,this.fileName=null,this.authSettings=null,this.$router.push({name:"edit",params:{id:i}}),this.notify({message:`'${e.data.name}' created successful!`,type:"success"})},handleError(e){return this.error=_e(e),this.notify({message:this.error,type:"danger"})},downloadFile(e){return this.$api.findRecord("files",e).then(i=>{const g=i.data.contents,k=i.data.type,t=y.getFileType(k,g),o=new Blob([g],{type:`text/${t}`}),f=`${y.stripFileName(i.data.name)}.${t}`;window.navigator.msSaveBlob?y.saveFileViaMsSaveBlob(o,f):y.saveFileViaDOM(o,f)})},capitalizeString(e){return e.replace(/^\w/,i=>i.toUpperCase())}}},h=e=>(ge("data-v-cff01673"),e=e(),be(),e),M={class:"dev-portal"},S={key:0},D=h(()=>l("strong",null,"The Dev Portal is disabled!",-1)),F=a(" To enable visit the "),P=a(" Portal Settings "),E=a(" page or visit our "),T=["href"],A=a(" to learn more. "),L={key:1},x={key:0},N={class:"row"},R={class:"col"},U=["href"],V=a(" Open "),O=h(()=>l("i",{class:"material-icons launch"},"launch",-1)),z=[V,O],H=a(" Edit "),B=a(" Download "),K=a(" No Files "),q=a(" Files provide the content and look and feel of your Dev Portal "),W=h(()=>l("label",{for:"filename"},"File Name",-1)),I=h(()=>l("label",{id:"auth-label",for:"auth"}," Require Authentication",-1)),Q=h(()=>l("p",null,[a("Files that require "),l("strong",null,"Authentication"),a(" are only shown to logged-in developers.")],-1)),X=h(()=>l("p",null,[a("Files that are "),l("strong",null,"Unauthenticated"),a(" will be public.")],-1)),j=a(" Create File "),G=a(" Dismiss ");function J(e,i,g,k,t,o){const f=p("router-link"),Y=p("DisabledView"),Z=p("PageHeader"),m=p("KButton"),w=p("RbacValidate"),ee=p("KEmptyState"),te=p("EntityList"),ae=p("KModal"),re=p("RbacEmptyList");return n(),u("section",M,[c(w,{workspace:e.workspace,restricted:[{path:`/workspaces/${e.workspace}`,actions:["read"]}]},{default:r(({isAllowed:oe})=>[oe?(n(),u("div",S,[!t.isLoading&&!t.portalEnabled?(n(),_(Y,{key:0,class:"mb-7"},{disabledMessage:r(()=>[D,F,c(f,{to:{name:"portal-settings"}},{default:r(()=>[P]),_:1}),E,l("a",{href:e.portalDocs.url},"documentation",8,T),A]),_:1})):d("",!0),c(Z,{title:`${e.workspace} Dev Portal `+t.pageType+"s"},null,8,["title"]),t.portalEnabled!=null?(n(),u("div",L,[t.portalEnabled?(n(),u("div",x,[l("div",N,[l("div",R,[c(w,{workspace:e.workspace,restricted:[{path:"/files",actions:["create"]}]},{default:r(({isAllowed:s})=>[s?(n(),_(m,{key:0,appearance:"primary",class:"float-right",onClick:o.openCreateModal},{default:r(()=>[a(" + Add "+b(o.capitalizeString(t.pageType)),1)]),_:1},8,["onClick"])):d("",!0)]),_:1},8,["workspace"])])]),t.portalEnabled?(n(),_(te,{key:0,options:t.entityListOptions,"show-update-action":!1},{created_at:r(s=>[a(b(o.formatCreatedAt(s.item.created_at)),1)]),extraActions:r(({item:s,rbac:le})=>[o.isTypePage(s)?(n(),u("a",{key:0,href:o.getPortalHref(s),class:"k-button btn-link mx-4",rel:"noopener",target:"_blank"},z,8,U)):d("",!0),le.isAllowedToUpdate?(n(),_(m,{key:1,id:"edit",to:{name:"edit",params:{id:s.id}},class:"mx-4",appearance:"btn-link"},{default:r(()=>[H]),_:2},1032,["to"])):d("",!0),c(m,{appearance:"btn-link",class:"mx-4",onClick:xe=>o.downloadFile(s.id)},{default:r(()=>[B]),_:2},1032,["onClick"])]),emptyState:r(()=>[c(ee,{"cta-text":"Create New File",onClick:o.openCreateModal},{title:r(()=>[K]),message:r(()=>[q]),_:1},8,["onClick"])]),_:1},8,["options"])):d("",!0)])):d("",!0)])):d("",!0),c(ae,{"is-visible":t.showCreateModal,title:`Add ${o.capitalizeString(t.pageType)} to Dev Portal`,"tabbable-options":e.tabbableOptions,onCanceled:o.closeCreateModal},{"header-content":r(()=>[a(" Add "+b(o.capitalizeString(t.pageType))+" to Dev Portal ",1)]),"body-content":r(()=>[l("form",null,[W,C(l("input",{"onUpdate:modelValue":i[0]||(i[0]=s=>t.fileName=s),class:"form-control",name:"filename"},null,512),[[fe,t.fileName]]),C(l("input",{id:"auth","onUpdate:modelValue":i[1]||(i[1]=s=>t.authSettings=s),type:"checkbox",name:"auth",class:"mr-2 form-control"},null,512),[[ye,t.authSettings]]),I]),Q,X]),"footer-content":r(()=>[c(m,{appearance:"primary",onClick:o.createFile},{default:r(()=>[j]),_:1},8,["onClick"]),c(m,{appearance:"outline",onClick:o.closeCreateModal},{default:r(()=>[G]),_:1},8,["onClick"])]),_:1},8,["is-visible","title","tabbable-options","onCanceled"])])):(n(),_(re,{key:1}))]),_:1},8,["workspace","restricted"])])}v=ie($,[["render",J],["__scopeId","data-v-cff01673"]])});export{Le as __tla,v as default};
