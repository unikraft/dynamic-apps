/*
  This software is copyright Kong Inc. and its licensors.
  Use of the software is subject to the agreement between your organization
  and Kong Inc. If there is no such agreement, use is governed by and
  subject to the terms of the Kong Master Software License Agreement found
  at https://konghq.com/enterprisesoftwarelicense/.
*/

import{_ as ii,N as ai,X as oi,M as ri,z as lt,Z as si,u as li,J as ci,m as ie,n as di,Y as ae,g as ui,r as b,l as A,w as m,o as _,c as O,a as E,G as P,b as S,O as oe,U as hi,V as re,R as H,d as T,t as C,h as $,p as pi,e as fi,__tla as yi}from"./index.84d84090.3_3_0_0.js";import{E as gi,p as wi,u as se,__tla as _i}from"./preferences.ea825a88.3_3_0_0.js";import{E as vi,__tla as bi}from"./EntityListEmptyState.9b958bba.3_3_0_0.js";import{E as mi,a as Ei,b as Ai,__tla as Ti}from"./EntityToggleBadge.6a1cd1fb.3_3_0_0.js";import{E as ki,__tla as Ci}from"./EntityDeleteModal.673d985c.3_3_0_0.js";import{R as Ri}from"./RedirectMixin.efeb36f2.3_3_0_0.js";import{c as ct,__tla as Si}from"./monaco-editor.90904fcf.3_3_0_0.js";let le,Oi=Promise.all([(()=>{try{return yi}catch{}})(),(()=>{try{return _i}catch{}})(),(()=>{try{return bi}catch{}})(),(()=>{try{return Ti}catch{}})(),(()=>{try{return Ci}catch{}})(),(()=>{try{return Si}catch{}})()]).then(async()=>{var dt={exports:{}};(function(i,r){var o=200,y="__lodash_hash_undefined__",l=800,s=16,U=9007199254740991,L="[object Arguments]",ut="[object Array]",W="[object AsyncFunction]",x="[object Boolean]",ht="[object Date]",pt="[object Error]",Y="[object Function]",X="[object GeneratorFunction]",ft="[object Map]",V="[object Number]",yt="[object Null]",Z="[object Object]",gt="[object Proxy]",wt="[object RegExp]",_t="[object Set]",vt="[object String]",d="[object Undefined]",c="[object WeakMap]",v="[object ArrayBuffer]",B="[object DataView]",bt="[object Float32Array]",je="[object Float64Array]",$e="[object Int8Array]",Ue="[object Int16Array]",xe="[object Int32Array]",ze="[object Uint8Array]",Ne="[object Uint8ClampedArray]",Fe="[object Uint16Array]",Pe="[object Uint32Array]",Le=/[\\^$.*+?()[\]{}|]/g,Me=/^\[object .+?Constructor\]$/,Ie=/^(?:0|[1-9]\d*)$/,f={};f[bt]=f[je]=f[$e]=f[Ue]=f[xe]=f[ze]=f[Ne]=f[Fe]=f[Pe]=!0,f[L]=f[ut]=f[v]=f[x]=f[B]=f[ht]=f[pt]=f[Y]=f[ft]=f[V]=f[Z]=f[wt]=f[_t]=f[vt]=f[c]=!1;var Ut=typeof ct=="object"&&ct&&ct.Object===Object&&ct,He=typeof self=="object"&&self&&self.Object===Object&&self,q=Ut||He||Function("return this")(),xt=r&&!r.nodeType&&r,K=xt&&!0&&i&&!i.nodeType&&i,zt=K&&K.exports===xt,mt=zt&&Ut.process,Nt=function(){try{var t=K&&K.require&&K.require("util").types;return t||mt&&mt.binding&&mt.binding("util")}catch{}}(),Ft=Nt&&Nt.isTypedArray;function Ve(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Be(t,e){for(var n=-1,a=Array(t);++n<t;)a[n]=e(n);return a}function qe(t){return function(e){return t(e)}}function Ke(t,e){return t==null?void 0:t[e]}function Je(t,e){return function(n){return t(e(n))}}var Ge=Array.prototype,Qe=Function.prototype,tt=Object.prototype,Et=q["__core-js_shared__"],et=Qe.toString,D=tt.hasOwnProperty,Pt=function(){var t=/[^.]+$/.exec(Et&&Et.keys&&Et.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Lt=tt.toString,We=et.call(Object),Ye=RegExp("^"+et.call(D).replace(Le,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nt=zt?q.Buffer:void 0,Mt=q.Symbol,It=q.Uint8Array,Ht=nt?nt.allocUnsafe:void 0,Vt=Je(Object.getPrototypeOf,Object),Bt=Object.create,Xe=tt.propertyIsEnumerable,Ze=Ge.splice,z=Mt?Mt.toStringTag:void 0,it=function(){try{var t=kt(Object,"defineProperty");return t({},"",{}),t}catch{}}(),tn=nt?nt.isBuffer:void 0,qt=Math.max,en=Date.now,Kt=kt(q,"Map"),J=kt(Object,"create"),nn=function(){function t(){}return function(e){if(!F(e))return{};if(Bt)return Bt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function N(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var a=t[e];this.set(a[0],a[1])}}function an(){this.__data__=J?J(null):{},this.size=0}function on(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function rn(t){var e=this.__data__;if(J){var n=e[t];return n===y?void 0:n}return D.call(e,t)?e[t]:void 0}function sn(t){var e=this.__data__;return J?e[t]!==void 0:D.call(e,t)}function ln(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=J&&e===void 0?y:e,this}N.prototype.clear=an,N.prototype.delete=on,N.prototype.get=rn,N.prototype.has=sn,N.prototype.set=ln;function j(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var a=t[e];this.set(a[0],a[1])}}function cn(){this.__data__=[],this.size=0}function dn(t){var e=this.__data__,n=at(e,t);if(n<0)return!1;var a=e.length-1;return n==a?e.pop():Ze.call(e,n,1),--this.size,!0}function un(t){var e=this.__data__,n=at(e,t);return n<0?void 0:e[n][1]}function hn(t){return at(this.__data__,t)>-1}function pn(t,e){var n=this.__data__,a=at(n,t);return a<0?(++this.size,n.push([t,e])):n[a][1]=e,this}j.prototype.clear=cn,j.prototype.delete=dn,j.prototype.get=un,j.prototype.has=hn,j.prototype.set=pn;function M(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var a=t[e];this.set(a[0],a[1])}}function fn(){this.size=0,this.__data__={hash:new N,map:new(Kt||j),string:new N}}function yn(t){var e=rt(this,t).delete(t);return this.size-=e?1:0,e}function gn(t){return rt(this,t).get(t)}function wn(t){return rt(this,t).has(t)}function _n(t,e){var n=rt(this,t),a=n.size;return n.set(t,e),this.size+=n.size==a?0:1,this}M.prototype.clear=fn,M.prototype.delete=yn,M.prototype.get=gn,M.prototype.has=wn,M.prototype.set=_n;function I(t){var e=this.__data__=new j(t);this.size=e.size}function vn(){this.__data__=new j,this.size=0}function bn(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function mn(t){return this.__data__.get(t)}function En(t){return this.__data__.has(t)}function An(t,e){var n=this.__data__;if(n instanceof j){var a=n.__data__;if(!Kt||a.length<o-1)return a.push([t,e]),this.size=++n.size,this;n=this.__data__=new M(a)}return n.set(t,e),this.size=n.size,this}I.prototype.clear=vn,I.prototype.delete=bn,I.prototype.get=mn,I.prototype.has=En,I.prototype.set=An;function Tn(t,e){var n=St(t),a=!n&&Rt(t),h=!n&&!a&&Yt(t),p=!n&&!a&&!h&&Zt(t),g=n||a||h||p,u=g?Be(t.length,String):[],w=u.length;for(var R in t)(e||D.call(t,R))&&!(g&&(R=="length"||h&&(R=="offset"||R=="parent")||p&&(R=="buffer"||R=="byteLength"||R=="byteOffset")||Qt(R,w)))&&u.push(R);return u}function At(t,e,n){(n!==void 0&&!st(t[e],n)||n===void 0&&!(e in t))&&Tt(t,e,n)}function kn(t,e,n){var a=t[e];(!(D.call(t,e)&&st(a,n))||n===void 0&&!(e in t))&&Tt(t,e,n)}function at(t,e){for(var n=t.length;n--;)if(st(t[n][0],e))return n;return-1}function Tt(t,e,n){e=="__proto__"&&it?it(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var Cn=Ln();function ot(t){return t==null?t===void 0?d:yt:z&&z in Object(t)?Mn(t):Kn(t)}function Jt(t){return G(t)&&ot(t)==L}function Rn(t){if(!F(t)||Bn(t))return!1;var e=Dt(t)?Ye:Me;return e.test(Wn(t))}function Sn(t){return G(t)&&Xt(t.length)&&!!f[ot(t)]}function On(t){if(!F(t))return qn(t);var e=Wt(t),n=[];for(var a in t)a=="constructor"&&(e||!D.call(t,a))||n.push(a);return n}function Gt(t,e,n,a,h){t!==e&&Cn(e,function(p,g){if(h||(h=new I),F(p))Dn(t,e,g,n,Gt,a,h);else{var u=a?a(Ct(t,g),p,g+"",t,e,h):void 0;u===void 0&&(u=p),At(t,g,u)}},te)}function Dn(t,e,n,a,h,p,g){var u=Ct(t,n),w=Ct(e,n),R=g.get(w);if(R){At(t,n,R);return}var k=p?p(u,w,n+"",t,e,g):void 0,Q=k===void 0;if(Q){var jt=St(w),$t=!jt&&Yt(w),ne=!jt&&!$t&&Zt(w);k=w,jt||$t||ne?St(u)?k=u:Yn(u)?k=Nn(u):$t?(Q=!1,k=Un(w,!0)):ne?(Q=!1,k=zn(w,!0)):k=[]:Xn(w)||Rt(w)?(k=u,Rt(u)?k=Zn(u):(!F(u)||Dt(u))&&(k=In(w))):Q=!1}Q&&(g.set(w,k),h(k,w,a,p,g),g.delete(w)),At(t,n,k)}function jn(t,e){return Gn(Jn(t,e,ee),t+"")}var $n=it?function(t,e){return it(t,"toString",{configurable:!0,enumerable:!1,value:ei(e),writable:!0})}:ee;function Un(t,e){if(e)return t.slice();var n=t.length,a=Ht?Ht(n):new t.constructor(n);return t.copy(a),a}function xn(t){var e=new t.constructor(t.byteLength);return new It(e).set(new It(t)),e}function zn(t,e){var n=e?xn(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Nn(t,e){var n=-1,a=t.length;for(e||(e=Array(a));++n<a;)e[n]=t[n];return e}function Fn(t,e,n,a){var h=!n;n||(n={});for(var p=-1,g=e.length;++p<g;){var u=e[p],w=a?a(n[u],t[u],u,n,t):void 0;w===void 0&&(w=t[u]),h?Tt(n,u,w):kn(n,u,w)}return n}function Pn(t){return jn(function(e,n){var a=-1,h=n.length,p=h>1?n[h-1]:void 0,g=h>2?n[2]:void 0;for(p=t.length>3&&typeof p=="function"?(h--,p):void 0,g&&Hn(n[0],n[1],g)&&(p=h<3?void 0:p,h=1),e=Object(e);++a<h;){var u=n[a];u&&t(e,u,a,p)}return e})}function Ln(t){return function(e,n,a){for(var h=-1,p=Object(e),g=a(e),u=g.length;u--;){var w=g[t?u:++h];if(n(p[w],w,p)===!1)break}return e}}function rt(t,e){var n=t.__data__;return Vn(e)?n[typeof e=="string"?"string":"hash"]:n.map}function kt(t,e){var n=Ke(t,e);return Rn(n)?n:void 0}function Mn(t){var e=D.call(t,z),n=t[z];try{t[z]=void 0;var a=!0}catch{}var h=Lt.call(t);return a&&(e?t[z]=n:delete t[z]),h}function In(t){return typeof t.constructor=="function"&&!Wt(t)?nn(Vt(t)):{}}function Qt(t,e){var n=typeof t;return e=e??U,!!e&&(n=="number"||n!="symbol"&&Ie.test(t))&&t>-1&&t%1==0&&t<e}function Hn(t,e,n){if(!F(n))return!1;var a=typeof e;return(a=="number"?Ot(n)&&Qt(e,n.length):a=="string"&&e in n)?st(n[e],t):!1}function Vn(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Bn(t){return!!Pt&&Pt in t}function Wt(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||tt;return t===n}function qn(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}function Kn(t){return Lt.call(t)}function Jn(t,e,n){return e=qt(e===void 0?t.length-1:e,0),function(){for(var a=arguments,h=-1,p=qt(a.length-e,0),g=Array(p);++h<p;)g[h]=a[e+h];h=-1;for(var u=Array(e+1);++h<e;)u[h]=a[h];return u[e]=n(g),Ve(t,this,u)}}function Ct(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var Gn=Qn($n);function Qn(t){var e=0,n=0;return function(){var a=en(),h=s-(a-n);if(n=a,h>0){if(++e>=l)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Wn(t){if(t!=null){try{return et.call(t)}catch{}try{return t+""}catch{}}return""}function st(t,e){return t===e||t!==t&&e!==e}var Rt=Jt(function(){return arguments}())?Jt:function(t){return G(t)&&D.call(t,"callee")&&!Xe.call(t,"callee")},St=Array.isArray;function Ot(t){return t!=null&&Xt(t.length)&&!Dt(t)}function Yn(t){return G(t)&&Ot(t)}var Yt=tn||ni;function Dt(t){if(!F(t))return!1;var e=ot(t);return e==Y||e==X||e==W||e==gt}function Xt(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=U}function F(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function G(t){return t!=null&&typeof t=="object"}function Xn(t){if(!G(t)||ot(t)!=Z)return!1;var e=Vt(t);if(e===null)return!0;var n=D.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&et.call(n)==We}var Zt=Ft?qe(Ft):Sn;function Zn(t){return Fn(t,te(t))}function te(t){return Ot(t)?Tn(t,!0):On(t)}var ti=Pn(function(t,e,n,a){Gt(t,e,n,a)});function ei(t){return function(){return t}}function ee(t){return t}function ni(){return!1}i.exports=ti})(dt,dt.exports);const ce=dt.exports,de={name:"EntityList",components:{EntityListActions:gi,EntityListEmptyState:vi,EntityTags:mi,EntityToggleBadge:Ei,EntityToggleModal:Ai,EntityDeleteModal:ki},mixins:[ai,Ri],props:{options:{type:Object,default:()=>({size:null,offset:null,query:null,searchField:null,sortKey:"",fields:{},showCtaLink:!0,ctaMessage:"",helpMessage:"",responseTransform:null})},unsortableFields:{type:Array,default:()=>[]},showViewAction:{type:Boolean,default:!1},showUpdateAction:{type:Boolean,default:!0},showDeleteAction:{type:Boolean,default:!0},disableUpdateEntities:{type:Array,default:()=>[]},customActions:{type:Array,default:()=>[],required:!1},rowClickHandler:{type:Function,default:null},defaultRowClickAction:{type:String,default:"view",validator:i=>["view","update","delete"].indexOf(i)!==-1},enableEntityActions:{type:Boolean,default:!1},canEdit:{type:Boolean,default:!0},overflowActions:{type:Boolean,default:!1},disableRowClick:{type:Boolean,default:!1},viewActionFields:{type:Array,default:()=>[]},viewActionHandler:{type:[Function,String],default:null},updateActionHandler:{type:[Function,String],default:null},rowCopyTransformer:{type:Function,default:null}},emits:["after-delete"],data(){return{items:[],previous:[],next:null,offset:this.options.offset||null,pageSizeItems:wi.map((i,r)=>({label:`${i}`,key:`size-${r}`,value:i})),dedicatedPageSize:this.options.size,query:this.options.query||"",fetcherCacheKey:new Date().getTime().toString(),hasCache:!1,cacheData:{total:0,data:[]},searchField:this.options.searchField||null,deleteItemInfo:null,sortOrder:"ascending",sortKey:"",hasError:!1,errorMessage:"",formatDate:oi,lang:{NO_RECORDS:`Configure a New ${this.options.entityName}`,NO_RECORDS_CTA:`New ${this.options.entityName}`,NO_SEARCH_RESULTS:"No results found",NO_SEARCH_RESULTS_INFO:"You can adjust your search parameters and try again.",PREVIOUS:"Previous",NEXT:"Next",VIEW:"View",UPDATE:"Edit",DELETE:"Delete",RESET:"Reset",RESET_SEARCH:"Reset Search",MODAL_CONTENT:{itemName:null,proceedText:null,dismissText:null,doubleCheckInput:""}},machine:ri({id:"listMachine",initial:"idle",states:{idle:{on:{FETCH:"pending"}},pending:{on:{RESOLVE:"success",REJECT:"error",NO_RESULTS:"no_results"}},no_results:{on:{FETCH:"pending"}},success:{on:{DELETE:"deleting",TOGGLE:"toggling",REJECT:"error",FETCH:"pending"}},toggling:{on:{RESOLVE:"success",REJECT:"success"}},deleting:{on:{RESOLVE:"success",REJECT:"success"}},error:{on:{FETCH:"pending"}}}}),hideSearch:!1,isEmpty:!0,toggleModalRecord:null,deleteModalModel:null}},computed:{...lt(si,{datastore:"infoDatastore"}),...lt(li,{perms:"permissions"}),...lt(ci,["workspace"]),...lt(se,["listPageSize"]),size(){return this.dedicatedPageSize||this.listPageSize},isPostgres(){return this.datastore&&this.datastore.type==="postgres"},confirmButtonText(){return this.currentState==="deleting"?"Deleting...":this.lang.MODAL_CONTENT.proceedText},searchableFields(){return Object.keys(this.options.fields).filter(i=>this.options.fields[i].searchable).map(i=>({text:this.options.fields[i].label||i,value:i}))},headers(){const i=this.options.fields,r=[];return delete i.comparator,Object.keys(i).forEach(o=>{let y=i[o].label?i[o].label:o;/^id$/.test(y)&&(y="ID"),r.push({label:y,key:o,sortable:!this.unsortableFields.includes(o)})}),this.enableEntityActions&&r.push({key:"entityActions",hideLabel:!0}),r.length>0?r:[]},rbacEndpoint(){return`/${this.options.endpoint||this.options.entity}`},tableWrapperClass(){return{"entity-list-table":!0,"with-overflow-actions":Boolean(this.overflowActions),"entity-list-table-clickable":!this.disableRowClick}}},watch:{query:{handler:function(){this.hasCache=!1,this.cacheData={total:0,data:[]}},immediate:!0,deep:!0}},mounted(){this.transition("FETCH")},methods:{...ie(di,["notify"]),isAllowedToRead(i){return this.$rbac.isAllowed(this.perms,[{path:`${this.rbacEndpoint}/${i}`,actions:["read"]}],this.workspace)},isAllowedToUpdate(i){return this.$rbac.isAllowed(this.perms,[{path:`${this.rbacEndpoint}/${i}`,actions:["update"]}],this.workspace)},isAllowedToDelete(i){return this.$rbac.isAllowed(this.perms,[{path:`${this.rbacEndpoint}/${i}`,actions:["delete"]}],this.workspace)},canRead(i){return this.showViewAction&&this.isAllowedToRead(i)},canUpdate(i){return this.showUpdateAction&&this.isAllowedToUpdate(i)},canDelete(i){return this.showDeleteAction&&this.isAllowedToDelete(i)},...ie(se,["setListPageSize"]),formatValue(i,r){return i&&i.encrypted?"********":(r==null&&(r=""),r.toString())},init(i){!i||!this.searchField&&this.searchableFields.length&&(this.searchField=this.searchableFields[0].value)},reloadData(){this.hasCache=!1,this.fetcherCacheKey=new Date().getTime().toString()},goToPreviousPage(){return this.offset=this.previous.pop(),this.next=null,this.reloadData()},goToNextPage(){return this.previous.push(this.offset),this.offset=this.next,this.next=null,this.reloadData()},buildEntityUpdatePath(i){const r=this.options||{};let o=r.entity;const y=r.viewPath;let l=i.id||i.name;const s=this.$route.params.workspace||"default";return o==="plugins"&&(l=`${i.name}/${l}`),y&&(o=y),`/${r.parentRoute||s}/${o}/${l}/update`},showEntity(i){const r=this.options;let o=r.entity;const y=r.viewPath;let l=i.id||i.name;const s=this.$route.params.workspace||"default";return o==="plugins"&&(l=`${i.name}/${l}`),o==="rbac/roles"?`/teams/roles/${s}/${l}`:(y&&(o=y),`/${s}/${o}/${l}`)},flatten(i){const r={};function o(y){Object.keys(y).forEach(l=>r[l]=y[l])}return o(i),r},clearSearch(){this.query=null,this.offset=null,this.hasCache=!1,this.options.params&&this.options.params[this.searchField]&&delete this.options.params[this.searchField]},resetPagination(){this.offset=null,this.next=null,this.previous=[]},updatePageSize({value:i}){return this.dedicatedPageSize?this.dedicatedPageSize=i:this.setListPageSize(i),this.resetPagination(),this.reloadData()},async fetcher(i){const r=i.sortColumnKey;if(r&&(this.hasCache=!1),this.hasCache)return this.cacheData;const o=this.options.params||{},y=i.query;o.offset=this.offset,o.size=this.size;let l=[];if(y&&(new URLSearchParams(y).forEach((U,L)=>{o[L]=U}),o.id&&o.id.length>0))return l=await this.$api.findRecord(this.options.entity,o.id,this.options.queryFormat).then(this.handleResponse).catch(this.handleError),l?{data:[l.data]}:{data:[]};r&&(o.sort_by=r,i.sortColumnOrder==="desc"&&(o.sort_desc=1)),l=await this.$api.findAll(this.options.endpoint||this.options.entity,o).then(this.handleResponse).catch(this.handleError);const s=l&&l.data&&l.data.data;return this.isEmpty=!s||!s.length,this.hideSearch=!y&&this.isEmpty,this.next=!this.isEmpty&&l.data.offset,this.cacheData={total:this.size,data:s},this.hasCache=!0,this.cacheData},handleResponse(i){return this.transition("RESOLVE"),typeof this.options.responseTransform=="function"?this.options.responseTransform(i):i},handleError(i){if(i&&i.response&&i.response.status&&(i.response.status===404||i.response.status===400))return this.transition("NO_RESULTS"),null;this.hasError=!0,this.errorMessage=i.message,this.transition("REJECT")},confirmDeleteItem(i){this.deleteModalModel={record:i},this.deleteItemId=i.id||i.name,this.lang.MODAL_CONTENT={itemName:ae(i),proceedText:`Delete ${this.options.entityName}`,doubleCheckInput:""}},dismissDeleteItem(){this.deleteItemInfo=null},deleteItem(i){const r=ae(i,this.options.entity),o=this.options.endpoint||this.options.entity;return this.transition("DELETE"),this.$api.deleteRecord(o,i.id||i.name).then(()=>{this.deleteItemInfo=null,this.transition("RESOLVE"),this.resetPagination(),this.$emit("after-delete"),this.reloadData()}).then(()=>{this.notify({message:`${r} ${this.options.entityName} successfully deleted!`,type:"success"})}).catch(y=>{this.transition("REJECT"),this.deleteItemInfo=null,this.notify({message:ui(y),type:"danger"})})},createEntity(){const i={query:this.options.createRouteQuery};return this.options.createRouteName?i.name=this.options.createRouteName:typeof this.options.createRoute=="string"?i.path=`${this.options.createRoute}`:ce(i,this.options.createRoute),i},handleRowClick(i,r){if(!this.disableRowClick){if(this.rowClickHandler)return this.rowClickHandler(i,r);switch(this.defaultRowClickAction){case"view":this.isAllowedToRead(r.id)&&this.handleViewAction(r);break;case"update":this.isAllowedToUpdate(r.id)&&this.handleUpdateAction(r);break;case"delete":this.isAllowedToDelete(r.id)&&this.confirmDeleteItem(r);break}}},rowAttrsFn(i){return{"data-rowid":i.id,"data-testid":i.name}},handleViewAction(i){if(this.viewActionHandler)switch(typeof this.viewActionHandler){case"function":this.viewActionHandler(i);return;case"string":if(this.viewActionHandler==="update"){this.handleUpdateAction(i);return}}this.$router.push({path:this.showEntity(i),query:{...this.options.withRedirectQuery?this.createRedirectRouteQuery():null,...this.options.viewRouteQuery}})},handleCopyAction(i,r){if(!r(JSON.stringify(typeof this.rowCopyTransformer=="function"?this.rowCopyTransformer(i):i)))return this.notify({message:"error, failed to copy",type:"danger"});this.notify({message:"Successfully copied to clipboard",type:"success"})},handleUpdateAction(i){if(this.updateActionHandler)switch(typeof this.updateActionHandler){case"function":this.updateActionHandler(i);return;case"string":if(this.viewActionHandler==="view"){this.handleViewAction(i);return}}this.$router.push({path:this.buildEntityUpdatePath(i),query:{...this.options.withRedirectQuery?this.createRedirectRouteQuery():null}})},tableCellClassesFn(i){return{"d-inline-flex":!0,"vertical-center":!0,clickable:i==="enabled"||this.viewActionFields.includes(i),"view-action":this.viewActionFields.includes(i)}},cellClickHandler(i,r,o){if(this.disableRowClick)switch(o){case this.viewActionFields.find(y=>y===o):this.isAllowedToRead(r.row.id)&&this.handleViewAction(r.row);break}},onToggleTransition(i){this.transition(i)},onToggleChange({record:i,key:r,state:o}){i[r]=o},onDeleteTransition(i){switch(this.transition(i),i){case"RESOLVE":this.resetPagination(),this.reloadData();break}}}},ue=i=>(pi("data-v-57d4fedd"),i=i(),fi(),i),he={key:0,class:"entity-list"},pe={class:"row clearfix"},fe={class:"col"},ye=["data-testid","data-testaction","onClick"],ge=["data-testid"],we=T(" Copy JSON "),_e={class:"no-results"},ve={key:0,class:"text-center my-2"},be={class:"row justify-content-md-center"},me={class:"col-12"},Ee={class:"col-lg-6 col-md-12 mx-auto"},Ae={key:0,class:"pagination"},Te=ue(()=>E("div",{class:"summary"},null,-1)),ke={class:"pagination-buttons"},Ce=T(" \u2190 "),Re=T(" \u2192 "),Se={class:"page-size-select","data-testid":"page-size-select"},Oe={key:1};function De(i,r,o,y,l,s){const U=b("CopyUuid"),L=b("router-link"),ut=b("EntityToggleBadge"),W=b("EntityTags"),x=b("KDropdownItem"),ht=b("KClipboardProvider"),pt=b("KIcon"),Y=b("EntityListActions"),X=b("EntityListEmptyState"),ft=b("KTable"),V=b("KButton"),yt=b("KSelect"),Z=b("EntityToggleModal"),gt=b("EntityDeleteModal"),wt=b("RbacEmptyList"),_t=b("RbacValidate");return _(),A(_t,{workspace:i.workspace,restricted:[{path:s.rbacEndpoint,actions:["read"]}],callback:s.init},{default:m(({isAllowed:vt})=>[vt?(_(),O("div",he,[E("div",pe,[E("div",fe,[P(i.$slots,"header",{},void 0,!0)])]),E("div",{class:re(s.tableWrapperClass)},[E("div",null,[S(ft,{headers:s.headers,fetcher:s.fetcher,"fetcher-cache-key":l.fetcherCacheKey,"search-input":l.query,"has-error":l.hasError,"has-hover":!o.disableRowClick,"error-state-title":l.errorMessage,"row-attrs":s.rowAttrsFn,"enable-client-sort":!s.isPostgres,"disable-pagination":"","onRow:click":s.handleRowClick,onSort:s.resetPagination},oe({"empty-state":m(()=>[P(i.$slots,"empty-state",{},()=>[l.query&&l.query.length>0?(_(),A(X,{key:0,title:l.lang.NO_SEARCH_RESULTS,"show-cta-link":!1,message:l.lang.NO_SEARCH_RESULTS_INFO,transparent:""},null,8,["title","message"])):(_(),A(X,{key:1,"rbac-settings":{workspace:i.workspace,restricted:[{path:s.rbacEndpoint,actions:["create"]}]},title:o.options.emptyTitle||l.lang.NO_RECORDS,"can-edit":o.canEdit,"show-cta-link":o.options.showCtaLink,message:o.options.helpMessage||"","cta-text":o.options.ctaMessage||l.lang.NO_RECORDS_CTA,"cta-path":s.createEntity(),transparent:""},null,8,["rbac-settings","title","can-edit","show-cta-link","message","cta-text","cta-path"]))],!0)]),_:2},[hi(o.options.fields,(d,c)=>({name:c,fn:m(v=>[E("div",{"data-testid":c,"data-testaction":o.viewActionFields.includes(c)?"td-view":void 0,class:re(s.tableCellClassesFn(c)),onClick:B=>s.cellClickHandler(B,v,c)},[P(i.$slots,c,{item:v.row},()=>[d.encrypted&&s.canUpdate(v.row.id)?(_(),A(U,{key:0,uuid:v.row[c].toString(),"is-hidden":!0},null,8,["uuid"])):c==="id"?(_(),A(U,{key:1,uuid:v.row[c].toString()},null,8,["uuid"])):c==="created_at"?(_(),O(H,{key:2},[T(C(l.formatDate(v.row[c])),1)],64)):c==="meta.full_name"?(_(),O(H,{key:3},[T(C(v.row.meta&&JSON.parse(v.row.meta).full_name),1)],64)):c==="application.name"?(_(),O(H,{key:4},[T(C(v.row.application.name),1)],64)):c==="name/id"?(_(),O(H,{key:5},[T(C(v.row.name),1)],64)):c==="service"?(_(),A(L,{key:6,to:{name:"show-service",params:{id:v.row.service.id}}},{default:m(()=>[T(C(v.row.service.id),1)]),_:2},1032,["to"])):c==="enabled"?(_(),A(ut,{key:7,entity:o.options.entity,"entity-name":o.options.entityName,record:v.row,disabled:i.currentState==="toggling",onTransition:s.onToggleTransition,onUpdateRecord:(B,bt)=>v.row[B]=bt},null,8,["entity","entity-name","record","disabled","onTransition","onUpdateRecord"])):c==="tags"?(_(),A(W,{key:8,tags:v.row[c]||[]},null,8,["tags"])):Array.isArray(v.row[c])?(_(),A(W,{key:9,tags:v.row[c]},null,8,["tags"])):(_(),O(H,{key:10},[T(C(s.formatValue(d,v.row[c])),1)],64))],!0)],10,ye)])})),o.enableEntityActions?{name:"entityActions",fn:m(d=>[E("div",{"data-testid":d.row.name,class:"float-right"},[S(Y,{overflow:o.overflowActions},{default:m(()=>[s.canRead(d.row.id)?(_(),A(x,{key:0,"data-testaction":"menu-view",onClick:c=>s.handleViewAction(d.row)},{default:m(()=>[T(C(o.options.viewText||l.lang.VIEW),1)]),_:2},1032,["onClick"])):$("",!0),S(ht,null,{default:m(({copyToClipboard:c})=>[s.canRead(d.row.id)?(_(),A(x,{key:0,"data-testaction":"menu-copy",onClick:v=>s.handleCopyAction(d.row,c)},{default:m(()=>[we]),_:2},1032,["onClick"])):$("",!0)]),_:2},1024),P(i.$slots,"extraViewActions",{item:d.row,rbac:{isAllowedToRead:s.isAllowedToRead(d.row.id),isAllowedToUpdate:s.isAllowedToUpdate(d.row.id),isAllowedToDelete:s.isAllowedToDelete(d.row.id)}},void 0,!0),s.canUpdate(d.row.id)&&!o.disableUpdateEntities.find(c=>d.row[c])?(_(),A(x,{key:1,"data-testaction":"menu-update",onClick:c=>s.handleUpdateAction(d.row)},{default:m(()=>[T(C(o.options.editText||l.lang.UPDATE),1)]),_:2},1032,["onClick"])):$("",!0),P(i.$slots,"extraActions",{item:d.row,rbac:{isAllowedToRead:s.isAllowedToRead(d.row.id),isAllowedToUpdate:s.isAllowedToUpdate(d.row.id),isAllowedToDelete:s.isAllowedToDelete(d.row.id)}},void 0,!0),o.options.fields.enabled?(_(),O(H,{key:2},[s.canUpdate(d.row.id)&&!o.disableUpdateEntities.find(c=>d.row[c])?(_(),A(x,{key:0,"data-testaction":"menu-toggle","has-divider":"",onClick:c=>l.toggleModalRecord=d.row},{default:m(()=>[T(C(Boolean(d.row.enabled)?"Disable":"Enable"),1)]),_:2},1032,["onClick"])):$("",!0)],64)):$("",!0),s.canDelete(d.row.id)&&!o.disableUpdateEntities.find(c=>d.row[c])?(_(),A(x,{key:3,"data-testaction":"menu-delete","has-divider":"","is-dangerous":"",onClick:c=>s.confirmDeleteItem(d.row)},oe({_:2},[o.overflowActions?{name:"default",fn:m(()=>[T(C(l.lang.DELETE),1)])}:{name:"icon",fn:m(()=>[S(pt,{"view-box":"0 0 20 20",icon:"trash",size:"16"})])}]),1032,["onClick"])):$("",!0)]),_:2},1032,["overflow"])],8,ge)])}:void 0]),1032,["headers","fetcher","fetcher-cache-key","search-input","has-error","has-hover","error-state-title","row-attrs","enable-client-sort","onRow:click","onSort"]),P(i.$slots,"emptyContent",{},()=>[E("div",_e,[i.currentState==="no_results"?(_(),O("div",ve,[E("div",be,[E("div",me,[E("h4",null,C(l.lang.NO_SEARCH_RESULTS),1)]),E("div",Ee,[E("p",null,C(l.lang.NO_SEARCH_RESULTS_INFO),1),S(V,{appearance:"outline",onClick:s.clearSearch},{default:m(()=>[T(C(l.lang.RESET_SEARCH),1)]),_:1},8,["onClick"])])])])):$("",!0)])],!0)])],2),l.isEmpty?$("",!0):(_(),O("div",Ae,[Te,E("div",ke,[S(V,{disabled:l.previous.length<1,"aria-label":"Go to the previous page",appearance:"btn-link",class:"mx-5","data-testid":"previous",onClick:s.goToPreviousPage},{default:m(()=>[Ce]),_:1},8,["disabled","onClick"]),S(V,{disabled:!l.next,"aria-label":"Go to the next page",appearance:"btn-link",class:"mx-5","data-testid":"next",onClick:s.goToNextPage},{default:m(()=>[Re]),_:1},8,["disabled","onClick"])]),E("span",Se,[S(yt,{placeholder:`${s.size} items per page`,items:l.pageSizeItems,"button-text":`${s.size} items per page`,"kpop-attributes":{placemenet:"top"},appearance:"button",onSelected:s.updatePageSize},null,8,["placeholder","items","button-text","onSelected"])])])),P(i.$slots,"customModal",{},void 0,!0),S(Z,{record:l.toggleModalRecord,entity:o.options.entity,"entity-name":o.options.entityName,disabled:i.currentState==="toggling",loading:i.currentState==="toggling",onTransition:s.onToggleTransition,onDismiss:r[0]||(r[0]=d=>l.toggleModalRecord=null),onUpdateRecord:r[1]||(r[1]=(d,c)=>l.toggleModalRecord[d]=c)},null,8,["record","entity","entity-name","disabled","loading","onTransition"]),S(gt,{modelValue:l.deleteModalModel,"onUpdate:modelValue":r[2]||(r[2]=d=>l.deleteModalModel=d),entity:o.options.entity,endpoint:o.options.endpoint,"entity-name":o.options.entityName,disabled:i.currentState==="deleting",loading:i.currentState==="deleting",class:"defaultModal",onDelete:r[3]||(r[3]=d=>s.onDeleteTransition("DELETE")),onAfterDelete:r[4]||(r[4]=d=>s.onDeleteTransition("RESOLVE")),onError:r[5]||(r[5]=d=>s.onDeleteTransition("REJECT"))},null,8,["modelValue","entity","endpoint","entity-name","disabled","loading"])])):(_(),O("div",Oe,[S(wt)]))]),_:3},8,["workspace","restricted","callback"])}le=ii(de,[["render",De],["__scopeId","data-v-57d4fedd"]])});export{le as E,Oi as __tla};
