/*
  This software is copyright Kong Inc. and its licensors.
  Use of the software is subject to the agreement between your organization
  and Kong Inc. If there is no such agreement, use is governed by and
  subject to the terms of the Kong Master Software License Agreement found
  at https://konghq.com/enterprisesoftwarelicense/.
*/

import{c as _i}from"./monaco-editor.90904fcf.3_3_0_0.js";/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var es;(function(r){(function(e){var t=typeof _i=="object"?_i:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),i=n(r);typeof t.Reflect>"u"?t.Reflect=r:i=n(t.Reflect,i),e(i);function n(o,c){return function(l,u){typeof o[l]!="function"&&Object.defineProperty(o,l,{configurable:!0,writable:!0,value:u}),c&&c(l,u)}}})(function(e){var t=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",n=i&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",o=i&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,u=!c&&!l,p={create:c?function(){return Ti(Object.create(null))}:l?function(){return Ti({__proto__:null})}:function(){return Ti({})},has:u?function(d,v){return t.call(d,v)}:function(d,v){return v in d},get:u?function(d,v){return t.call(d,v)?d[v]:void 0}:function(d,v){return d[v]}},w=Object.getPrototypeOf(Function),b=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",L=!b&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:wl(),O=!b&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:bl(),h=!b&&typeof WeakMap=="function"?WeakMap:Al(),y=new h;function m(d,v,S,I){if(G(S)){if(!Yo(d))throw new TypeError;if(!Zo(v))throw new TypeError;return al(d,v)}else{if(!Yo(d))throw new TypeError;if(!W(v))throw new TypeError;if(!W(I)&&!G(I)&&!lt(I))throw new TypeError;return lt(I)&&(I=void 0),S=Ne(S),cl(d,v,S,I)}}e("decorate",m);function g(d,v){function S(I,V){if(!W(I))throw new TypeError;if(!G(V)&&!dl(V))throw new TypeError;Go(d,v,I,V)}return S}e("metadata",g);function k(d,v,S,I){if(!W(S))throw new TypeError;return G(I)||(I=Ne(I)),Go(d,v,S,I)}e("defineMetadata",k);function x(d,v,S){if(!W(v))throw new TypeError;return G(S)||(S=Ne(S)),Fo(d,v,S)}e("hasMetadata",x);function F(d,v,S){if(!W(v))throw new TypeError;return G(S)||(S=Ne(S)),Pi(d,v,S)}e("hasOwnMetadata",F);function lr(d,v,S){if(!W(v))throw new TypeError;return G(S)||(S=Ne(S)),qo(d,v,S)}e("getMetadata",lr);function ur(d,v,S){if(!W(v))throw new TypeError;return G(S)||(S=Ne(S)),zo(d,v,S)}e("getOwnMetadata",ur);function jt(d,v){if(!W(d))throw new TypeError;return G(v)||(v=Ne(v)),Ko(d,v)}e("getMetadataKeys",jt);function ol(d,v){if(!W(d))throw new TypeError;return G(v)||(v=Ne(v)),Wo(d,v)}e("getOwnMetadataKeys",ol);function sl(d,v,S){if(!W(v))throw new TypeError;G(S)||(S=Ne(S));var I=_t(v,S,!1);if(G(I)||!I.delete(d))return!1;if(I.size>0)return!0;var V=y.get(v);return V.delete(S),V.size>0||y.delete(v),!0}e("deleteMetadata",sl);function al(d,v){for(var S=d.length-1;S>=0;--S){var I=d[S],V=I(v);if(!G(V)&&!lt(V)){if(!Zo(V))throw new TypeError;v=V}}return v}function cl(d,v,S,I){for(var V=d.length-1;V>=0;--V){var Y=d[V],_=Y(v,S,I);if(!G(_)&&!lt(_)){if(!W(_))throw new TypeError;I=_}}return I}function _t(d,v,S){var I=y.get(d);if(G(I)){if(!S)return;I=new L,y.set(d,I)}var V=I.get(v);if(G(V)){if(!S)return;V=new L,I.set(v,V)}return V}function Fo(d,v,S){var I=Pi(d,v,S);if(I)return!0;var V=Vi(v);return lt(V)?!1:Fo(d,V,S)}function Pi(d,v,S){var I=_t(v,S,!1);return G(I)?!1:hl(I.has(d))}function qo(d,v,S){var I=Pi(d,v,S);if(I)return zo(d,v,S);var V=Vi(v);if(!lt(V))return qo(d,V,S)}function zo(d,v,S){var I=_t(v,S,!1);if(!G(I))return I.get(d)}function Go(d,v,S,I){var V=_t(S,I,!0);V.set(d,v)}function Ko(d,v){var S=Wo(d,v),I=Vi(d);if(I===null)return S;var V=Ko(I,v);if(V.length<=0)return S;if(S.length<=0)return V;for(var Y=new O,_=[],R=0,T=S;R<T.length;R++){var H=T[R],M=Y.has(H);M||(Y.add(H),_.push(H))}for(var $e=0,Xo=V;$e<Xo.length;$e++){var H=Xo[$e],M=Y.has(H);M||(Y.add(H),_.push(H))}return _}function Wo(d,v){var S=[],I=_t(d,v,!1);if(G(I))return S;for(var V=I.keys(),Y=yl(V),_=0;;){var R=gl(Y);if(!R)return S.length=_,S;var T=vl(R);try{S[_]=T}catch(H){try{ml(Y)}finally{throw H}}_++}}function Jo(d){if(d===null)return 1;switch(typeof d){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return d===null?1:6;default:return 6}}function G(d){return d===void 0}function lt(d){return d===null}function ll(d){return typeof d=="symbol"}function W(d){return typeof d=="object"?d!==null:typeof d=="function"}function ul(d,v){switch(Jo(d)){case 0:return d;case 1:return d;case 2:return d;case 3:return d;case 4:return d;case 5:return d}var S=v===3?"string":v===5?"number":"default",I=Qo(d,n);if(I!==void 0){var V=I.call(d,S);if(W(V))throw new TypeError;return V}return fl(d,S==="default"?"number":S)}function fl(d,v){if(v==="string"){var S=d.toString;if(ut(S)){var I=S.call(d);if(!W(I))return I}var V=d.valueOf;if(ut(V)){var I=V.call(d);if(!W(I))return I}}else{var V=d.valueOf;if(ut(V)){var I=V.call(d);if(!W(I))return I}var Y=d.toString;if(ut(Y)){var I=Y.call(d);if(!W(I))return I}}throw new TypeError}function hl(d){return!!d}function pl(d){return""+d}function Ne(d){var v=ul(d,3);return ll(v)?v:pl(v)}function Yo(d){return Array.isArray?Array.isArray(d):d instanceof Object?d instanceof Array:Object.prototype.toString.call(d)==="[object Array]"}function ut(d){return typeof d=="function"}function Zo(d){return typeof d=="function"}function dl(d){switch(Jo(d)){case 3:return!0;case 4:return!0;default:return!1}}function Qo(d,v){var S=d[v];if(S!=null){if(!ut(S))throw new TypeError;return S}}function yl(d){var v=Qo(d,o);if(!ut(v))throw new TypeError;var S=v.call(d);if(!W(S))throw new TypeError;return S}function vl(d){return d.value}function gl(d){var v=d.next();return v.done?!1:v}function ml(d){var v=d.return;v&&v.call(d)}function Vi(d){var v=Object.getPrototypeOf(d);if(typeof d!="function"||d===w||v!==w)return v;var S=d.prototype,I=S&&Object.getPrototypeOf(S);if(I==null||I===Object.prototype)return v;var V=I.constructor;return typeof V!="function"||V===d?v:V}function wl(){var d={},v=[],S=function(){function _(R,T,H){this._index=0,this._keys=R,this._values=T,this._selector=H}return _.prototype["@@iterator"]=function(){return this},_.prototype[o]=function(){return this},_.prototype.next=function(){var R=this._index;if(R>=0&&R<this._keys.length){var T=this._selector(this._keys[R],this._values[R]);return R+1>=this._keys.length?(this._index=-1,this._keys=v,this._values=v):this._index++,{value:T,done:!1}}return{value:void 0,done:!0}},_.prototype.throw=function(R){throw this._index>=0&&(this._index=-1,this._keys=v,this._values=v),R},_.prototype.return=function(R){return this._index>=0&&(this._index=-1,this._keys=v,this._values=v),{value:R,done:!0}},_}();return function(){function _(){this._keys=[],this._values=[],this._cacheKey=d,this._cacheIndex=-2}return Object.defineProperty(_.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),_.prototype.has=function(R){return this._find(R,!1)>=0},_.prototype.get=function(R){var T=this._find(R,!1);return T>=0?this._values[T]:void 0},_.prototype.set=function(R,T){var H=this._find(R,!0);return this._values[H]=T,this},_.prototype.delete=function(R){var T=this._find(R,!1);if(T>=0){for(var H=this._keys.length,M=T+1;M<H;M++)this._keys[M-1]=this._keys[M],this._values[M-1]=this._values[M];return this._keys.length--,this._values.length--,R===this._cacheKey&&(this._cacheKey=d,this._cacheIndex=-2),!0}return!1},_.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=d,this._cacheIndex=-2},_.prototype.keys=function(){return new S(this._keys,this._values,I)},_.prototype.values=function(){return new S(this._keys,this._values,V)},_.prototype.entries=function(){return new S(this._keys,this._values,Y)},_.prototype["@@iterator"]=function(){return this.entries()},_.prototype[o]=function(){return this.entries()},_.prototype._find=function(R,T){return this._cacheKey!==R&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=R)),this._cacheIndex<0&&T&&(this._cacheIndex=this._keys.length,this._keys.push(R),this._values.push(void 0)),this._cacheIndex},_}();function I(_,R){return _}function V(_,R){return R}function Y(_,R){return[_,R]}}function bl(){return function(){function d(){this._map=new L}return Object.defineProperty(d.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),d.prototype.has=function(v){return this._map.has(v)},d.prototype.add=function(v){return this._map.set(v,v),this},d.prototype.delete=function(v){return this._map.delete(v)},d.prototype.clear=function(){this._map.clear()},d.prototype.keys=function(){return this._map.keys()},d.prototype.values=function(){return this._map.values()},d.prototype.entries=function(){return this._map.entries()},d.prototype["@@iterator"]=function(){return this.keys()},d.prototype[o]=function(){return this.keys()},d}()}function Al(){var d=16,v=p.create(),S=I();return function(){function T(){this._key=I()}return T.prototype.has=function(H){var M=V(H,!1);return M!==void 0?p.has(M,this._key):!1},T.prototype.get=function(H){var M=V(H,!1);return M!==void 0?p.get(M,this._key):void 0},T.prototype.set=function(H,M){var $e=V(H,!0);return $e[this._key]=M,this},T.prototype.delete=function(H){var M=V(H,!1);return M!==void 0?delete M[this._key]:!1},T.prototype.clear=function(){this._key=I()},T}();function I(){var T;do T="@@WeakMap@@"+R();while(p.has(v,T));return v[T]=!0,T}function V(T,H){if(!t.call(T,S)){if(!H)return;Object.defineProperty(T,S,{value:p.create()})}return T[S]}function Y(T,H){for(var M=0;M<H;++M)T[M]=Math.random()*255|0;return T}function _(T){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(T)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(T)):Y(new Uint8Array(T),T):Y(new Array(T),T)}function R(){var T=_(d);T[6]=T[6]&79|64,T[8]=T[8]&191|128;for(var H="",M=0;M<d;++M){var $e=T[M];(M===4||M===6||M===8)&&(H+="-"),$e<16&&(H+="0"),H+=$e.toString(16).toLowerCase()}return H}}function Ti(d){return d.__=void 0,delete d.__,d}})})(es||(es={}));/*!
 * MIT License
 * 
 * Copyright (c) 2017-2022 Peculiar Ventures, LLC
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const Sl="[object ArrayBuffer]";class E{static isArrayBuffer(e){return Object.prototype.toString.call(e)===Sl}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e).slice().buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const i=E.toUint8Array(e),n=E.toUint8Array(t);if(i.length!==n.byteLength)return!1;for(let o=0;o<i.length;o++)if(i[o]!==n[o])return!1;return!0}static concat(...e){if(Array.isArray(e[0])){const t=e[0];let i=0;for(const c of t)i+=c.byteLength;const n=new Uint8Array(i);let o=0;for(const c of t){const l=this.toUint8Array(c);n.set(l,o),o+=l.length}return e[1]?this.toView(n,e[1]):n.buffer}else return this.concat(e)}}class ts{static fromString(e){const t=unescape(encodeURIComponent(e)),i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return i.buffer}static toString(e){const t=E.toUint8Array(e);let i="";for(let o=0;o<t.length;o++)i+=String.fromCharCode(t[o]);return decodeURIComponent(escape(i))}}class Se{static toString(e,t=!1){const i=E.toArrayBuffer(e),n=new DataView(i);let o="";for(let c=0;c<i.byteLength;c+=2){const l=n.getUint16(c,t);o+=String.fromCharCode(l)}return o}static fromString(e,t=!1){const i=new ArrayBuffer(e.length*2),n=new DataView(i);for(let o=0;o<e.length;o++)n.setUint16(o*2,e.charCodeAt(o),t);return i}}class N{static isHex(e){return typeof e=="string"&&/^[a-z0-9]+$/i.test(e)}static isBase64(e){return typeof e=="string"&&/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}static isBase64Url(e){return typeof e=="string"&&/^[a-zA-Z0-9-_]+$/i.test(e)}static ToString(e,t="utf8"){const i=E.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(i);case"binary":return this.ToBinary(i);case"hex":return this.ToHex(i);case"base64":return this.ToBase64(i);case"base64url":return this.ToBase64Url(i);case"utf16le":return Se.toString(i,!0);case"utf16":case"utf16be":return Se.toString(i);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return Se.fromString(e,!0);case"utf16":case"utf16be":return Se.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=E.toUint8Array(e);if(typeof btoa<"u"){const i=this.ToString(t,"binary");return btoa(i)}else return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!N.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!N.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=N.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return ts.fromString(e);case"utf16":case"utf16be":return Se.fromString(e);case"utf16le":case"usc2":return Se.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=N.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return ts.toString(e);case"utf16":case"utf16be":return Se.toString(e);case"utf16le":case"usc2":return Se.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,i=new Uint8Array(t);for(let n=0;n<t;n++)i[n]=e.charCodeAt(n);return i.buffer}static ToBinary(e){const t=E.toUint8Array(e);let i="";for(let n=0;n<t.length;n++)i+=String.fromCharCode(t[n]);return i}static ToHex(e){const t=E.toUint8Array(e),i="",n=[],o=t.length;for(let c=0;c<o;c++){const l=t[c].toString(16).padStart(2,"0");n.push(l)}return n.join(i)}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!N.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const i=new Uint8Array(t.length/2);for(let n=0;n<t.length;n=n+2){const o=t.slice(n,n+2);i[n/2]=parseInt(o,16)}return i.buffer}static ToUtf16String(e,t=!1){return Se.toString(e,t)}static FromUtf16String(e,t=!1){return Se.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let i=0;i<t;i++)e+="=";return e}static formatString(e){return e?.replace(/[\n\r\t ]/g,"")||""}}N.DEFAULT_UTF8_ENCODING="utf8";function Bl(...r){const e=r.map(n=>n.byteLength).reduce((n,o)=>n+o),t=new Uint8Array(e);let i=0;return r.map(n=>new Uint8Array(n)).forEach(n=>{for(const o of n)t[i++]=o}),t.buffer}function Sa(r,e){if(!(r&&e)||r.byteLength!==e.byteLength)return!1;const t=new Uint8Array(r),i=new Uint8Array(e);for(let n=0;n<r.byteLength;n++)if(t[n]!==i[n])return!1;return!0}/*!
 Copyright (c) Peculiar Ventures, LLC
*/function yt(r,e){let t=0;if(r.length===1)return r[0];for(let i=r.length-1;i>=0;i--)t+=r[r.length-1-i]*Math.pow(2,e*i);return t}function Ze(r,e,t=-1){const i=t;let n=r,o=0,c=Math.pow(2,e);for(let l=1;l<8;l++){if(r<c){let u;if(i<0)u=new ArrayBuffer(l),o=l;else{if(i<l)return new ArrayBuffer(0);u=new ArrayBuffer(i),o=i}const p=new Uint8Array(u);for(let w=l-1;w>=0;w--){const b=Math.pow(2,w*e);p[o-w-1]=Math.floor(n/b),n-=p[o-w-1]*b}return u}c*=Math.pow(2,e)}return new ArrayBuffer(0)}function Ri(...r){let e=0,t=0;for(const o of r)e+=o.length;const i=new ArrayBuffer(e),n=new Uint8Array(i);for(const o of r)n.set(o,t),t+=o.length;return n}function Ba(){const r=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const l=r[0]===255&&r[1]&128,u=r[0]===0&&(r[1]&128)===0;(l||u)&&this.warnings.push("Needlessly long format")}const e=new ArrayBuffer(this.valueHex.byteLength),t=new Uint8Array(e);for(let l=0;l<this.valueHex.byteLength;l++)t[l]=0;t[0]=r[0]&128;const i=yt(t,8),n=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(n);for(let l=0;l<this.valueHex.byteLength;l++)o[l]=r[l];return o[0]&=127,yt(o,8)-i}function xl(r){const e=r<0?r*-1:r;let t=128;for(let i=1;i<8;i++){if(e<=t){if(r<0){const c=t-e,l=Ze(c,8,i),u=new Uint8Array(l);return u[0]|=128,l}let n=Ze(e,8,i),o=new Uint8Array(n);if(o[0]&128){const c=n.slice(0),l=new Uint8Array(c);n=new ArrayBuffer(n.byteLength+1),o=new Uint8Array(n);for(let u=0;u<c.byteLength;u++)o[u+1]=l[u];o[0]=0}return n}t*=Math.pow(2,8)}return new ArrayBuffer(0)}function kl(r,e){if(r.byteLength!==e.byteLength)return!1;const t=new Uint8Array(r),i=new Uint8Array(e);for(let n=0;n<t.length;n++)if(t[n]!==i[n])return!1;return!0}function se(r,e){const t=r.toString(10);if(e<t.length)return"";const i=e-t.length,n=new Array(i);for(let c=0;c<i;c++)n[c]="0";return n.join("").concat(t)}/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function yr(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function ro(r){let e=0,t=0;for(let n=0;n<r.length;n++){const o=r[n];e+=o.byteLength}const i=new Uint8Array(e);for(let n=0;n<r.length;n++){const o=r[n];i.set(new Uint8Array(o),t),t+=o.byteLength}return i.buffer}function Ue(r,e,t,i){return e instanceof Uint8Array?e.byteLength?t<0?(r.error="Wrong parameter: inputOffset less than zero",!1):i<0?(r.error="Wrong parameter: inputLength less than zero",!1):e.byteLength-t-i<0?(r.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(r.error="Wrong parameter: inputBuffer has zero length",!1):(r.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class qr{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return ro(this.items)}}const Rt=[new Uint8Array([1])],rs="0123456789",ji="name",is="valueHexView",Il="isHexOnly",Cl="idBlock",El="tagClass",Nl="tagNumber",Ol="isConstructed",Pl="fromBER",Vl="toBER",Tl="local",ie="",be=new ArrayBuffer(0),zr=new Uint8Array(0),$t="EndOfContent",xa="OCTET STRING",ka="BIT STRING";function Ie(r){var e;return e=class extends r{constructor(...i){var n;super(...i);const o=i[0]||{};this.isHexOnly=(n=o.isHexOnly)!==null&&n!==void 0?n:!1,this.valueHexView=o.valueHex?E.toUint8Array(o.valueHex):zr}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(i){this.valueHexView=new Uint8Array(i)}fromBER(i,n,o){const c=i instanceof ArrayBuffer?new Uint8Array(i):i;if(!Ue(this,c,n,o))return-1;const l=n+o;return this.valueHexView=c.subarray(n,l),this.valueHexView.length?(this.blockLength=o,l):(this.warnings.push("Zero buffer length"),n)}toBER(i=!1){return this.isHexOnly?i?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",be)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:N.ToHex(this.valueHexView)}}},e.NAME="hexBlock",e}class ot{constructor({blockLength:e=0,error:t=ie,warnings:i=[],valueBeforeDecode:n=zr}={}){this.blockLength=e,this.error=t,this.warnings=i,this.valueBeforeDecodeView=E.toUint8Array(n)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:N.ToHex(this.valueBeforeDecodeView)}}}ot.NAME="baseBlock";class te extends ot{fromBER(e,t,i){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}te.NAME="valueBlock";class Ia extends Ie(ot){constructor({idBlock:e={}}={}){var t,i,n,o;super(),e?(this.isHexOnly=(t=e.isHexOnly)!==null&&t!==void 0?t:!1,this.valueHexView=e.valueHex?E.toUint8Array(e.valueHex):zr,this.tagClass=(i=e.tagClass)!==null&&i!==void 0?i:-1,this.tagNumber=(n=e.tagNumber)!==null&&n!==void 0?n:-1,this.isConstructed=(o=e.isConstructed)!==null&&o!==void 0?o:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",be}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const n=new Uint8Array(1);if(!e){let o=this.tagNumber;o&=31,t|=o,n[0]=t}return n.buffer}if(!this.isHexOnly){const n=Ze(this.tagNumber,7),o=new Uint8Array(n),c=n.byteLength,l=new Uint8Array(c+1);if(l[0]=t|31,!e){for(let u=0;u<c-1;u++)l[u+1]=o[u]|128;l[c]=o[c-1]}return l.buffer}const i=new Uint8Array(this.valueHexView.byteLength+1);if(i[0]=t|31,!e){const n=this.valueHexView;for(let o=0;o<n.length-1;o++)i[o+1]=n[o]|128;i[this.valueHexView.byteLength]=n[n.length-1]}return i.buffer}fromBER(e,t,i){const n=E.toUint8Array(e);if(!Ue(this,n,t,i))return-1;const o=n.subarray(t,t+i);if(o.length===0)return this.error="Zero buffer length",-1;switch(o[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(o[0]&32)===32,this.isHexOnly=!1;const l=o[0]&31;if(l!==31)this.tagNumber=l,this.blockLength=1;else{let u=1,p=this.valueHexView=new Uint8Array(255),w=255;for(;o[u]&128;){if(p[u-1]=o[u]&127,u++,u>=o.length)return this.error="End of input reached before message was fully decoded",-1;if(u===w){w+=255;const L=new Uint8Array(w);for(let O=0;O<p.length;O++)L[O]=p[O];p=this.valueHexView=new Uint8Array(w)}}this.blockLength=u+1,p[u-1]=o[u]&127;const b=new Uint8Array(u);for(let L=0;L<u;L++)b[L]=p[L];p=this.valueHexView=new Uint8Array(u),p.set(b),this.blockLength<=9?this.tagNumber=yt(p,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}Ia.NAME="identificationBlock";class Ca extends ot{constructor({lenBlock:e={}}={}){var t,i,n;super(),this.isIndefiniteForm=(t=e.isIndefiniteForm)!==null&&t!==void 0?t:!1,this.longFormUsed=(i=e.longFormUsed)!==null&&i!==void 0?i:!1,this.length=(n=e.length)!==null&&n!==void 0?n:0}fromBER(e,t,i){const n=E.toUint8Array(e);if(!Ue(this,n,t,i))return-1;const o=n.subarray(t,t+i);if(o.length===0)return this.error="Zero buffer length",-1;if(o[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=o[0]===128,this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(o[0]&128),this.longFormUsed===!1)return this.length=o[0],this.blockLength=1,t+this.blockLength;const c=o[0]&127;if(c>8)return this.error="Too big integer",-1;if(c+1>o.length)return this.error="End of input reached before message was fully decoded",-1;const l=t+1,u=n.subarray(l,l+c);return u[c-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=yt(u,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=c+1,t+this.blockLength}toBER(e=!1){let t,i;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),e===!1&&(i=new Uint8Array(t),i[0]=128),t;if(this.longFormUsed){const n=Ze(this.length,8);if(n.byteLength>127)return this.error="Too big length",be;if(t=new ArrayBuffer(n.byteLength+1),e)return t;const o=new Uint8Array(n);i=new Uint8Array(t),i[0]=n.byteLength|128;for(let c=0;c<n.byteLength;c++)i[c+1]=o[c];return t}return t=new ArrayBuffer(1),e===!1&&(i=new Uint8Array(t),i[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}Ca.NAME="lengthBlock";const C={};class Z extends ot{constructor({name:e=ie,optional:t=!1,primitiveSchema:i,...n}={},o){super(n),this.name=e,this.optional=t,i&&(this.primitiveSchema=i),this.idBlock=new Ia(n),this.lenBlock=new Ca(n),this.valueBlock=o?new o(n):new te(n)}fromBER(e,t,i){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e,t){const i=t||new qr;t||Ea(this);const n=this.idBlock.toBER(e);if(i.write(n),this.lenBlock.isIndefiniteForm)i.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,i),i.write(new ArrayBuffer(2));else{const o=this.valueBlock.toBER(e);this.lenBlock.length=o.byteLength;const c=this.lenBlock.toBER(e);i.write(c),i.write(o)}return t?be:i.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return e==="ascii"?this.onAsciiEncoding():N.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${N.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;const t=this.toBER(),i=e.toBER();return kl(t,i)}}Z.NAME="BaseBlock";function Ea(r){if(r instanceof C.Constructed)for(const e of r.valueBlock.value)Ea(e)&&(r.lenBlock.isIndefiniteForm=!0);return!!r.lenBlock.isIndefiniteForm}class io extends Z{constructor({value:e=ie,...t}={},i){super(t,i),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,i){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}io.NAME="BaseStringBlock";class Na extends Ie(te){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}Na.NAME="PrimitiveValueBlock";var Oa;class Kt extends Z{constructor(e={}){super(e,Na),this.idBlock.isConstructed=!1}}Oa=Kt;C.Primitive=Oa;Kt.NAME="PRIMITIVE";function jl(r,e){if(r instanceof e)return r;const t=new e;return t.idBlock=r.idBlock,t.lenBlock=r.lenBlock,t.warnings=r.warnings,t.valueBeforeDecodeView=r.valueBeforeDecodeView,t}function It(r,e=0,t=r.length){const i=e;let n=new Z({},te);const o=new ot;if(!Ue(o,r,e,t))return n.error=o.error,{offset:-1,result:n};if(!r.subarray(e,e+t).length)return n.error="Zero buffer length",{offset:-1,result:n};let l=n.idBlock.fromBER(r,e,t);if(n.idBlock.warnings.length&&n.warnings.concat(n.idBlock.warnings),l===-1)return n.error=n.idBlock.error,{offset:-1,result:n};if(e=l,t-=n.idBlock.blockLength,l=n.lenBlock.fromBER(r,e,t),n.lenBlock.warnings.length&&n.warnings.concat(n.lenBlock.warnings),l===-1)return n.error=n.lenBlock.error,{offset:-1,result:n};if(e=l,t-=n.lenBlock.blockLength,!n.idBlock.isConstructed&&n.lenBlock.isIndefiniteForm)return n.error="Indefinite length form used for primitive encoding form",{offset:-1,result:n};let u=Z;switch(n.idBlock.tagClass){case 1:if(n.idBlock.tagNumber>=37&&n.idBlock.isHexOnly===!1)return n.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:n};switch(n.idBlock.tagNumber){case 0:if(n.idBlock.isConstructed&&n.lenBlock.length>0)return n.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:n};u=C.EndOfContent;break;case 1:u=C.Boolean;break;case 2:u=C.Integer;break;case 3:u=C.BitString;break;case 4:u=C.OctetString;break;case 5:u=C.Null;break;case 6:u=C.ObjectIdentifier;break;case 10:u=C.Enumerated;break;case 12:u=C.Utf8String;break;case 13:u=C.RelativeObjectIdentifier;break;case 14:u=C.TIME;break;case 15:return n.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:n};case 16:u=C.Sequence;break;case 17:u=C.Set;break;case 18:u=C.NumericString;break;case 19:u=C.PrintableString;break;case 20:u=C.TeletexString;break;case 21:u=C.VideotexString;break;case 22:u=C.IA5String;break;case 23:u=C.UTCTime;break;case 24:u=C.GeneralizedTime;break;case 25:u=C.GraphicString;break;case 26:u=C.VisibleString;break;case 27:u=C.GeneralString;break;case 28:u=C.UniversalString;break;case 29:u=C.CharacterString;break;case 30:u=C.BmpString;break;case 31:u=C.DATE;break;case 32:u=C.TimeOfDay;break;case 33:u=C.DateTime;break;case 34:u=C.Duration;break;default:{const p=n.idBlock.isConstructed?new C.Constructed:new C.Primitive;p.idBlock=n.idBlock,p.lenBlock=n.lenBlock,p.warnings=n.warnings,n=p}}break;case 2:case 3:case 4:default:u=n.idBlock.isConstructed?C.Constructed:C.Primitive}return n=jl(n,u),l=n.fromBER(r,e,n.lenBlock.isIndefiniteForm?t:n.lenBlock.length),n.valueBeforeDecodeView=r.subarray(i,i+n.blockLength),{offset:l,result:n}}function ht(r){if(!r.byteLength){const e=new Z({},te);return e.error="Input buffer has zero length",{offset:-1,result:e}}return It(E.toUint8Array(r).slice(),0,r.byteLength)}function _l(r,e){return r?1:e}class Le extends te{constructor({value:e=[],isIndefiniteForm:t=!1,...i}={}){super(i),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,i){const n=E.toUint8Array(e);if(!Ue(this,n,t,i))return-1;if(this.valueBeforeDecodeView=n.subarray(t,t+i),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),t;let o=t;for(;_l(this.isIndefiniteForm,i)>0;){const c=It(n,o,i);if(c.offset===-1)return this.error=c.result.error,this.warnings.concat(c.result.warnings),-1;if(o=c.offset,this.blockLength+=c.result.blockLength,i-=c.result.blockLength,this.value.push(c.result),this.isIndefiniteForm&&c.result.constructor.NAME===$t)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===$t?this.value.pop():this.warnings.push("No EndOfContent block encoded")),o}toBER(e,t){const i=t||new qr;for(let n=0;n<this.value.length;n++)this.value[n].toBER(e,i);return t?be:i.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}Le.NAME="ConstructedValueBlock";var Pa;class ne extends Z{constructor(e={}){super(e,Le),this.idBlock.isConstructed=!0}fromBER(e,t,i){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?i:this.lenBlock.length);return n===-1?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){const e=[];for(const i of this.valueBlock.value)e.push(i.toString("ascii").split(`
`).map(n=>`  ${n}`).join(`
`));const t=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join(`
`)}`:`${t} :`}}Pa=ne;C.Constructed=Pa;ne.NAME="CONSTRUCTED";class Va extends te{fromBER(e,t,i){return t}toBER(e){return be}}Va.override="EndOfContentValueBlock";var Ta;class no extends Z{constructor(e={}){super(e,Va),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}Ta=no;C.EndOfContent=Ta;no.NAME=$t;var ja;class Qe extends Z{constructor(e={}){super(e,te),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,i){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=i,t+i>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+i}toBER(e,t){const i=new ArrayBuffer(2);if(!e){const n=new Uint8Array(i);n[0]=5,n[1]=0}return t&&t.write(i),i}onAsciiEncoding(){return`${this.constructor.NAME}`}}ja=Qe;C.Null=ja;Qe.NAME="NULL";class _a extends Ie(te){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=E.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,i){const n=E.toUint8Array(e);return Ue(this,n,t,i)?(this.valueHexView=n.subarray(t,t+i),i>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Ba.call(this),this.blockLength=i,t+i):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}_a.NAME="BooleanValueBlock";var Ra;class Gr extends Z{constructor(e={}){super(e,_a),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}Ra=Gr;C.Boolean=Ra;Gr.NAME="BOOLEAN";class Ua extends Ie(Le){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,i){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,n=Le.prototype.fromBER.call(this,e,t,i),n===-1)return n;for(let o=0;o<this.value.length;o++){const c=this.value[o].constructor.NAME;if(c===$t){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(c!==xa)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,i),this.blockLength=i;return n}toBER(e,t){return this.isConstructed?Le.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}Ua.NAME="OctetStringValueBlock";var Da;class Pe extends Z{constructor({idBlock:e={},lenBlock:t={},...i}={}){var n,o;(n=i.isConstructed)!==null&&n!==void 0||(i.isConstructed=!!(!((o=i.value)===null||o===void 0)&&o.length)),super({idBlock:{isConstructed:i.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!i.isIndefiniteForm},...i},Ua),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,i){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,i===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const o=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+i);try{if(o.byteLength){const c=It(o,0,o.byteLength);c.offset!==-1&&c.offset===i&&(this.valueBlock.value=[c.result])}}catch{}}return super.fromBER(e,t,i)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?ne.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${N.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof Pe&&e.push(t.valueBlock.valueHexView);return E.concat(e)}}Da=Pe;C.OctetString=Da;Pe.NAME=xa;class Ha extends Ie(Le){constructor({unusedBits:e=0,isConstructed:t=!1,...i}={}){super(i),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,i){if(!i)return t;let n=-1;if(this.isConstructed){if(n=Le.prototype.fromBER.call(this,e,t,i),n===-1)return n;for(const l of this.value){const u=l.constructor.NAME;if(u===$t){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(u!==ka)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const p=l.valueBlock;if(this.unusedBits>0&&p.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=p.unusedBits}return n}const o=E.toUint8Array(e);if(!Ue(this,o,t,i))return-1;const c=o.subarray(t,t+i);if(this.unusedBits=c[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const l=c.subarray(1);try{if(l.byteLength){const u=It(l,0,l.byteLength);u.offset!==-1&&u.offset===i-1&&(this.value=[u.result])}}catch{}}return this.valueHexView=c.subarray(1),this.blockLength=c.length,t+i}toBER(e,t){if(this.isConstructed)return Le.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return be;const i=new Uint8Array(this.valueHexView.length+1);return i[0]=this.unusedBits,i.set(this.valueHexView,1),i.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}Ha.NAME="BitStringValueBlock";var Ma;class Je extends Z{constructor({idBlock:e={},lenBlock:t={},...i}={}){var n,o;(n=i.isConstructed)!==null&&n!==void 0||(i.isConstructed=!!(!((o=i.value)===null||o===void 0)&&o.length)),super({idBlock:{isConstructed:i.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!i.isIndefiniteForm},...i},Ha),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,i){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,i)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return ne.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const n of t)e.push(n.toString(2).padStart(8,"0"));const i=e.join("");return`${this.constructor.NAME} : ${i.substring(0,i.length-this.valueBlock.unusedBits)}`}}}Ma=Je;C.BitString=Ma;Je.NAME=ka;var $a;function Rl(r,e){const t=new Uint8Array([0]),i=new Uint8Array(r),n=new Uint8Array(e);let o=i.slice(0);const c=o.length-1,l=n.slice(0),u=l.length-1;let p=0;const w=u<c?c:u;let b=0;for(let L=w;L>=0;L--,b++){switch(!0){case b<l.length:p=o[c-b]+l[u-b]+t[0];break;default:p=o[c-b]+t[0]}switch(t[0]=p/10,!0){case b>=o.length:o=Ri(new Uint8Array([p%10]),o);break;default:o[c-b]=p%10}}return t[0]>0&&(o=Ri(t,o)),o}function ns(r){if(r>=Rt.length)for(let e=Rt.length;e<=r;e++){const t=new Uint8Array([0]);let i=Rt[e-1].slice(0);for(let n=i.length-1;n>=0;n--){const o=new Uint8Array([(i[n]<<1)+t[0]]);t[0]=o[0]/10,i[n]=o[0]%10}t[0]>0&&(i=Ri(t,i)),Rt.push(i)}return Rt[r]}function Ul(r,e){let t=0;const i=new Uint8Array(r),n=new Uint8Array(e),o=i.slice(0),c=o.length-1,l=n.slice(0),u=l.length-1;let p,w=0;for(let b=u;b>=0;b--,w++)switch(p=o[c-w]-l[u-w]-t,!0){case p<0:t=1,o[c-w]=p+10;break;default:t=0,o[c-w]=p}if(t>0)for(let b=c-u+1;b>=0;b--,w++)if(p=o[c-w]-t,p<0)t=1,o[c-w]=p+10;else{t=0,o[c-w]=p;break}return o.slice()}class oo extends Ie(te){constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),e!==void 0&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Ba.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(xl(e))}get valueDec(){return this._valueDec}fromDER(e,t,i,n=0){const o=this.fromBER(e,t,i);if(o===-1)return o;const c=this.valueHexView;return c[0]===0&&(c[1]&128)!==0?this.valueHexView=c.subarray(1):n!==0&&c.length<n&&(n-c.length>1&&(n=c.length+1),this.valueHexView=c.subarray(n-c.length)),o}toDER(e=!1){const t=this.valueHexView;switch(!0){case(t[0]&128)!==0:{const i=new Uint8Array(this.valueHexView.length+1);i[0]=0,i.set(t,1),this.valueHexView=i}break;case(t[0]===0&&(t[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(e)}fromBER(e,t,i){const n=super.fromBER(e,t,i);return n===-1||this.setValueHex(),n}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=this.valueHexView.length*8-1;let t=new Uint8Array(this.valueHexView.length*8/3),i=0,n;const o=this.valueHexView;let c="",l=!1;for(let u=o.byteLength-1;u>=0;u--){n=o[u];for(let p=0;p<8;p++){if((n&1)===1)switch(i){case e:t=Ul(ns(i),t),c="-";break;default:t=Rl(t,ns(i))}i++,n>>=1}}for(let u=0;u<t.length;u++)t[u]&&(l=!0),l&&(c+=rs.charAt(t[u]));return l===!1&&(c+=rs.charAt(0)),c}}$a=oo;oo.NAME="IntegerValueBlock";Object.defineProperty($a.prototype,"valueHex",{set:function(r){this.valueHexView=new Uint8Array(r),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var La;class Be extends Z{constructor(e={}){super(e,oo),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return yr(),BigInt(this.valueBlock.toString())}static fromBigInt(e){yr();const t=BigInt(e),i=new qr,n=t.toString(16).replace(/^-/,""),o=new Uint8Array(N.FromHex(n));if(t<0){const l=new Uint8Array(o.length+(o[0]&128?1:0));l[0]|=128;const p=BigInt(`0x${N.ToHex(l)}`)+t,w=E.toUint8Array(N.FromHex(p.toString(16)));w[0]|=128,i.write(w)}else o[0]&128&&i.write(new Uint8Array([0])),i.write(o);return new Be({valueHex:i.final()})}convertToDER(){const e=new Be({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new Be({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}La=Be;C.Integer=La;Be.NAME="INTEGER";var Fa;class Kr extends Be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}Fa=Kr;C.Enumerated=Fa;Kr.NAME="ENUMERATED";class Ui extends Ie(te){constructor({valueDec:e=-1,isFirstSid:t=!1,...i}={}){super(i),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,i){if(!i)return t;const n=E.toUint8Array(e);if(!Ue(this,n,t,i))return-1;const o=n.subarray(t,t+i);this.valueHexView=new Uint8Array(i);for(let l=0;l<i&&(this.valueHexView[l]=o[l]&127,this.blockLength++,(o[l]&128)!==0);l++);const c=new Uint8Array(this.blockLength);for(let l=0;l<this.blockLength;l++)c[l]=this.valueHexView[l];return this.valueHexView=c,(o[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=yt(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){yr();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const i=new Uint8Array(t.length/7);for(let n=0;n<i.length;n++)i[n]=parseInt(t.slice(n*7,n*7+7),2)+(n+1<i.length?128:0);this.fromBER(i.buffer,0,i.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const n=this.valueHexView,o=new Uint8Array(this.blockLength);for(let c=0;c<this.blockLength-1;c++)o[c]=n[c]|128;return o[this.blockLength-1]=n[this.blockLength-1],o.buffer}const t=Ze(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",be;const i=new Uint8Array(t.byteLength);if(!e){const n=new Uint8Array(t),o=t.byteLength-1;for(let c=0;c<o;c++)i[c]=n[c]|128;i[o]=n[o]}return i}toString(){let e="";if(this.isHexOnly)e=N.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}Ui.NAME="sidBlock";class qa extends te{constructor({value:e=ie,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,i){let n=t;for(;i>0;){const o=new Ui;if(n=o.fromBER(e,n,i),n===-1)return this.blockLength=0,this.error=o.error,n;this.value.length===0&&(o.isFirstSid=!0),this.blockLength+=o.blockLength,i-=o.blockLength,this.value.push(o)}return n}toBER(e){const t=[];for(let i=0;i<this.value.length;i++){const n=this.value[i].toBER(e);if(n.byteLength===0)return this.error=this.value[i].error,be;t.push(n)}return ro(t)}fromString(e){this.value=[];let t=0,i=0,n="",o=!1;do if(i=e.indexOf(".",t),i===-1?n=e.substring(t):n=e.substring(t,i),t=i+1,o){const c=this.value[0];let l=0;switch(c.valueDec){case 0:break;case 1:l=40;break;case 2:l=80;break;default:this.value=[];return}const u=parseInt(n,10);if(isNaN(u))return;c.valueDec=u+l,o=!1}else{const c=new Ui;if(n>Number.MAX_SAFE_INTEGER){yr();const l=BigInt(n);c.valueBigInt=l}else if(c.valueDec=parseInt(n,10),isNaN(c.valueDec))return;this.value.length||(c.isFirstSid=!0,o=!0),this.value.push(c)}while(i!==-1)}toString(){let e="",t=!1;for(let i=0;i<this.value.length;i++){t=this.value[i].isHexOnly;let n=this.value[i].toString();i!==0&&(e=`${e}.`),t?(n=`{${n}}`,this.value[i].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}qa.NAME="ObjectIdentifierValueBlock";var za;class Wr extends Z{constructor(e={}){super(e,qa),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}za=Wr;C.ObjectIdentifier=za;Wr.NAME="OBJECT IDENTIFIER";class Di extends Ie(ot){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,i){if(i===0)return t;const n=E.toUint8Array(e);if(!Ue(this,n,t,i))return-1;const o=n.subarray(t,t+i);this.valueHexView=new Uint8Array(i);for(let l=0;l<i&&(this.valueHexView[l]=o[l]&127,this.blockLength++,(o[l]&128)!==0);l++);const c=new Uint8Array(this.blockLength);for(let l=0;l<this.blockLength;l++)c[l]=this.valueHexView[l];return this.valueHexView=c,(o[this.blockLength-1]&128)!==0?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=yt(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const n=this.valueHexView,o=new Uint8Array(this.blockLength);for(let c=0;c<this.blockLength-1;c++)o[c]=n[c]|128;return o[this.blockLength-1]=n[this.blockLength-1],o.buffer}const t=Ze(this.valueDec,7);if(t.byteLength===0)return this.error="Error during encoding SID value",be;const i=new Uint8Array(t.byteLength);if(!e){const n=new Uint8Array(t),o=t.byteLength-1;for(let c=0;c<o;c++)i[c]=n[c]|128;i[o]=n[o]}return i.buffer}toString(){let e="";return this.isHexOnly?e=N.ToHex(this.valueHexView):e=this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}Di.NAME="relativeSidBlock";class Ga extends te{constructor({value:e=ie,...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,i){let n=t;for(;i>0;){const o=new Di;if(n=o.fromBER(e,n,i),n===-1)return this.blockLength=0,this.error=o.error,n;this.blockLength+=o.blockLength,i-=o.blockLength,this.value.push(o)}return n}toBER(e,t){const i=[];for(let n=0;n<this.value.length;n++){const o=this.value[n].toBER(e);if(o.byteLength===0)return this.error=this.value[n].error,be;i.push(o)}return ro(i)}fromString(e){this.value=[];let t=0,i=0,n="";do{i=e.indexOf(".",t),i===-1?n=e.substring(t):n=e.substring(t,i),t=i+1;const o=new Di;if(o.valueDec=parseInt(n,10),isNaN(o.valueDec))return!0;this.value.push(o)}while(i!==-1);return!0}toString(){let e="",t=!1;for(let i=0;i<this.value.length;i++){t=this.value[i].isHexOnly;let n=this.value[i].toString();i!==0&&(e=`${e}.`),t&&(n=`{${n}}`),e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Ga.NAME="RelativeObjectIdentifierValueBlock";var Ka;class so extends Z{constructor(e={}){super(e,Ga),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Ka=so;C.RelativeObjectIdentifier=Ka;so.NAME="RelativeObjectIdentifier";var Wa;class Ve extends ne{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}Wa=Ve;C.Sequence=Wa;Ve.NAME="SEQUENCE";var Ja;class Te extends ne{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}Ja=Te;C.Set=Ja;Te.NAME="SET";class Ya extends Ie(te){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=ie}toJSON(){return{...super.toJSON(),value:this.value}}}Ya.NAME="StringValueBlock";class Za extends Ya{}Za.NAME="SimpleStringValueBlock";class ae extends io{constructor({...e}={}){super(e,Za)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,E.toUint8Array(e))}fromString(e){const t=e.length,i=this.valueBlock.valueHexView=new Uint8Array(t);for(let n=0;n<t;n++)i[n]=e.charCodeAt(n);this.valueBlock.value=e}}ae.NAME="SIMPLE STRING";class Qa extends ae{fromBuffer(e){this.valueBlock.valueHexView=E.toUint8Array(e);try{this.valueBlock.value=N.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=N.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(N.FromUtf8String(e)),this.valueBlock.value=e}}Qa.NAME="Utf8StringValueBlock";var Xa;class De extends Qa{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Xa=De;C.Utf8String=Xa;De.NAME="UTF8String";class ec extends ae{fromBuffer(e){this.valueBlock.value=N.ToUtf16String(e),this.valueBlock.valueHexView=E.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(N.FromUtf16String(e))}}ec.NAME="BmpStringValueBlock";var tc;class Jr extends ec{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}tc=Jr;C.BmpString=tc;Jr.NAME="BMPString";class rc extends ae{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),i=new Uint8Array(t);for(let n=0;n<i.length;n+=4)i[n]=i[n+3],i[n+1]=i[n+2],i[n+2]=0,i[n+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,i=this.valueBlock.valueHexView=new Uint8Array(t*4);for(let n=0;n<t;n++){const o=Ze(e.charCodeAt(n),8),c=new Uint8Array(o);if(c.length>4)continue;const l=4-c.length;for(let u=c.length-1;u>=0;u--)i[n*4+u+l]=c[u]}this.valueBlock.value=e}}rc.NAME="UniversalStringValueBlock";var ic;class Yr extends rc{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}ic=Yr;C.UniversalString=ic;Yr.NAME="UniversalString";var nc;class Zr extends ae{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}nc=Zr;C.NumericString=nc;Zr.NAME="NumericString";var oc;class Qr extends ae{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}oc=Qr;C.PrintableString=oc;Qr.NAME="PrintableString";var sc;class Xr extends ae{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}sc=Xr;C.TeletexString=sc;Xr.NAME="TeletexString";var ac;class ei extends ae{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}ac=ei;C.VideotexString=ac;ei.NAME="VideotexString";var cc;class ti extends ae{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}cc=ti;C.IA5String=cc;ti.NAME="IA5String";var lc;class ri extends ae{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}lc=ri;C.GraphicString=lc;ri.NAME="GraphicString";var uc;class Wt extends ae{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}uc=Wt;C.VisibleString=uc;Wt.NAME="VisibleString";var fc;class ii extends ae{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}fc=ii;C.GeneralString=fc;ii.NAME="GeneralString";var hc;class ni extends ae{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}hc=ni;C.CharacterString=hc;ni.NAME="CharacterString";var pc;class Jt extends Wt{constructor({value:e,valueDate:t,...i}={}){if(super(i),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let n=0;n<e.length;n++)this.valueBlock.valueHexView[n]=e.charCodeAt(n)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,E.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),i=new Uint8Array(t);for(let n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const i=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(i===null){this.error="Wrong input string for conversion";return}const n=parseInt(i[1],10);n>=50?this.year=1900+n:this.year=2e3+n,this.month=parseInt(i[2],10),this.day=parseInt(i[3],10),this.hour=parseInt(i[4],10),this.minute=parseInt(i[5],10),this.second=parseInt(i[6],10)}toString(e="iso"){if(e==="iso"){const t=new Array(7);return t[0]=se(this.year<2e3?this.year-1900:this.year-2e3,2),t[1]=se(this.month,2),t[2]=se(this.day,2),t[3]=se(this.hour,2),t[4]=se(this.minute,2),t[5]=se(this.second,2),t[6]="Z",t.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}pc=Jt;C.UTCTime=pc;Jt.NAME="UTCTime";var dc;class oi extends Jt{constructor(e={}){var t;super(e),(t=this.millisecond)!==null&&t!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t=!1,i="",n="",o=0,c,l=0,u=0;if(e[e.length-1]==="Z")i=e.substring(0,e.length-1),t=!0;else{const b=new Number(e[e.length-1]);if(isNaN(b.valueOf()))throw new Error("Wrong input string for conversion");i=e}if(t){if(i.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(i.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let b=1,L=i.indexOf("+"),O="";if(L===-1&&(L=i.indexOf("-"),b=-1),L!==-1){if(O=i.substring(L+1),i=i.substring(0,L),O.length!==2&&O.length!==4)throw new Error("Wrong input string for conversion");let h=parseInt(O.substring(0,2),10);if(isNaN(h.valueOf()))throw new Error("Wrong input string for conversion");if(l=b*h,O.length===4){if(h=parseInt(O.substring(2,4),10),isNaN(h.valueOf()))throw new Error("Wrong input string for conversion");u=b*h}}}let p=i.indexOf(".");if(p===-1&&(p=i.indexOf(",")),p!==-1){const b=new Number(`0${i.substring(p)}`);if(isNaN(b.valueOf()))throw new Error("Wrong input string for conversion");o=b.valueOf(),n=i.substring(0,p)}else n=i;switch(!0){case n.length===8:if(c=/(\d{4})(\d{2})(\d{2})/ig,p!==-1)throw new Error("Wrong input string for conversion");break;case n.length===10:if(c=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,p!==-1){let b=60*o;this.minute=Math.floor(b),b=60*(b-this.minute),this.second=Math.floor(b),b=1e3*(b-this.second),this.millisecond=Math.floor(b)}break;case n.length===12:if(c=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,p!==-1){let b=60*o;this.second=Math.floor(b),b=1e3*(b-this.second),this.millisecond=Math.floor(b)}break;case n.length===14:if(c=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,p!==-1){const b=1e3*o;this.millisecond=Math.floor(b)}break;default:throw new Error("Wrong input string for conversion")}const w=c.exec(n);if(w===null)throw new Error("Wrong input string for conversion");for(let b=1;b<w.length;b++)switch(b){case 1:this.year=parseInt(w[b],10);break;case 2:this.month=parseInt(w[b],10);break;case 3:this.day=parseInt(w[b],10);break;case 4:this.hour=parseInt(w[b],10)+l;break;case 5:this.minute=parseInt(w[b],10)+u;break;case 6:this.second=parseInt(w[b],10);break;default:throw new Error("Wrong input string for conversion")}if(t===!1){const b=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=b.getUTCFullYear(),this.month=b.getUTCMonth(),this.day=b.getUTCDay(),this.hour=b.getUTCHours(),this.minute=b.getUTCMinutes(),this.second=b.getUTCSeconds(),this.millisecond=b.getUTCMilliseconds()}}toString(e="iso"){if(e==="iso"){const t=[];return t.push(se(this.year,4)),t.push(se(this.month,2)),t.push(se(this.day,2)),t.push(se(this.hour,2)),t.push(se(this.minute,2)),t.push(se(this.second,2)),this.millisecond!==0&&(t.push("."),t.push(se(this.millisecond,3))),t.push("Z"),t.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}dc=oi;C.GeneralizedTime=dc;oi.NAME="GeneralizedTime";var yc;class ao extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}yc=ao;C.DATE=yc;ao.NAME="DATE";var vc;class co extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}vc=co;C.TimeOfDay=vc;co.NAME="TimeOfDay";var gc;class lo extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}gc=lo;C.DateTime=gc;lo.NAME="DateTime";var mc;class uo extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}mc=uo;C.Duration=mc;uo.NAME="Duration";var wc;class fo extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}wc=fo;C.TIME=wc;fo.NAME="TIME";class Xe{constructor({name:e=ie,optional:t=!1}={}){this.name=e,this.optional=t}}class ho extends Xe{constructor({value:e=[],...t}={}){super(t),this.value=e}}class vr extends Xe{constructor({value:e=new Xe,local:t=!1,...i}={}){super(i),this.value=e,this.local=t}}class Dl{constructor({data:e=zr}={}){this.dataView=E.toUint8Array(e)}get data(){return this.dataView.slice().buffer}set data(e){this.dataView=E.toUint8Array(e)}fromBER(e,t,i){const n=t+i;return this.dataView=E.toUint8Array(e).subarray(t,n),n}toBER(e){return this.dataView.slice().buffer}}function We(r,e,t){if(t instanceof ho){for(let o=0;o<t.value.length;o++)if(We(r,e,t.value[o]).verified)return{verified:!0,result:r};{const o={verified:!1,result:{error:"Wrong values for Choice type"}};return t.hasOwnProperty(ji)&&(o.name=t.name),o}}if(t instanceof Xe)return t.hasOwnProperty(ji)&&(r[t.name]=e),{verified:!0,result:r};if(!(r instanceof Object))return{verified:!1,result:{error:"Wrong root object"}};if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(!(t instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Cl in t))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Pl in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(!(Vl in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const i=t.idBlock.toBER(!1);if(i.byteLength===0)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(t.idBlock.fromBER(i,0,i.byteLength)===-1)return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(t.idBlock.hasOwnProperty(El)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagClass!==e.idBlock.tagClass)return{verified:!1,result:r};if(t.idBlock.hasOwnProperty(Nl)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.tagNumber!==e.idBlock.tagNumber)return{verified:!1,result:r};if(t.idBlock.hasOwnProperty(Ol)===!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isConstructed!==e.idBlock.isConstructed)return{verified:!1,result:r};if(!(Il in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(t.idBlock.isHexOnly!==e.idBlock.isHexOnly)return{verified:!1,result:r};if(t.idBlock.isHexOnly){if(!(is in t.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const o=t.idBlock.valueHexView,c=e.idBlock.valueHexView;if(o.length!==c.length)return{verified:!1,result:r};for(let l=0;l<o.length;l++)if(o[l]!==c[1])return{verified:!1,result:r}}if(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,ie),t.name&&(r[t.name]=e)),t instanceof C.Constructed){let o=0,c={verified:!1,result:{error:"Unknown error"}},l=t.valueBlock.value.length;if(l>0&&t.valueBlock.value[0]instanceof vr&&(l=e.valueBlock.value.length),l===0)return{verified:!0,result:r};if(e.valueBlock.value.length===0&&t.valueBlock.value.length!==0){let u=!0;for(let p=0;p<t.valueBlock.value.length;p++)u=u&&(t.valueBlock.value[p].optional||!1);return u?{verified:!0,result:r}:(t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,ie),t.name&&delete r[t.name]),r.error="Inconsistent object length",{verified:!1,result:r})}for(let u=0;u<l;u++)if(u-o>=e.valueBlock.value.length){if(t.valueBlock.value[u].optional===!1){const p={verified:!1,result:r};return r.error="Inconsistent length between ASN.1 data and schema",t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,ie),t.name&&(delete r[t.name],p.name=t.name)),p}}else if(t.valueBlock.value[0]instanceof vr){if(c=We(r,e.valueBlock.value[u],t.valueBlock.value[0].value),c.verified===!1)if(t.valueBlock.value[0].optional)o++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,ie),t.name&&delete r[t.name]),c;if(ji in t.valueBlock.value[0]&&t.valueBlock.value[0].name.length>0){let p={};Tl in t.valueBlock.value[0]&&t.valueBlock.value[0].local?p=e:p=r,typeof p[t.valueBlock.value[0].name]>"u"&&(p[t.valueBlock.value[0].name]=[]),p[t.valueBlock.value[0].name].push(e.valueBlock.value[u])}}else if(c=We(r,e.valueBlock.value[u-o],t.valueBlock.value[u]),c.verified===!1)if(t.valueBlock.value[u].optional)o++;else return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,ie),t.name&&delete r[t.name]),c;if(c.verified===!1){const u={verified:!1,result:r};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,ie),t.name&&(delete r[t.name],u.name=t.name)),u}return{verified:!0,result:r}}if(t.primitiveSchema&&is in e.valueBlock){const o=It(e.valueBlock.valueHexView);if(o.offset===-1){const c={verified:!1,result:o.result};return t.name&&(t.name=t.name.replace(/^\s+|\s+$/g,ie),t.name&&(delete r[t.name],c.name=t.name)),c}return We(r,o.result,t.primitiveSchema)}return{verified:!0,result:r}}function Hl(r,e){if(!(e instanceof Object))return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const t=It(E.toUint8Array(r));return t.offset===-1?{verified:!1,result:t.result}:We(t.result,t.result,e)}const bc=Object.freeze(Object.defineProperty({__proto__:null,Any:Xe,BaseBlock:Z,BaseStringBlock:io,BitString:Je,BmpString:Jr,Boolean:Gr,CharacterString:ni,Choice:ho,Constructed:ne,DATE:ao,DateTime:lo,Duration:uo,EndOfContent:no,Enumerated:Kr,GeneralString:ii,GeneralizedTime:oi,GraphicString:ri,HexBlock:Ie,IA5String:ti,Integer:Be,Null:Qe,NumericString:Zr,ObjectIdentifier:Wr,OctetString:Pe,Primitive:Kt,PrintableString:Qr,RawData:Dl,RelativeObjectIdentifier:so,Repeated:vr,Sequence:Ve,Set:Te,TIME:fo,TeletexString:Xr,TimeOfDay:co,UTCTime:Jt,UniversalString:Yr,Utf8String:De,ValueBlock:te,VideotexString:ei,ViewWriter:qr,VisibleString:Wt,compareSchema:We,fromBER:ht,verifySchema:Hl},Symbol.toStringTag,{value:"Module"}));var A;(function(r){r[r.Sequence=0]="Sequence",r[r.Set=1]="Set",r[r.Choice=2]="Choice"})(A||(A={}));var f;(function(r){r[r.Any=1]="Any",r[r.Boolean=2]="Boolean",r[r.OctetString=3]="OctetString",r[r.BitString=4]="BitString",r[r.Integer=5]="Integer",r[r.Enumerated=6]="Enumerated",r[r.ObjectIdentifier=7]="ObjectIdentifier",r[r.Utf8String=8]="Utf8String",r[r.BmpString=9]="BmpString",r[r.UniversalString=10]="UniversalString",r[r.NumericString=11]="NumericString",r[r.PrintableString=12]="PrintableString",r[r.TeletexString=13]="TeletexString",r[r.VideotexString=14]="VideotexString",r[r.IA5String=15]="IA5String",r[r.GraphicString=16]="GraphicString",r[r.VisibleString=17]="VisibleString",r[r.GeneralString=18]="GeneralString",r[r.CharacterString=19]="CharacterString",r[r.UTCTime=20]="UTCTime",r[r.GeneralizedTime=21]="GeneralizedTime",r[r.DATE=22]="DATE",r[r.TimeOfDay=23]="TimeOfDay",r[r.DateTime=24]="DateTime",r[r.Duration=25]="Duration",r[r.TIME=26]="TIME",r[r.Null=27]="Null"})(f||(f={}));class si{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if(typeof e=="number")this.fromNumber(e);else if(E.isBufferSource(e))this.unusedBits=t,this.value=E.toArrayBuffer(e);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(e){if(!(e instanceof Je))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new Je({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new Je({name:e})}toNumber(){let e="";const t=new Uint8Array(this.value);for(const i of t)e+=i.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2);const i=t.length+7>>3;this.unusedBits=(i<<3)-t.length;const n=new Uint8Array(i);t=t.padStart(i<<3,"0").split("").reverse().join("");let o=0;for(;o<i;)n[o]=parseInt(t.slice(o<<3,(o<<3)+8),2),o++;this.value=n.buffer}}class D{constructor(e){typeof e=="number"?this.buffer=new ArrayBuffer(e):E.isBufferSource(e)?this.buffer=E.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}fromASN(e){if(!(e instanceof Pe))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new Pe({valueHex:this.buffer})}toSchema(e){return new Pe({name:e})}}const Ml={fromASN:r=>r instanceof Qe?null:r.valueBeforeDecodeView,toASN:r=>{if(r===null)return new Qe;const e=ht(r);if(e.result.error)throw new Error(e.result.error);return e.result}},$l={fromASN:r=>r.valueBlock.valueHexView.byteLength>=4?r.valueBlock.toString():r.valueBlock.valueDec,toASN:r=>new Be({value:+r})},Ll={fromASN:r=>r.valueBlock.valueDec,toASN:r=>new Kr({value:r})},q={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new Be({valueHex:r})},Fl={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new Je({valueHex:r})},ql={fromASN:r=>r.valueBlock.toString(),toASN:r=>new Wr({value:r})},zl={fromASN:r=>r.valueBlock.value,toASN:r=>new Gr({value:r})},gr={fromASN:r=>r.valueBlock.valueHexView,toASN:r=>new Pe({valueHex:r})},Gl={fromASN:r=>new D(r.getValue()),toASN:r=>r.toASN()};function de(r){return{fromASN:e=>e.valueBlock.value,toASN:e=>new r({value:e})}}const Ac=de(De),Kl=de(Jr),Wl=de(Yr),Jl=de(Zr),Yl=de(Qr),Zl=de(Xr),Ql=de(ei),Xl=de(ti),eu=de(ri),tu=de(Wt),ru=de(ii),iu=de(ni),nu={fromASN:r=>r.toDate(),toASN:r=>new Jt({valueDate:r})},ou={fromASN:r=>r.toDate(),toASN:r=>new oi({valueDate:r})},su={fromASN:()=>null,toASN:()=>new Qe};function po(r){switch(r){case f.Any:return Ml;case f.BitString:return Fl;case f.BmpString:return Kl;case f.Boolean:return zl;case f.CharacterString:return iu;case f.Enumerated:return Ll;case f.GeneralString:return ru;case f.GeneralizedTime:return ou;case f.GraphicString:return eu;case f.IA5String:return Xl;case f.Integer:return $l;case f.Null:return su;case f.NumericString:return Jl;case f.ObjectIdentifier:return ql;case f.OctetString:return gr;case f.PrintableString:return Yl;case f.TeletexString:return Zl;case f.UTCTime:return nu;case f.UniversalString:return Wl;case f.Utf8String:return Ac;case f.VideotexString:return Ql;case f.VisibleString:return tu;default:return null}}function Oe(r){return typeof r=="function"&&r.prototype?r.prototype.toASN&&r.prototype.fromASN?!0:Oe(r.prototype):!!(r&&typeof r=="object"&&"toASN"in r&&"fromASN"in r)}function Sc(r){var e;if(r){const t=Object.getPrototypeOf(r);return((e=t?.prototype)===null||e===void 0?void 0:e.constructor)===Array?!0:Sc(t)}return!1}function au(r,e){if(!(r&&e)||r.byteLength!==e.byteLength)return!1;const t=new Uint8Array(r),i=new Uint8Array(e);for(let n=0;n<r.byteLength;n++)if(t[n]!==i[n])return!1;return!0}class cu{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){const i=this.items.get(e);if(!i)throw new Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!i.schema)throw new Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return i}cache(e){const t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){const t={type:A.Sequence,items:{}},i=this.findParentSchema(e);return i&&(Object.assign(t,i),t.items=Object.assign({},t.items,i.items)),t}create(e,t){const i=this.items.get(e)||this.createDefault(e),n=[];for(const o in i.items){const c=i.items[o],l=t?o:"";let u;if(typeof c.type=="number"){const w=f[c.type],b=bc[w];if(!b)throw new Error(`Cannot get ASN1 class by name '${w}'`);u=new b({name:l})}else Oe(c.type)?u=new c.type().toSchema(l):c.optional?this.get(c.type).type===A.Choice?u=new Xe({name:l}):(u=this.create(c.type,!1),u.name=l):u=new Xe({name:l});const p=!!c.optional||c.defaultValue!==void 0;if(c.repeated){u.name="";const w=c.repeated==="set"?Te:Ve;u=new w({name:"",value:[new vr({name:l,value:u})]})}if(c.context!==null&&c.context!==void 0)if(c.implicit)if(typeof c.type=="number"||Oe(c.type)){const w=c.repeated?ne:Kt;n.push(new w({name:l,optional:p,idBlock:{tagClass:3,tagNumber:c.context}}))}else{this.cache(c.type);const w=!!c.repeated;let b=w?u:this.get(c.type,!0).schema;b="valueBlock"in b?b.valueBlock.value:b.value,n.push(new ne({name:w?"":l,optional:p,idBlock:{tagClass:3,tagNumber:c.context},value:b}))}else n.push(new ne({optional:p,idBlock:{tagClass:3,tagNumber:c.context},value:[u]}));else u.optional=p,n.push(u)}switch(i.type){case A.Sequence:return new Ve({value:n,name:""});case A.Set:return new Te({value:n,name:""});case A.Choice:return new ho({value:n,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=Object.getPrototypeOf(e);return t?this.items.get(t)||this.findParentSchema(t):null}}const fe=new cu,B=r=>e=>{let t;fe.has(e)?t=fe.get(e):(t=fe.createDefault(e),fe.set(e,t)),Object.assign(t,r)},a=r=>(e,t)=>{let i;fe.has(e.constructor)?i=fe.get(e.constructor):(i=fe.createDefault(e.constructor),fe.set(e.constructor,i));const n=Object.assign({},r);if(typeof n.type=="number"&&!n.converter){const o=po(r.type);if(!o)throw new Error(`Cannot get default converter for property '${t}' of ${e.constructor.name}`);n.converter=o}i.items[t]=n};class os extends Error{constructor(){super(...arguments),this.schemas=[]}}class lu{static parse(e,t){const i=ht(e);if(i.result.error)throw new Error(i.result.error);return this.fromASN(i.result,t)}static fromASN(e,t){var i;try{if(Oe(t))return new t().fromASN(e);const n=fe.get(t);fe.cache(t);let o=n.schema;if(e.constructor===ne&&n.type!==A.Choice){o=new ne({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:n.schema.valueBlock.value});for(const u in n.items)delete e[u]}const c=We({},e,o);if(!c.verified)throw new os(`Data does not match to ${t.name} ASN1 schema. ${c.result.error}`);const l=new t;if(Sc(t)){if(!("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const u=n.itemType;if(typeof u=="number"){const p=po(u);if(!p)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);return t.from(e.valueBlock.value,w=>p.fromASN(w))}else return t.from(e.valueBlock.value,p=>this.fromASN(p,u))}for(const u in n.items){const p=c.result[u];if(!p)continue;const w=n.items[u],b=w.type;if(typeof b=="number"||Oe(b)){const L=(i=w.converter)!==null&&i!==void 0?i:Oe(b)?new b:null;if(!L)throw new Error("Converter is empty");if(w.repeated)if(w.implicit){const O=w.repeated==="sequence"?Ve:Te,h=new O;h.valueBlock=p.valueBlock;const y=ht(h.toBER(!1));if(y.offset===-1)throw new Error(`Cannot parse the child item. ${y.result.error}`);if(!("value"in y.result.valueBlock&&Array.isArray(y.result.valueBlock.value)))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const m=y.result.valueBlock.value;l[u]=Array.from(m,g=>L.fromASN(g))}else l[u]=Array.from(p,O=>L.fromASN(O));else{let O=p;if(w.implicit){let h;if(Oe(b))h=new b().toSchema("");else{const y=f[b],m=bc[y];if(!m)throw new Error(`Cannot get '${y}' class from asn1js module`);h=new m}h.valueBlock=O.valueBlock,O=ht(h.toBER(!1)).result}l[u]=L.fromASN(O)}}else if(w.repeated){if(!Array.isArray(p))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");l[u]=Array.from(p,L=>this.fromASN(L,b))}else l[u]=this.fromASN(p,b)}return l}catch(n){throw n instanceof os&&n.schemas.push(t.name),n}}}class yo{static serialize(e){return e instanceof Z?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){if(e&&typeof e=="object"&&Oe(e))return e.toASN();if(!(e&&typeof e=="object"))throw new TypeError("Parameter 1 should be type of Object.");const t=e.constructor,i=fe.get(t);fe.cache(t);let n=[];if(i.itemType){if(!Array.isArray(e))throw new TypeError("Parameter 1 should be type of Array.");if(typeof i.itemType=="number"){const c=po(i.itemType);if(!c)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);n=e.map(l=>c.toASN(l))}else n=e.map(c=>this.toAsnItem({type:i.itemType},"[]",t,c))}else for(const c in i.items){const l=i.items[c],u=e[c];if(u===void 0||l.defaultValue===u||typeof l.defaultValue=="object"&&typeof u=="object"&&au(this.serialize(l.defaultValue),this.serialize(u)))continue;const p=yo.toAsnItem(l,c,t,u);if(typeof l.context=="number")if(l.implicit)if(!l.repeated&&(typeof l.type=="number"||Oe(l.type))){const w={};w.valueHex=p instanceof Qe?p.valueBeforeDecodeView:p.valueBlock.toBER(),n.push(new Kt({optional:l.optional,idBlock:{tagClass:3,tagNumber:l.context},...w}))}else n.push(new ne({optional:l.optional,idBlock:{tagClass:3,tagNumber:l.context},value:p.valueBlock.value}));else n.push(new ne({optional:l.optional,idBlock:{tagClass:3,tagNumber:l.context},value:[p]}));else l.repeated?n=n.concat(p):n.push(p)}let o;switch(i.type){case A.Sequence:o=new Ve({value:n});break;case A.Set:o=new Te({value:n});break;case A.Choice:if(!n[0])throw new Error(`Schema '${t.name}' has wrong data. Choice cannot be empty.`);o=n[0];break}return o}static toAsnItem(e,t,i,n){let o;if(typeof e.type=="number"){const c=e.converter;if(!c)throw new Error(`Property '${t}' doesn't have converter for type ${f[e.type]} in schema '${i.name}'`);if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const l=Array.from(n,p=>c.toASN(p)),u=e.repeated==="sequence"?Ve:Te;o=new u({value:l})}else o=c.toASN(n)}else if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const c=Array.from(n,u=>this.toASN(u)),l=e.repeated==="sequence"?Ve:Te;o=new l({value:c})}else o=this.toASN(n);return o}}class $ extends Array{constructor(e=[]){if(typeof e=="number")super(e);else{super();for(const t of e)this.push(t)}}}class j{static serialize(e){return yo.serialize(e)}static parse(e,t){return lu.parse(e,t)}static toString(e){const t=E.isBufferSource(e)?E.toArrayBuffer(e):j.serialize(e),i=ht(t);if(i.offset===-1)throw new Error(`Cannot decode ASN.1 data. ${i.result.error}`);return i.result.toString()}}function s(r,e,t,i){var n=arguments.length,o=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,e,t,i);else for(var l=r.length-1;l>=0;l--)(c=r[l])&&(o=(n<3?c(o):n>3?c(e,t,o):c(e,t))||o);return n>3&&o&&Object.defineProperty(e,t,o),o}var Hi={exports:{}};(function(r){(function(e){const t="(0?\\d+|0x[a-f0-9]+)",i={fourOctet:new RegExp(`^${t}\\.${t}\\.${t}\\.${t}$`,"i"),threeOctet:new RegExp(`^${t}\\.${t}\\.${t}$`,"i"),twoOctet:new RegExp(`^${t}\\.${t}$`,"i"),longValue:new RegExp(`^${t}$`,"i")},n=new RegExp("^0[0-7]+$","i"),o=new RegExp("^0x[a-f0-9]+$","i"),c="%[0-9a-z]{1,}",l="(?:[0-9a-f]+::?)+",u={zoneIndex:new RegExp(c,"i"),native:new RegExp(`^(::)?(${l})?([0-9a-f]+)?(::)?(${c})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${t}\\.${t}\\.${t}\\.${t}(${c})?)$`,"i"),transitional:new RegExp(`^((?:${l})|(?:::)(?:${l})?)${t}\\.${t}\\.${t}\\.${t}(${c})?$`,"i")};function p(h,y){if(h.indexOf("::")!==h.lastIndexOf("::"))return null;let m=0,g=-1,k=(h.match(u.zoneIndex)||[])[0],x,F;for(k&&(k=k.substring(1),h=h.replace(/%.+$/,""));(g=h.indexOf(":",g+1))>=0;)m++;if(h.substr(0,2)==="::"&&m--,h.substr(-2,2)==="::"&&m--,m>y)return null;for(F=y-m,x=":";F--;)x+="0:";return h=h.replace("::",x),h[0]===":"&&(h=h.slice(1)),h[h.length-1]===":"&&(h=h.slice(0,-1)),y=function(){const lr=h.split(":"),ur=[];for(let jt=0;jt<lr.length;jt++)ur.push(parseInt(lr[jt],16));return ur}(),{parts:y,zoneId:k}}function w(h,y,m,g){if(h.length!==y.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let k=0,x;for(;g>0;){if(x=m-g,x<0&&(x=0),h[k]>>x!==y[k]>>x)return!1;g-=m,k+=1}return!0}function b(h){if(o.test(h))return parseInt(h,16);if(h[0]==="0"&&!isNaN(parseInt(h[1],10))){if(n.test(h))return parseInt(h,8);throw new Error(`ipaddr: cannot parse ${h} as octal`)}return parseInt(h,10)}function L(h,y){for(;h.length<y;)h=`0${h}`;return h}const O={};O.IPv4=function(){function h(y){if(y.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let m,g;for(m=0;m<y.length;m++)if(g=y[m],!(0<=g&&g<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=y}return h.prototype.SpecialRanges={unspecified:[[new h([0,0,0,0]),8]],broadcast:[[new h([255,255,255,255]),32]],multicast:[[new h([224,0,0,0]),4]],linkLocal:[[new h([169,254,0,0]),16]],loopback:[[new h([127,0,0,0]),8]],carrierGradeNat:[[new h([100,64,0,0]),10]],private:[[new h([10,0,0,0]),8],[new h([172,16,0,0]),12],[new h([192,168,0,0]),16]],reserved:[[new h([192,0,0,0]),24],[new h([192,0,2,0]),24],[new h([192,88,99,0]),24],[new h([198,51,100,0]),24],[new h([203,0,113,0]),24],[new h([240,0,0,0]),4]]},h.prototype.kind=function(){return"ipv4"},h.prototype.match=function(y,m){let g;if(m===void 0&&(g=y,y=g[0],m=g[1]),y.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return w(this.octets,y.octets,8,m)},h.prototype.prefixLengthFromSubnetMask=function(){let y=0,m=!1;const g={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let k,x,F;for(k=3;k>=0;k-=1)if(x=this.octets[k],x in g){if(F=g[x],m&&F!==0)return null;F!==8&&(m=!0),y+=F}else return null;return 32-y},h.prototype.range=function(){return O.subnetMatch(this,this.SpecialRanges)},h.prototype.toByteArray=function(){return this.octets.slice(0)},h.prototype.toIPv4MappedAddress=function(){return O.IPv6.parse(`::ffff:${this.toString()}`)},h.prototype.toNormalizedString=function(){return this.toString()},h.prototype.toString=function(){return this.octets.join(".")},h}(),O.IPv4.broadcastAddressFromCIDR=function(h){try{const y=this.parseCIDR(h),m=y[0].toByteArray(),g=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),k=[];let x=0;for(;x<4;)k.push(parseInt(m[x],10)|parseInt(g[x],10)^255),x++;return new this(k)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},O.IPv4.isIPv4=function(h){return this.parser(h)!==null},O.IPv4.isValid=function(h){try{return new this(this.parser(h)),!0}catch{return!1}},O.IPv4.isValidFourPartDecimal=function(h){return!!(O.IPv4.isValid(h)&&h.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},O.IPv4.networkAddressFromCIDR=function(h){let y,m,g,k,x;try{for(y=this.parseCIDR(h),g=y[0].toByteArray(),x=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),k=[],m=0;m<4;)k.push(parseInt(g[m],10)&parseInt(x[m],10)),m++;return new this(k)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},O.IPv4.parse=function(h){const y=this.parser(h);if(y===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(y)},O.IPv4.parseCIDR=function(h){let y;if(y=h.match(/^(.+)\/(\d+)$/)){const m=parseInt(y[2]);if(m>=0&&m<=32){const g=[this.parse(y[1]),m];return Object.defineProperty(g,"toString",{value:function(){return this.join("/")}}),g}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},O.IPv4.parser=function(h){let y,m,g;if(y=h.match(i.fourOctet))return function(){const k=y.slice(1,6),x=[];for(let F=0;F<k.length;F++)m=k[F],x.push(b(m));return x}();if(y=h.match(i.longValue)){if(g=b(y[1]),g>4294967295||g<0)throw new Error("ipaddr: address outside defined range");return function(){const k=[];let x;for(x=0;x<=24;x+=8)k.push(g>>x&255);return k}().reverse()}else return(y=h.match(i.twoOctet))?function(){const k=y.slice(1,4),x=[];if(g=b(k[1]),g>16777215||g<0)throw new Error("ipaddr: address outside defined range");return x.push(b(k[0])),x.push(g>>16&255),x.push(g>>8&255),x.push(g&255),x}():(y=h.match(i.threeOctet))?function(){const k=y.slice(1,5),x=[];if(g=b(k[2]),g>65535||g<0)throw new Error("ipaddr: address outside defined range");return x.push(b(k[0])),x.push(b(k[1])),x.push(g>>8&255),x.push(g&255),x}():null},O.IPv4.subnetMaskFromPrefixLength=function(h){if(h=parseInt(h),h<0||h>32)throw new Error("ipaddr: invalid IPv4 prefix length");const y=[0,0,0,0];let m=0;const g=Math.floor(h/8);for(;m<g;)y[m]=255,m++;return g<4&&(y[g]=Math.pow(2,h%8)-1<<8-h%8),new this(y)},O.IPv6=function(){function h(y,m){let g,k;if(y.length===16)for(this.parts=[],g=0;g<=14;g+=2)this.parts.push(y[g]<<8|y[g+1]);else if(y.length===8)this.parts=y;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(g=0;g<this.parts.length;g++)if(k=this.parts[g],!(0<=k&&k<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");m&&(this.zoneId=m)}return h.prototype.SpecialRanges={unspecified:[new h([0,0,0,0,0,0,0,0]),128],linkLocal:[new h([65152,0,0,0,0,0,0,0]),10],multicast:[new h([65280,0,0,0,0,0,0,0]),8],loopback:[new h([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new h([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new h([0,0,0,0,0,65535,0,0]),96],rfc6145:[new h([0,0,0,0,65535,0,0,0]),96],rfc6052:[new h([100,65435,0,0,0,0,0,0]),96],"6to4":[new h([8194,0,0,0,0,0,0,0]),16],teredo:[new h([8193,0,0,0,0,0,0,0]),32],reserved:[[new h([8193,3512,0,0,0,0,0,0]),32]]},h.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},h.prototype.kind=function(){return"ipv6"},h.prototype.match=function(y,m){let g;if(m===void 0&&(g=y,y=g[0],m=g[1]),y.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return w(this.parts,y.parts,16,m)},h.prototype.prefixLengthFromSubnetMask=function(){let y=0,m=!1;const g={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let k,x;for(let F=7;F>=0;F-=1)if(k=this.parts[F],k in g){if(x=g[k],m&&x!==0)return null;x!==16&&(m=!0),y+=x}else return null;return 128-y},h.prototype.range=function(){return O.subnetMatch(this,this.SpecialRanges)},h.prototype.toByteArray=function(){let y;const m=[],g=this.parts;for(let k=0;k<g.length;k++)y=g[k],m.push(y>>8),m.push(y&255);return m},h.prototype.toFixedLengthString=function(){const y=function(){const g=[];for(let k=0;k<this.parts.length;k++)g.push(L(this.parts[k].toString(16),4));return g}.call(this).join(":");let m="";return this.zoneId&&(m=`%${this.zoneId}`),y+m},h.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const y=this.parts.slice(-2),m=y[0],g=y[1];return new O.IPv4([m>>8,m&255,g>>8,g&255])},h.prototype.toNormalizedString=function(){const y=function(){const g=[];for(let k=0;k<this.parts.length;k++)g.push(this.parts[k].toString(16));return g}.call(this).join(":");let m="";return this.zoneId&&(m=`%${this.zoneId}`),y+m},h.prototype.toRFC5952String=function(){const y=/((^|:)(0(:|$)){2,})/g,m=this.toNormalizedString();let g=0,k=-1,x;for(;x=y.exec(m);)x[0].length>k&&(g=x.index,k=x[0].length);return k<0?m:`${m.substring(0,g)}::${m.substring(g+k)}`},h.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},h}(),O.IPv6.broadcastAddressFromCIDR=function(h){try{const y=this.parseCIDR(h),m=y[0].toByteArray(),g=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),k=[];let x=0;for(;x<16;)k.push(parseInt(m[x],10)|parseInt(g[x],10)^255),x++;return new this(k)}catch(y){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${y})`)}},O.IPv6.isIPv6=function(h){return this.parser(h)!==null},O.IPv6.isValid=function(h){if(typeof h=="string"&&h.indexOf(":")===-1)return!1;try{const y=this.parser(h);return new this(y.parts,y.zoneId),!0}catch{return!1}},O.IPv6.networkAddressFromCIDR=function(h){let y,m,g,k,x;try{for(y=this.parseCIDR(h),g=y[0].toByteArray(),x=this.subnetMaskFromPrefixLength(y[1]).toByteArray(),k=[],m=0;m<16;)k.push(parseInt(g[m],10)&parseInt(x[m],10)),m++;return new this(k)}catch(F){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${F})`)}},O.IPv6.parse=function(h){const y=this.parser(h);if(y.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(y.parts,y.zoneId)},O.IPv6.parseCIDR=function(h){let y,m,g;if((m=h.match(/^(.+)\/(\d+)$/))&&(y=parseInt(m[2]),y>=0&&y<=128))return g=[this.parse(m[1]),y],Object.defineProperty(g,"toString",{value:function(){return this.join("/")}}),g;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},O.IPv6.parser=function(h){let y,m,g,k,x,F;if(g=h.match(u.deprecatedTransitional))return this.parser(`::ffff:${g[1]}`);if(u.native.test(h))return p(h,8);if((g=h.match(u.transitional))&&(F=g[6]||"",y=p(g[1].slice(0,-1)+F,6),y.parts)){for(x=[parseInt(g[2]),parseInt(g[3]),parseInt(g[4]),parseInt(g[5])],m=0;m<x.length;m++)if(k=x[m],!(0<=k&&k<=255))return null;return y.parts.push(x[0]<<8|x[1]),y.parts.push(x[2]<<8|x[3]),{parts:y.parts,zoneId:y.zoneId}}return null},O.IPv6.subnetMaskFromPrefixLength=function(h){if(h=parseInt(h),h<0||h>128)throw new Error("ipaddr: invalid IPv6 prefix length");const y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let m=0;const g=Math.floor(h/8);for(;m<g;)y[m]=255,m++;return g<16&&(y[g]=Math.pow(2,h%8)-1<<8-h%8),new this(y)},O.fromByteArray=function(h){const y=h.length;if(y===4)return new O.IPv4(h);if(y===16)return new O.IPv6(h);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},O.isValid=function(h){return O.IPv6.isValid(h)||O.IPv4.isValid(h)},O.parse=function(h){if(O.IPv6.isValid(h))return O.IPv6.parse(h);if(O.IPv4.isValid(h))return O.IPv4.parse(h);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},O.parseCIDR=function(h){try{return O.IPv6.parseCIDR(h)}catch{try{return O.IPv4.parseCIDR(h)}catch{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},O.process=function(h){const y=this.parse(h);return y.kind()==="ipv6"&&y.isIPv4MappedAddress()?y.toIPv4Address():y},O.subnetMatch=function(h,y,m){let g,k,x,F;m==null&&(m="unicast");for(k in y)if(Object.prototype.hasOwnProperty.call(y,k)){for(x=y[k],x[0]&&!(x[0]instanceof Array)&&(x=[x]),g=0;g<x.length;g++)if(F=x[g],h.kind()===F[0].kind()&&h.match.apply(h,F))return k}return m},r.exports?r.exports=O:e.ipaddr=O})(_i)})(Hi);class ss{static decodeIP(e){if(e.length===64&&parseInt(e,16)===0)return"::/0";if(e.length!==16)return e;const t=parseInt(e.slice(8),16).toString(2).split("").reduce((n,o)=>n+ +o,0);let i=e.slice(0,8).replace(/(.{2})/g,n=>`${parseInt(n,16)}.`);return i=i.slice(0,-1),`${i}/${t}`}static toString(e){if(e.byteLength===4||e.byteLength===16){const t=new Uint8Array(e);return Hi.exports.fromByteArray(Array.from(t)).toString()}return this.decodeIP(N.ToHex(e))}static fromString(e){const t=Hi.exports.parse(e);return new Uint8Array(t.toByteArray()).buffer}}var Mi,$i,Li;let Q=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};s([a({type:f.TeletexString})],Q.prototype,"teletexString",void 0);s([a({type:f.PrintableString})],Q.prototype,"printableString",void 0);s([a({type:f.UniversalString})],Q.prototype,"universalString",void 0);s([a({type:f.Utf8String})],Q.prototype,"utf8String",void 0);s([a({type:f.BmpString})],Q.prototype,"bmpString",void 0);Q=s([B({type:A.Choice})],Q);let vt=class extends Q{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?N.ToHex(this.anyValue):super.toString())}};s([a({type:f.IA5String})],vt.prototype,"ia5String",void 0);s([a({type:f.Any})],vt.prototype,"anyValue",void 0);vt=s([B({type:A.Choice})],vt);class Lt{constructor(e={}){this.type="",this.value=new vt,Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],Lt.prototype,"type",void 0);s([a({type:vt})],Lt.prototype,"value",void 0);let gt=Mi=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Mi.prototype)}};gt=Mi=s([B({type:A.Set,itemType:Lt})],gt);let Fi=$i=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,$i.prototype)}};Fi=$i=s([B({type:A.Sequence,itemType:gt})],Fi);let J=Li=class extends Fi{constructor(e){super(e),Object.setPrototypeOf(this,Li.prototype)}};J=Li=s([B({type:A.Sequence})],J);const uu={fromASN:r=>ss.toString(gr.fromASN(r)),toASN:r=>gr.toASN(ss.fromString(r))};class Fe{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],Fe.prototype,"typeId",void 0);s([a({type:f.Any,context:0})],Fe.prototype,"value",void 0);class vo{constructor(e={}){this.partyName=new Q,Object.assign(this,e)}}s([a({type:Q,optional:!0,context:0,implicit:!0})],vo.prototype,"nameAssigner",void 0);s([a({type:Q,context:1,implicit:!0})],vo.prototype,"partyName",void 0);let U=class{constructor(e={}){Object.assign(this,e)}};s([a({type:Fe,context:0,implicit:!0})],U.prototype,"otherName",void 0);s([a({type:f.IA5String,context:1,implicit:!0})],U.prototype,"rfc822Name",void 0);s([a({type:f.IA5String,context:2,implicit:!0})],U.prototype,"dNSName",void 0);s([a({type:f.Any,context:3,implicit:!0})],U.prototype,"x400Address",void 0);s([a({type:J,context:4,implicit:!1})],U.prototype,"directoryName",void 0);s([a({type:vo,context:5})],U.prototype,"ediPartyName",void 0);s([a({type:f.IA5String,context:6,implicit:!0})],U.prototype,"uniformResourceIdentifier",void 0);s([a({type:f.OctetString,context:7,implicit:!0,converter:uu})],U.prototype,"iPAddress",void 0);s([a({type:f.ObjectIdentifier,context:8,implicit:!0})],U.prototype,"registeredID",void 0);U=s([B({type:A.Choice})],U);const st="2.5.29";var qi;class ai{constructor(e={}){this.accessMethod="",this.accessLocation=new U,Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],ai.prototype,"accessMethod",void 0);s([a({type:U})],ai.prototype,"accessLocation",void 0);let as=qi=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,qi.prototype)}};as=qi=s([B({type:A.Sequence,itemType:ai})],as);const zi=`${st}.35`;class go extends D{}class pt{constructor(e={}){e&&Object.assign(this,e)}}s([a({type:go,context:0,optional:!0,implicit:!0})],pt.prototype,"keyIdentifier",void 0);s([a({type:U,context:1,optional:!0,implicit:!0,repeated:"sequence"})],pt.prototype,"authorityCertIssuer",void 0);s([a({type:f.Integer,context:2,optional:!0,implicit:!0,converter:q})],pt.prototype,"authorityCertSerialNumber",void 0);const Bc=`${st}.19`;class mr{constructor(e={}){this.cA=!1,Object.assign(this,e)}}s([a({type:f.Boolean,defaultValue:!1})],mr.prototype,"cA",void 0);s([a({type:f.Integer,optional:!0})],mr.prototype,"pathLenConstraint",void 0);var Gi;let we=Gi=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Gi.prototype)}};we=Gi=s([B({type:A.Sequence,itemType:U})],we);var Ki;let cs=Ki=class extends we{constructor(e){super(e),Object.setPrototypeOf(this,Ki.prototype)}};cs=Ki=s([B({type:A.Sequence})],cs);var Wi;const xc=`${st}.32`;let je=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};s([a({type:f.IA5String})],je.prototype,"ia5String",void 0);s([a({type:f.VisibleString})],je.prototype,"visibleString",void 0);s([a({type:f.BmpString})],je.prototype,"bmpString",void 0);s([a({type:f.Utf8String})],je.prototype,"utf8String",void 0);je=s([B({type:A.Choice})],je);class mo{constructor(e={}){this.organization=new je,this.noticeNumbers=[],Object.assign(this,e)}}s([a({type:je})],mo.prototype,"organization",void 0);s([a({type:f.Integer,repeated:"sequence"})],mo.prototype,"noticeNumbers",void 0);class wo{constructor(e={}){Object.assign(this,e)}}s([a({type:mo,optional:!0})],wo.prototype,"noticeRef",void 0);s([a({type:je,optional:!0})],wo.prototype,"explicitText",void 0);let wr=class{constructor(e={}){Object.assign(this,e)}};s([a({type:f.IA5String})],wr.prototype,"cPSuri",void 0);s([a({type:wo})],wr.prototype,"userNotice",void 0);wr=s([B({type:A.Choice})],wr);class bo{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],bo.prototype,"policyQualifierId",void 0);s([a({type:f.Any})],bo.prototype,"qualifier",void 0);class ci{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],ci.prototype,"policyIdentifier",void 0);s([a({type:bo,repeated:"sequence",optional:!0})],ci.prototype,"policyQualifiers",void 0);let br=Wi=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Wi.prototype)}};br=Wi=s([B({type:A.Sequence,itemType:ci})],br);let Ar=class{constructor(e=0){this.value=e}};s([a({type:f.Integer})],Ar.prototype,"value",void 0);Ar=s([B({type:A.Choice})],Ar);let ls=class extends Ar{};ls=s([B({type:A.Choice})],ls);var Ji,ve;(function(r){r[r.unused=1]="unused",r[r.keyCompromise=2]="keyCompromise",r[r.cACompromise=4]="cACompromise",r[r.affiliationChanged=8]="affiliationChanged",r[r.superseded=16]="superseded",r[r.cessationOfOperation=32]="cessationOfOperation",r[r.certificateHold=64]="certificateHold",r[r.privilegeWithdrawn=128]="privilegeWithdrawn",r[r.aACompromise=256]="aACompromise"})(ve||(ve={}));class kc extends si{toJSON(){const e=[],t=this.toNumber();return t&ve.aACompromise&&e.push("aACompromise"),t&ve.affiliationChanged&&e.push("affiliationChanged"),t&ve.cACompromise&&e.push("cACompromise"),t&ve.certificateHold&&e.push("certificateHold"),t&ve.cessationOfOperation&&e.push("cessationOfOperation"),t&ve.keyCompromise&&e.push("keyCompromise"),t&ve.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&ve.superseded&&e.push("superseded"),t&ve.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let mt=class{constructor(e={}){Object.assign(this,e)}};s([a({type:U,context:0,repeated:"sequence",implicit:!0})],mt.prototype,"fullName",void 0);s([a({type:gt,context:1,implicit:!0})],mt.prototype,"nameRelativeToCRLIssuer",void 0);mt=s([B({type:A.Choice})],mt);class Yt{constructor(e={}){Object.assign(this,e)}}s([a({type:mt,context:0,optional:!0})],Yt.prototype,"distributionPoint",void 0);s([a({type:kc,context:1,optional:!0,implicit:!0})],Yt.prototype,"reasons",void 0);s([a({type:U,context:2,optional:!0,repeated:"sequence",implicit:!0})],Yt.prototype,"cRLIssuer",void 0);let Yi=Ji=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Ji.prototype)}};Yi=Ji=s([B({type:A.Sequence,itemType:Yt})],Yi);var Zi;let us=Zi=class extends Yi{constructor(e){super(e),Object.setPrototypeOf(this,Zi.prototype)}};us=Zi=s([B({type:A.Sequence,itemType:Yt})],us);class X{constructor(e={}){this.onlyContainsUserCerts=X.ONLY,this.onlyContainsCACerts=X.ONLY,this.indirectCRL=X.ONLY,this.onlyContainsAttributeCerts=X.ONLY,Object.assign(this,e)}}X.ONLY=!1;s([a({type:mt,context:0,optional:!0})],X.prototype,"distributionPoint",void 0);s([a({type:f.Boolean,context:1,defaultValue:X.ONLY,implicit:!0})],X.prototype,"onlyContainsUserCerts",void 0);s([a({type:f.Boolean,context:2,defaultValue:X.ONLY,implicit:!0})],X.prototype,"onlyContainsCACerts",void 0);s([a({type:kc,context:3,optional:!0,implicit:!0})],X.prototype,"onlySomeReasons",void 0);s([a({type:f.Boolean,context:4,defaultValue:X.ONLY,implicit:!0})],X.prototype,"indirectCRL",void 0);s([a({type:f.Boolean,context:5,defaultValue:X.ONLY,implicit:!0})],X.prototype,"onlyContainsAttributeCerts",void 0);var Dt;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})(Dt||(Dt={}));let Qi=class{constructor(e=Dt.unspecified){this.reason=Dt.unspecified,this.reason=e}toJSON(){return Dt[this.reason]}toString(){return this.toJSON()}};s([a({type:f.Enumerated})],Qi.prototype,"reason",void 0);Qi=s([B({type:A.Choice})],Qi);var Xi;const Ic=`${st}.37`;let Sr=Xi=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Xi.prototype)}};Sr=Xi=s([B({type:A.Sequence,itemType:f.ObjectIdentifier})],Sr);let en=class{constructor(e=new ArrayBuffer(0)){this.value=e}};s([a({type:f.Integer,converter:q})],en.prototype,"value",void 0);en=s([B({type:A.Choice})],en);let tn=class{constructor(e){this.value=new Date,e&&(this.value=e)}};s([a({type:f.GeneralizedTime})],tn.prototype,"value",void 0);tn=s([B({type:A.Choice})],tn);var rn;let fs=rn=class extends we{constructor(e){super(e),Object.setPrototypeOf(this,rn.prototype)}};fs=rn=s([B({type:A.Sequence})],fs);const Cc=`${st}.15`;var ge;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(ge||(ge={}));class hs extends si{toJSON(){const e=this.toNumber(),t=[];return e&ge.cRLSign&&t.push("crlSign"),e&ge.dataEncipherment&&t.push("dataEncipherment"),e&ge.decipherOnly&&t.push("decipherOnly"),e&ge.digitalSignature&&t.push("digitalSignature"),e&ge.encipherOnly&&t.push("encipherOnly"),e&ge.keyAgreement&&t.push("keyAgreement"),e&ge.keyCertSign&&t.push("keyCertSign"),e&ge.keyEncipherment&&t.push("keyEncipherment"),e&ge.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}var nn;class li{constructor(e={}){this.base=new U,this.minimum=0,Object.assign(this,e)}}s([a({type:U})],li.prototype,"base",void 0);s([a({type:f.Integer,context:0,defaultValue:0,implicit:!0})],li.prototype,"minimum",void 0);s([a({type:f.Integer,context:1,optional:!0,implicit:!0})],li.prototype,"maximum",void 0);let Br=nn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,nn.prototype)}};Br=nn=s([B({type:A.Sequence,itemType:li})],Br);class Ec{constructor(e={}){Object.assign(this,e)}}s([a({type:Br,context:0,optional:!0,implicit:!0})],Ec.prototype,"permittedSubtrees",void 0);s([a({type:Br,context:1,optional:!0,implicit:!0})],Ec.prototype,"excludedSubtrees",void 0);class Nc{constructor(e={}){Object.assign(this,e)}}s([a({type:f.Integer,context:0,implicit:!0,optional:!0,converter:q})],Nc.prototype,"requireExplicitPolicy",void 0);s([a({type:f.Integer,context:1,implicit:!0,optional:!0,converter:q})],Nc.prototype,"inhibitPolicyMapping",void 0);var on;class Ao{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],Ao.prototype,"issuerDomainPolicy",void 0);s([a({type:f.ObjectIdentifier})],Ao.prototype,"subjectDomainPolicy",void 0);let ps=on=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,on.prototype)}};ps=on=s([B({type:A.Sequence,itemType:Ao})],ps);var sn;const Oc=`${st}.17`;let xr=sn=class extends we{constructor(e){super(e),Object.setPrototypeOf(this,sn.prototype)}};xr=sn=s([B({type:A.Sequence})],xr);class _e{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],_e.prototype,"type",void 0);s([a({type:f.Any,repeated:"set"})],_e.prototype,"values",void 0);var an;let ds=an=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,an.prototype)}};ds=an=s([B({type:A.Sequence,itemType:_e})],ds);const Pc=`${st}.14`;class et extends go{}class Vc{constructor(e={}){Object.assign(this,e)}}s([a({type:f.GeneralizedTime,context:0,implicit:!0,optional:!0})],Vc.prototype,"notBefore",void 0);s([a({type:f.GeneralizedTime,context:1,implicit:!0,optional:!0})],Vc.prototype,"notAfter",void 0);var Ht;(function(r){r[r.keyUpdateAllowed=1]="keyUpdateAllowed",r[r.newExtensions=2]="newExtensions",r[r.pKIXCertificate=4]="pKIXCertificate"})(Ht||(Ht={}));class Tc extends si{toJSON(){const e=[],t=this.toNumber();return t&Ht.pKIXCertificate&&e.push("pKIXCertificate"),t&Ht.newExtensions&&e.push("newExtensions"),t&Ht.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class jc{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new Tc,Object.assign(this,e)}}s([a({type:f.GeneralString})],jc.prototype,"entrustVers",void 0);s([a({type:Tc})],jc.prototype,"entrustInfoFlags",void 0);var cn;let ys=cn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,cn.prototype)}};ys=cn=s([B({type:A.Sequence,itemType:ai})],ys);class P{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof P&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&Sa(e.parameters,this.parameters)||e.parameters===this.parameters)}}s([a({type:f.ObjectIdentifier})],P.prototype,"algorithm",void 0);s([a({type:f.Any,optional:!0})],P.prototype,"parameters",void 0);class qe{constructor(e={}){this.algorithm=new P,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:P})],qe.prototype,"algorithm",void 0);s([a({type:f.BitString})],qe.prototype,"subjectPublicKey",void 0);let ee=class{constructor(e){if(e)if(typeof e=="string"||typeof e=="number"||e instanceof Date){const t=new Date(e);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,e)}getTime(){const e=this.utcTime||this.generalTime;if(!e)throw new Error("Cannot get time from CHOICE object");return e}};s([a({type:f.UTCTime})],ee.prototype,"utcTime",void 0);s([a({type:f.GeneralizedTime})],ee.prototype,"generalTime",void 0);ee=s([B({type:A.Choice})],ee);class ui{constructor(e){this.notBefore=new ee(new Date),this.notAfter=new ee(new Date),e&&(this.notBefore=new ee(e.notBefore),this.notAfter=new ee(e.notAfter))}}s([a({type:ee})],ui.prototype,"notBefore",void 0);s([a({type:ee})],ui.prototype,"notAfter",void 0);var ln;class pe{constructor(e={}){this.extnID="",this.critical=pe.CRITICAL,this.extnValue=new D,Object.assign(this,e)}}pe.CRITICAL=!1;s([a({type:f.ObjectIdentifier})],pe.prototype,"extnID",void 0);s([a({type:f.Boolean,defaultValue:pe.CRITICAL})],pe.prototype,"critical",void 0);s([a({type:D})],pe.prototype,"extnValue",void 0);let tt=ln=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,ln.prototype)}};tt=ln=s([B({type:A.Sequence,itemType:pe})],tt);var kr;(function(r){r[r.v1=0]="v1",r[r.v2=1]="v2",r[r.v3=2]="v3"})(kr||(kr={}));class ye{constructor(e={}){this.version=kr.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new P,this.issuer=new J,this.validity=new ui,this.subject=new J,this.subjectPublicKeyInfo=new qe,Object.assign(this,e)}}s([a({type:f.Integer,context:0,defaultValue:kr.v1})],ye.prototype,"version",void 0);s([a({type:f.Integer,converter:q})],ye.prototype,"serialNumber",void 0);s([a({type:P})],ye.prototype,"signature",void 0);s([a({type:J})],ye.prototype,"issuer",void 0);s([a({type:ui})],ye.prototype,"validity",void 0);s([a({type:J})],ye.prototype,"subject",void 0);s([a({type:qe})],ye.prototype,"subjectPublicKeyInfo",void 0);s([a({type:f.BitString,context:1,implicit:!0,optional:!0})],ye.prototype,"issuerUniqueID",void 0);s([a({type:f.BitString,context:2,implicit:!0,optional:!0})],ye.prototype,"subjectUniqueID",void 0);s([a({type:tt,context:3,optional:!0})],ye.prototype,"extensions",void 0);class Zt{constructor(e={}){this.tbsCertificate=new ye,this.signatureAlgorithm=new P,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:ye})],Zt.prototype,"tbsCertificate",void 0);s([a({type:P})],Zt.prototype,"signatureAlgorithm",void 0);s([a({type:f.BitString})],Zt.prototype,"signatureValue",void 0);class fi{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new ee,Object.assign(this,e)}}s([a({type:f.Integer,converter:q})],fi.prototype,"userCertificate",void 0);s([a({type:ee})],fi.prototype,"revocationDate",void 0);s([a({type:pe,optional:!0,repeated:"sequence"})],fi.prototype,"crlEntryExtensions",void 0);class He{constructor(e={}){this.signature=new P,this.issuer=new J,this.thisUpdate=new ee,Object.assign(this,e)}}s([a({type:f.Integer,optional:!0})],He.prototype,"version",void 0);s([a({type:P})],He.prototype,"signature",void 0);s([a({type:J})],He.prototype,"issuer",void 0);s([a({type:ee})],He.prototype,"thisUpdate",void 0);s([a({type:ee,optional:!0})],He.prototype,"nextUpdate",void 0);s([a({type:fi,repeated:"sequence",optional:!0})],He.prototype,"revokedCertificates",void 0);s([a({type:pe,optional:!0,context:0,repeated:"sequence"})],He.prototype,"crlExtensions",void 0);class So{constructor(e={}){this.tbsCertList=new He,this.signatureAlgorithm=new P,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:He})],So.prototype,"tbsCertList",void 0);s([a({type:P})],So.prototype,"signatureAlgorithm",void 0);s([a({type:f.BitString})],So.prototype,"signature",void 0);const ce="1.2.840.113549.1.1",Ir=`${ce}.1`,fu=`${ce}.7`,hu=`${ce}.9`,pu=`${ce}.10`,du=`${ce}.2`,yu=`${ce}.4`,un=`${ce}.5`,vs=`${ce}.11`,fn=`${ce}.12`,hn=`${ce}.13`,_c=`${ce}.15`,Rc=`${ce}.16`,vu="1.3.14.3.2.26",gu="2.16.840.1.101.3.4.2.4",mu="2.16.840.1.101.3.4.2.1",wu="2.16.840.1.101.3.4.2.2",bu="2.16.840.1.101.3.4.2.3",Au="2.16.840.1.101.3.4.2.5",Su="2.16.840.1.101.3.4.2.6",Bu="1.2.840.113549.2.2",xu="1.2.840.113549.2.5",Bo=`${ce}.8`;function K(r){return new P({algorithm:r,parameters:null})}K(Bu);K(xu);const rt=K(vu);K(gu);K(mu);K(wu);K(bu);K(Au);K(Su);const Uc=new P({algorithm:Bo,parameters:j.serialize(rt)}),Dc=new P({algorithm:hu,parameters:j.serialize(gr.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});K(Ir);K(du);K(yu);K(un);K(_c);K(Rc);K(fn);K(hn);K(_c);K(Rc);class hi{constructor(e={}){this.hashAlgorithm=new P(rt),this.maskGenAlgorithm=new P({algorithm:Bo,parameters:j.serialize(rt)}),this.pSourceAlgorithm=new P(Dc),Object.assign(this,e)}}s([a({type:P,context:0,defaultValue:rt})],hi.prototype,"hashAlgorithm",void 0);s([a({type:P,context:1,defaultValue:Uc})],hi.prototype,"maskGenAlgorithm",void 0);s([a({type:P,context:2,defaultValue:Dc})],hi.prototype,"pSourceAlgorithm",void 0);new P({algorithm:fu,parameters:j.serialize(new hi)});class Qt{constructor(e={}){this.hashAlgorithm=new P(rt),this.maskGenAlgorithm=new P({algorithm:Bo,parameters:j.serialize(rt)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}s([a({type:P,context:0,defaultValue:rt})],Qt.prototype,"hashAlgorithm",void 0);s([a({type:P,context:1,defaultValue:Uc})],Qt.prototype,"maskGenAlgorithm",void 0);s([a({type:f.Integer,context:2,defaultValue:20})],Qt.prototype,"saltLength",void 0);s([a({type:f.Integer,context:3,defaultValue:1})],Qt.prototype,"trailerField",void 0);new P({algorithm:pu,parameters:j.serialize(new Qt)});class pi{constructor(e={}){this.digestAlgorithm=new P,this.digest=new D,Object.assign(this,e)}}s([a({type:P})],pi.prototype,"digestAlgorithm",void 0);s([a({type:D})],pi.prototype,"digest",void 0);var pn;class di{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.Integer,converter:q})],di.prototype,"prime",void 0);s([a({type:f.Integer,converter:q})],di.prototype,"exponent",void 0);s([a({type:f.Integer,converter:q})],di.prototype,"coefficient",void 0);let dn=pn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,pn.prototype)}};dn=pn=s([B({type:A.Sequence,itemType:di})],dn);class Ce{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.Integer})],Ce.prototype,"version",void 0);s([a({type:f.Integer,converter:q})],Ce.prototype,"modulus",void 0);s([a({type:f.Integer,converter:q})],Ce.prototype,"publicExponent",void 0);s([a({type:f.Integer,converter:q})],Ce.prototype,"privateExponent",void 0);s([a({type:f.Integer,converter:q})],Ce.prototype,"prime1",void 0);s([a({type:f.Integer,converter:q})],Ce.prototype,"prime2",void 0);s([a({type:f.Integer,converter:q})],Ce.prototype,"exponent1",void 0);s([a({type:f.Integer,converter:q})],Ce.prototype,"exponent2",void 0);s([a({type:f.Integer,converter:q})],Ce.prototype,"coefficient",void 0);s([a({type:dn,optional:!0})],Ce.prototype,"otherPrimeInfos",void 0);class xo{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.Integer,converter:q})],xo.prototype,"modulus",void 0);s([a({type:f.Integer,converter:q})],xo.prototype,"publicExponent",void 0);var yn;(function(r){r[r.Transient=0]="Transient",r[r.Singleton=1]="Singleton",r[r.ResolutionScoped=2]="ResolutionScoped",r[r.ContainerScoped=3]="ContainerScoped"})(yn||(yn={}));const re=yn;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var vn=function(r,e){return vn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},vn(r,e)};function ko(r,e){vn(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function ku(r,e,t,i){function n(o){return o instanceof t?o:new t(function(c){c(o)})}return new(t||(t=Promise))(function(o,c){function l(w){try{p(i.next(w))}catch(b){c(b)}}function u(w){try{p(i.throw(w))}catch(b){c(b)}}function p(w){w.done?o(w.value):n(w.value).then(l,u)}p((i=i.apply(r,e||[])).next())})}function Iu(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,n,o,c;return c={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function l(p){return function(w){return u([p,w])}}function u(p){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,n&&(o=p[0]&2?n.return:p[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,p[1])).done)return o;switch(n=0,o&&(p=[p[0]&2,o.value]),p[0]){case 0:case 1:o=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,n=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!o||p[1]>o[0]&&p[1]<o[3])){t.label=p[1];break}if(p[0]===6&&t.label<o[1]){t.label=o[1],o=p;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(p);break}o[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(r,t)}catch(w){p=[6,w],n=0}finally{i=o=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function fr(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cr(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),n,o=[],c;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(l){c={error:l}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(c)throw c.error}}return o}function Ke(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(Cr(arguments[e]));return r}var Cu="injectionTokens";function Eu(r){var e=Reflect.getMetadata("design:paramtypes",r)||[],t=Reflect.getOwnMetadata(Cu,r)||{};return Object.keys(t).forEach(function(i){e[+i]=t[i]}),e}function Hc(r){return!!r.useClass}function gn(r){return!!r.useFactory}var Mc=function(){function r(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return r.prototype.createProxy=function(e){var t=this,i={},n=!1,o,c=function(){return n||(o=e(t.wrap()),n=!0),o};return new Proxy(i,this.createHandler(c))},r.prototype.createHandler=function(e){var t={},i=function(n){t[n]=function(){for(var o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];o[0]=e();var l=Reflect[n];return l.apply(void 0,Ke(o))}};return this.reflectMethods.forEach(i),t},r}();function ft(r){return typeof r=="string"||typeof r=="symbol"}function Nu(r){return typeof r=="object"&&"token"in r&&"multiple"in r}function gs(r){return typeof r=="object"&&"token"in r&&"transform"in r}function Ou(r){return typeof r=="function"||r instanceof Mc}function hr(r){return!!r.useToken}function pr(r){return r.useValue!=null}function Pu(r){return Hc(r)||pr(r)||hr(r)||gn(r)}var Io=function(){function r(){this._registryMap=new Map}return r.prototype.entries=function(){return this._registryMap.entries()},r.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},r.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},r.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},r.prototype.setAll=function(e,t){this._registryMap.set(e,t)},r.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},r.prototype.clear=function(){this._registryMap.clear()},r.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},r}(),Vu=function(r){ko(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e}(Io),ms=function(){function r(){this.scopedResolutions=new Map}return r}();function Tu(r,e){if(r===null)return"at position #"+e;var t=r.split(",")[e].trim();return'"'+t+'" at position #'+e}function ju(r,e,t){return t===void 0&&(t="    "),Ke([r],e.message.split(`
`).map(function(i){return t+i})).join(`
`)}function _u(r,e,t){var i=Cr(r.toString().match(/constructor\(([\w, ]+)\)/)||[],2),n=i[1],o=n===void 0?null:n,c=Tu(o,e);return ju("Cannot inject the dependency "+c+' of "'+r.name+'" constructor. Reason:',t)}function Ru(r){if(typeof r.dispose!="function")return!1;var e=r.dispose;return!(e.length>0)}var Uu=function(r){ko(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e}(Io),Du=function(r){ko(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e}(Io),Hu=function(){function r(){this.preResolution=new Uu,this.postResolution=new Du}return r}(),$c=new Map,Mu=function(){function r(e){this.parent=e,this._registry=new Vu,this.interceptors=new Hu,this.disposed=!1,this.disposables=new Set}return r.prototype.register=function(e,t,i){i===void 0&&(i={lifecycle:re.Transient}),this.ensureNotDisposed();var n;if(Pu(t)?n=t:n={useClass:t},hr(n))for(var o=[e],c=n;c!=null;){var l=c.useToken;if(o.includes(l))throw new Error("Token registration cycle detected! "+Ke(o,[l]).join(" -> "));o.push(l);var u=this._registry.get(l);u&&hr(u.provider)?c=u.provider:c=null}if((i.lifecycle===re.Singleton||i.lifecycle==re.ContainerScoped||i.lifecycle==re.ResolutionScoped)&&(pr(n)||gn(n)))throw new Error('Cannot use lifecycle "'+re[i.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:n,options:i}),this},r.prototype.registerType=function(e,t){return this.ensureNotDisposed(),ft(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},r.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},r.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),ft(e)){if(ft(t))return this.register(e,{useToken:t},{lifecycle:re.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:re.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var i=e;return t&&!ft(t)&&(i=t),this.register(e,{useClass:i},{lifecycle:re.Singleton})},r.prototype.resolve=function(e,t){t===void 0&&(t=new ms),this.ensureNotDisposed();var i=this.getRegistration(e);if(!i&&ft(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),i){var n=this.resolveRegistration(i,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if(Ou(e)){var n=this.construct(e,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},r.prototype.executePreResolutionInterceptor=function(e,t){var i,n;if(this.interceptors.preResolution.has(e)){var o=[];try{for(var c=fr(this.interceptors.preResolution.getAll(e)),l=c.next();!l.done;l=c.next()){var u=l.value;u.options.frequency!="Once"&&o.push(u),u.callback(e,t)}}catch(p){i={error:p}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(i)throw i.error}}this.interceptors.preResolution.setAll(e,o)}},r.prototype.executePostResolutionInterceptor=function(e,t,i){var n,o;if(this.interceptors.postResolution.has(e)){var c=[];try{for(var l=fr(this.interceptors.postResolution.getAll(e)),u=l.next();!u.done;u=l.next()){var p=u.value;p.options.frequency!="Once"&&c.push(p),p.callback(e,t,i)}}catch(w){n={error:w}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,c)}},r.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===re.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var i=e.options.lifecycle===re.Singleton,n=e.options.lifecycle===re.ContainerScoped,o=i||n,c;return pr(e.provider)?c=e.provider.useValue:hr(e.provider)?c=o?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):Hc(e.provider)?c=o?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):gn(e.provider)?c=e.provider.useFactory(this):c=this.construct(e.provider,t),e.options.lifecycle===re.ResolutionScoped&&t.scopedResolutions.set(e,c),c},r.prototype.resolveAll=function(e,t){var i=this;t===void 0&&(t=new ms),this.ensureNotDisposed();var n=this.getAllRegistrations(e);if(!n&&ft(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),n){var o=n.map(function(l){return i.resolveRegistration(l,t)});return this.executePostResolutionInterceptor(e,o,"All"),o}var c=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,c,"All"),c},r.prototype.isRegistered=function(e,t){return t===void 0&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},r.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},r.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var i=fr(this._registry.entries()),n=i.next();!n.done;n=i.next()){var o=Cr(n.value,2),c=o[0],l=o[1];this._registry.setAll(c,l.filter(function(u){return!pr(u.provider)}).map(function(u){return u.instance=void 0,u}))}}catch(u){e={error:u}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},r.prototype.createChildContainer=function(){var e,t;this.ensureNotDisposed();var i=new r(this);try{for(var n=fr(this._registry.entries()),o=n.next();!o.done;o=n.next()){var c=Cr(o.value,2),l=c[0],u=c[1];u.some(function(p){var w=p.options;return w.lifecycle===re.ContainerScoped})&&i._registry.setAll(l,u.map(function(p){return p.options.lifecycle===re.ContainerScoped?{provider:p.provider,options:p.options}:p}))}}catch(p){e={error:p}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return i},r.prototype.beforeResolution=function(e,t,i){i===void 0&&(i={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:i})},r.prototype.afterResolution=function(e,t,i){i===void 0&&(i={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:i})},r.prototype.dispose=function(){return ku(this,void 0,void 0,function(){var e;return Iu(this,function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach(function(i){var n=i.dispose();n&&e.push(n)}),[4,Promise.all(e)];case 1:return t.sent(),[2]}})})},r.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},r.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},r.prototype.construct=function(e,t){var i=this;if(e instanceof Mc)return e.createProxy(function(o){return i.resolve(o,t)});var n=function(){var o=$c.get(e);if(!o||o.length===0){if(e.length===0)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var c=o.map(i.resolveParams(t,e));return new(e.bind.apply(e,Ke([void 0],c)))}();return Ru(n)&&this.disposables.add(n),n},r.prototype.resolveParams=function(e,t){var i=this;return function(n,o){var c,l,u;try{return Nu(n)?gs(n)?n.multiple?(c=i.resolve(n.transform)).transform.apply(c,Ke([i.resolveAll(n.token)],n.transformArgs)):(l=i.resolve(n.transform)).transform.apply(l,Ke([i.resolve(n.token,e)],n.transformArgs)):n.multiple?i.resolveAll(n.token):i.resolve(n.token,e):gs(n)?(u=i.resolve(n.transform,e)).transform.apply(u,Ke([i.resolve(n.token,e)],n.transformArgs)):i.resolve(n,e)}catch(p){throw new Error(_u(t,o,p))}}},r.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},r}(),xe=new Mu;function Co(){return function(r){$c.set(r,Eu(r))}}if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error(`tsyringe requires a reflect polyfill. Please add 'import "reflect-metadata"' to the top of your entry point.`);class Ct{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],Ct.prototype,"attrType",void 0);s([a({type:f.Any,repeated:"set"})],Ct.prototype,"attrValues",void 0);class Eo{constructor(e={}){this.acIssuer=new U,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}s([a({type:U})],Eo.prototype,"acIssuer",void 0);s([a({type:f.Integer})],Eo.prototype,"acSerial",void 0);s([a({type:_e,repeated:"sequence"})],Eo.prototype,"attrs",void 0);var mn;let Er=mn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,mn.prototype)}};Er=mn=s([B({type:A.Sequence,itemType:f.ObjectIdentifier})],Er);class yi{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}s([a({type:f.Integer,optional:!0})],yi.prototype,"pathLenConstraint",void 0);s([a({type:Er,implicit:!0,context:0,optional:!0})],yi.prototype,"permittedAttrs",void 0);s([a({type:Er,implicit:!0,context:1,optional:!0})],yi.prototype,"excludedAttrs",void 0);s([a({type:f.Boolean,defaultValue:!0})],yi.prototype,"permitUnSpecified",void 0);class at{constructor(e={}){this.issuer=new we,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:we})],at.prototype,"issuer",void 0);s([a({type:f.Integer,converter:q})],at.prototype,"serial",void 0);s([a({type:f.BitString,optional:!0})],at.prototype,"issuerUID",void 0);var wn;(function(r){r[r.publicKey=0]="publicKey",r[r.publicKeyCert=1]="publicKeyCert",r[r.otherObjectTypes=2]="otherObjectTypes"})(wn||(wn={}));class ct{constructor(e={}){this.digestedObjectType=wn.publicKey,this.digestAlgorithm=new P,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.Enumerated})],ct.prototype,"digestedObjectType",void 0);s([a({type:f.ObjectIdentifier,optional:!0})],ct.prototype,"otherObjectTypeID",void 0);s([a({type:P})],ct.prototype,"digestAlgorithm",void 0);s([a({type:f.BitString})],ct.prototype,"objectDigest",void 0);class vi{constructor(e={}){Object.assign(this,e)}}s([a({type:we,optional:!0})],vi.prototype,"issuerName",void 0);s([a({type:at,context:0,implicit:!0,optional:!0})],vi.prototype,"baseCertificateID",void 0);s([a({type:ct,context:1,implicit:!0,optional:!0})],vi.prototype,"objectDigestInfo",void 0);let wt=class{constructor(e={}){Object.assign(this,e)}};s([a({type:U,repeated:"sequence"})],wt.prototype,"v1Form",void 0);s([a({type:vi,context:0,implicit:!0})],wt.prototype,"v2Form",void 0);wt=s([B({type:A.Choice})],wt);class gi{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}s([a({type:f.GeneralizedTime})],gi.prototype,"notBeforeTime",void 0);s([a({type:f.GeneralizedTime})],gi.prototype,"notAfterTime",void 0);class Xt{constructor(e={}){Object.assign(this,e)}}s([a({type:at,implicit:!0,context:0,optional:!0})],Xt.prototype,"baseCertificateID",void 0);s([a({type:we,implicit:!0,context:1,optional:!0})],Xt.prototype,"entityName",void 0);s([a({type:ct,implicit:!0,context:2,optional:!0})],Xt.prototype,"objectDigestInfo",void 0);var bn;(function(r){r[r.v2=1]="v2"})(bn||(bn={}));class Ae{constructor(e={}){this.version=bn.v2,this.holder=new Xt,this.issuer=new wt,this.signature=new P,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new gi,this.attributes=[],Object.assign(this,e)}}s([a({type:f.Integer})],Ae.prototype,"version",void 0);s([a({type:Xt})],Ae.prototype,"holder",void 0);s([a({type:wt})],Ae.prototype,"issuer",void 0);s([a({type:P})],Ae.prototype,"signature",void 0);s([a({type:f.Integer,converter:q})],Ae.prototype,"serialNumber",void 0);s([a({type:gi})],Ae.prototype,"attrCertValidityPeriod",void 0);s([a({type:_e,repeated:"sequence"})],Ae.prototype,"attributes",void 0);s([a({type:f.BitString,optional:!0})],Ae.prototype,"issuerUniqueID",void 0);s([a({type:tt,optional:!0})],Ae.prototype,"extensions",void 0);class mi{constructor(e={}){this.acinfo=new Ae,this.signatureAlgorithm=new P,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:Ae})],mi.prototype,"acinfo",void 0);s([a({type:P})],mi.prototype,"signatureAlgorithm",void 0);s([a({type:f.BitString})],mi.prototype,"signatureValue",void 0);var Nr;(function(r){r[r.unmarked=1]="unmarked",r[r.unclassified=2]="unclassified",r[r.restricted=4]="restricted",r[r.confidential=8]="confidential",r[r.secret=16]="secret",r[r.topSecret=32]="topSecret"})(Nr||(Nr={}));class An extends si{}class No{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier,implicit:!0,context:0})],No.prototype,"type",void 0);s([a({type:f.Any,implicit:!0,context:1})],No.prototype,"value",void 0);class Oo{constructor(e={}){this.policyId="",this.classList=new An(Nr.unclassified),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],Oo.prototype,"policyId",void 0);s([a({type:An,defaultValue:new An(Nr.unclassified)})],Oo.prototype,"classList",void 0);s([a({type:No,repeated:"set"})],Oo.prototype,"securityCategories",void 0);class wi{constructor(e={}){Object.assign(this,e)}}s([a({type:D})],wi.prototype,"cotets",void 0);s([a({type:f.ObjectIdentifier})],wi.prototype,"oid",void 0);s([a({type:f.Utf8String})],wi.prototype,"string",void 0);class Lc{constructor(e={}){this.values=[],Object.assign(this,e)}}s([a({type:we,implicit:!0,context:0,optional:!0})],Lc.prototype,"policyAuthority",void 0);s([a({type:wi,repeated:"sequence"})],Lc.prototype,"values",void 0);var Sn;class bi{constructor(e={}){this.targetCertificate=new at,Object.assign(this,e)}}s([a({type:at})],bi.prototype,"targetCertificate",void 0);s([a({type:U,optional:!0})],bi.prototype,"targetName",void 0);s([a({type:ct,optional:!0})],bi.prototype,"certDigestInfo",void 0);let bt=class{constructor(e={}){Object.assign(this,e)}};s([a({type:U,context:0,implicit:!0})],bt.prototype,"targetName",void 0);s([a({type:U,context:1,implicit:!0})],bt.prototype,"targetGroup",void 0);s([a({type:bi,context:2,implicit:!0})],bt.prototype,"targetCert",void 0);bt=s([B({type:A.Choice})],bt);let Bn=Sn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Sn.prototype)}};Bn=Sn=s([B({type:A.Sequence,itemType:bt})],Bn);var xn;let ws=xn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,xn.prototype)}};ws=xn=s([B({type:A.Sequence,itemType:Bn})],ws);class Fc{constructor(e={}){Object.assign(this,e)}}s([a({type:we,implicit:!0,context:0,optional:!0})],Fc.prototype,"roleAuthority",void 0);s([a({type:U,implicit:!0,context:1})],Fc.prototype,"roleName",void 0);class Po{constructor(e={}){this.service=new U,this.ident=new U,Object.assign(this,e)}}s([a({type:U})],Po.prototype,"service",void 0);s([a({type:U})],Po.prototype,"ident",void 0);s([a({type:D,optional:!0})],Po.prototype,"authInfo",void 0);var kn;class Vo{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],Vo.prototype,"otherCertFormat",void 0);s([a({type:f.Any})],Vo.prototype,"otherCert",void 0);let At=class{constructor(e={}){Object.assign(this,e)}};s([a({type:Zt})],At.prototype,"certificate",void 0);s([a({type:mi,context:2,implicit:!0})],At.prototype,"v2AttrCert",void 0);s([a({type:Vo,context:3,implicit:!0})],At.prototype,"other",void 0);At=s([B({type:A.Choice})],At);let Or=kn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,kn.prototype)}};Or=kn=s([B({type:A.Set,itemType:At})],Or);class Et{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],Et.prototype,"contentType",void 0);s([a({type:f.Any,context:0})],Et.prototype,"content",void 0);let Ft=class{constructor(e={}){Object.assign(this,e)}};s([a({type:D})],Ft.prototype,"single",void 0);s([a({type:f.Any})],Ft.prototype,"any",void 0);Ft=s([B({type:A.Choice})],Ft);class Ai{constructor(e={}){this.eContentType="",Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],Ai.prototype,"eContentType",void 0);s([a({type:Ft,context:0,optional:!0})],Ai.prototype,"eContent",void 0);var Re;(function(r){r[r.v0=0]="v0",r[r.v1=1]="v1",r[r.v2=2]="v2",r[r.v3=3]="v3",r[r.v4=4]="v4",r[r.v5=5]="v5"})(Re||(Re={}));let qt=class extends P{};qt=s([B({type:A.Sequence})],qt);let Pr=class extends P{};Pr=s([B({type:A.Sequence})],Pr);let ke=class extends P{};ke=s([B({type:A.Sequence})],ke);let Vr=class extends P{};Vr=s([B({type:A.Sequence})],Vr);let bs=class extends P{};bs=s([B({type:A.Sequence})],bs);let In=class extends P{};In=s([B({type:A.Sequence})],In);let zt=class{constructor(e={}){Object.assign(this,e)}};s([a({type:D,context:0,implicit:!0,optional:!0})],zt.prototype,"value",void 0);s([a({type:D,converter:Gl,context:0,implicit:!0,optional:!0,repeated:"sequence"})],zt.prototype,"constructedValue",void 0);zt=s([B({type:A.Choice})],zt);class er{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new Vr,Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],er.prototype,"contentType",void 0);s([a({type:Vr})],er.prototype,"contentEncryptionAlgorithm",void 0);s([a({type:zt,optional:!0})],er.prototype,"encryptedContent",void 0);class Nt{constructor(e={}){this.issuer=new J,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:J})],Nt.prototype,"issuer",void 0);s([a({type:f.Integer,converter:q})],Nt.prototype,"serialNumber",void 0);class Si{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],Si.prototype,"keyAttrId",void 0);s([a({type:f.Any,optional:!0})],Si.prototype,"keyAttr",void 0);var Cn;class Bi{constructor(e={}){this.subjectKeyIdentifier=new et,Object.assign(this,e)}}s([a({type:et})],Bi.prototype,"subjectKeyIdentifier",void 0);s([a({type:f.GeneralizedTime,optional:!0})],Bi.prototype,"date",void 0);s([a({type:Si,optional:!0})],Bi.prototype,"other",void 0);let St=class{constructor(e={}){Object.assign(this,e)}};s([a({type:Bi,context:0,implicit:!0,optional:!0})],St.prototype,"rKeyId",void 0);s([a({type:Nt,optional:!0})],St.prototype,"issuerAndSerialNumber",void 0);St=s([B({type:A.Choice})],St);class To{constructor(e={}){this.rid=new St,this.encryptedKey=new D,Object.assign(this,e)}}s([a({type:St})],To.prototype,"rid",void 0);s([a({type:D})],To.prototype,"encryptedKey",void 0);let Tr=Cn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Cn.prototype)}};Tr=Cn=s([B({type:A.Sequence,itemType:To})],Tr);class jo{constructor(e={}){this.algorithm=new P,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:P})],jo.prototype,"algorithm",void 0);s([a({type:f.BitString})],jo.prototype,"publicKey",void 0);let it=class{constructor(e={}){Object.assign(this,e)}};s([a({type:et,context:0,implicit:!0,optional:!0})],it.prototype,"subjectKeyIdentifier",void 0);s([a({type:jo,context:1,implicit:!0,optional:!0})],it.prototype,"originatorKey",void 0);s([a({type:Nt,optional:!0})],it.prototype,"issuerAndSerialNumber",void 0);it=s([B({type:A.Choice})],it);class Ot{constructor(e={}){this.version=Re.v3,this.originator=new it,this.keyEncryptionAlgorithm=new ke,this.recipientEncryptedKeys=new Tr,Object.assign(this,e)}}s([a({type:f.Integer})],Ot.prototype,"version",void 0);s([a({type:it,context:0})],Ot.prototype,"originator",void 0);s([a({type:D,context:1,optional:!0})],Ot.prototype,"ukm",void 0);s([a({type:ke})],Ot.prototype,"keyEncryptionAlgorithm",void 0);s([a({type:Tr})],Ot.prototype,"recipientEncryptedKeys",void 0);let Bt=class{constructor(e={}){Object.assign(this,e)}};s([a({type:et,context:0,implicit:!0})],Bt.prototype,"subjectKeyIdentifier",void 0);s([a({type:Nt})],Bt.prototype,"issuerAndSerialNumber",void 0);Bt=s([B({type:A.Choice})],Bt);class tr{constructor(e={}){this.version=Re.v0,this.rid=new Bt,this.keyEncryptionAlgorithm=new ke,this.encryptedKey=new D,Object.assign(this,e)}}s([a({type:f.Integer})],tr.prototype,"version",void 0);s([a({type:Bt})],tr.prototype,"rid",void 0);s([a({type:ke})],tr.prototype,"keyEncryptionAlgorithm",void 0);s([a({type:D})],tr.prototype,"encryptedKey",void 0);class rr{constructor(e={}){this.keyIdentifier=new D,Object.assign(this,e)}}s([a({type:D})],rr.prototype,"keyIdentifier",void 0);s([a({type:f.GeneralizedTime,optional:!0})],rr.prototype,"date",void 0);s([a({type:Si,optional:!0})],rr.prototype,"other",void 0);class ir{constructor(e={}){this.version=Re.v4,this.kekid=new rr,this.keyEncryptionAlgorithm=new ke,this.encryptedKey=new D,Object.assign(this,e)}}s([a({type:f.Integer})],ir.prototype,"version",void 0);s([a({type:rr})],ir.prototype,"kekid",void 0);s([a({type:ke})],ir.prototype,"keyEncryptionAlgorithm",void 0);s([a({type:D})],ir.prototype,"encryptedKey",void 0);class nr{constructor(e={}){this.version=Re.v0,this.keyEncryptionAlgorithm=new ke,this.encryptedKey=new D,Object.assign(this,e)}}s([a({type:f.Integer})],nr.prototype,"version",void 0);s([a({type:In,context:0,optional:!0})],nr.prototype,"keyDerivationAlgorithm",void 0);s([a({type:ke})],nr.prototype,"keyEncryptionAlgorithm",void 0);s([a({type:D})],nr.prototype,"encryptedKey",void 0);class _o{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],_o.prototype,"oriType",void 0);s([a({type:f.Any})],_o.prototype,"oriValue",void 0);let ze=class{constructor(e={}){Object.assign(this,e)}};s([a({type:tr,optional:!0})],ze.prototype,"ktri",void 0);s([a({type:Ot,context:1,implicit:!0,optional:!0})],ze.prototype,"kari",void 0);s([a({type:ir,context:2,implicit:!0,optional:!0})],ze.prototype,"kekri",void 0);s([a({type:nr,context:3,implicit:!0,optional:!0})],ze.prototype,"pwri",void 0);s([a({type:_o,context:4,implicit:!0,optional:!0})],ze.prototype,"ori",void 0);ze=s([B({type:A.Choice})],ze);var En;let jr=En=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,En.prototype)}};jr=En=s([B({type:A.Set,itemType:ze})],jr);var Nn;class xi{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],xi.prototype,"otherRevInfoFormat",void 0);s([a({type:f.Any})],xi.prototype,"otherRevInfo",void 0);let Gt=class{constructor(e={}){this.other=new xi,Object.assign(this,e)}};s([a({type:xi,context:1,implicit:!0})],Gt.prototype,"other",void 0);Gt=s([B({type:A.Choice})],Gt);let On=Nn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Nn.prototype)}};On=Nn=s([B({type:A.Set,itemType:Gt})],On);class Ro{constructor(e={}){Object.assign(this,e)}}s([a({type:Or,context:0,implicit:!0,optional:!0})],Ro.prototype,"certs",void 0);s([a({type:On,context:1,implicit:!0,optional:!0})],Ro.prototype,"crls",void 0);var Pn;let Vn=Pn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Pn.prototype)}};Vn=Pn=s([B({type:A.Set,itemType:Ct})],Vn);class or{constructor(e={}){this.version=Re.v0,this.recipientInfos=new jr,this.encryptedContentInfo=new er,Object.assign(this,e)}}s([a({type:f.Integer})],or.prototype,"version",void 0);s([a({type:Ro,context:0,implicit:!0,optional:!0})],or.prototype,"originatorInfo",void 0);s([a({type:jr})],or.prototype,"recipientInfos",void 0);s([a({type:er})],or.prototype,"encryptedContentInfo",void 0);s([a({type:Vn,context:1,implicit:!0,optional:!0})],or.prototype,"unprotectedAttrs",void 0);let xt=class{constructor(e={}){Object.assign(this,e)}};s([a({type:et,context:0,implicit:!0})],xt.prototype,"subjectKeyIdentifier",void 0);s([a({type:Nt})],xt.prototype,"issuerAndSerialNumber",void 0);xt=s([B({type:A.Choice})],xt);var Tn;class Me{constructor(e={}){this.version=Re.v0,this.sid=new xt,this.digestAlgorithm=new qt,this.signatureAlgorithm=new Pr,this.signature=new D,Object.assign(this,e)}}s([a({type:f.Integer})],Me.prototype,"version",void 0);s([a({type:xt})],Me.prototype,"sid",void 0);s([a({type:qt})],Me.prototype,"digestAlgorithm",void 0);s([a({type:Ct,repeated:"set",context:0,implicit:!0,optional:!0})],Me.prototype,"signedAttrs",void 0);s([a({type:Pr})],Me.prototype,"signatureAlgorithm",void 0);s([a({type:D})],Me.prototype,"signature",void 0);s([a({type:Ct,repeated:"set",context:1,implicit:!0,optional:!0})],Me.prototype,"unsignedAttrs",void 0);let _r=Tn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Tn.prototype)}};_r=Tn=s([B({type:A.Set,itemType:Me})],_r);var jn;let Rr=jn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,jn.prototype)}};Rr=jn=s([B({type:A.Set,itemType:qt})],Rr);class Pt{constructor(e={}){this.version=Re.v0,this.digestAlgorithms=new Rr,this.encapContentInfo=new Ai,this.signerInfos=new _r,Object.assign(this,e)}}s([a({type:f.Integer})],Pt.prototype,"version",void 0);s([a({type:Rr})],Pt.prototype,"digestAlgorithms",void 0);s([a({type:Ai})],Pt.prototype,"encapContentInfo",void 0);s([a({type:Or,context:0,implicit:!0,optional:!0})],Pt.prototype,"certificates",void 0);s([a({type:Gt,context:1,implicit:!0,optional:!0})],Pt.prototype,"crls",void 0);s([a({type:_r})],Pt.prototype,"signerInfos",void 0);var _n;class ki{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}s([a({type:f.ObjectIdentifier})],ki.prototype,"attrId",void 0);s([a({type:f.Any,repeated:"set"})],ki.prototype,"attrValues",void 0);let As=_n=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,_n.prototype)}};As=_n=s([B({type:A.Sequence,itemType:ki})],As);var Rn;let Ss=Rn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Rn.prototype)}};Ss=Rn=s([B({type:A.Sequence,itemType:Et})],Ss);class qc{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],qc.prototype,"certId",void 0);s([a({type:f.Any,context:0})],qc.prototype,"certValue",void 0);class zc{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],zc.prototype,"crlId",void 0);s([a({type:f.Any,context:0})],zc.prototype,"crltValue",void 0);class Gc extends D{}class Ii{constructor(e={}){this.encryptionAlgorithm=new P,this.encryptedData=new Gc,Object.assign(this,e)}}s([a({type:P})],Ii.prototype,"encryptionAlgorithm",void 0);s([a({type:Gc})],Ii.prototype,"encryptedData",void 0);var Un,Dn;(function(r){r[r.v1=0]="v1"})(Dn||(Dn={}));class Kc extends D{}let Hn=Un=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Un.prototype)}};Hn=Un=s([B({type:A.Sequence,itemType:_e})],Hn);class sr{constructor(e={}){this.version=Dn.v1,this.privateKeyAlgorithm=new P,this.privateKey=new Kc,Object.assign(this,e)}}s([a({type:f.Integer})],sr.prototype,"version",void 0);s([a({type:P})],sr.prototype,"privateKeyAlgorithm",void 0);s([a({type:Kc})],sr.prototype,"privateKey",void 0);s([a({type:Hn,implicit:!0,context:0,optional:!0})],sr.prototype,"attributes",void 0);let Bs=class extends sr{};Bs=s([B({type:A.Sequence})],Bs);let xs=class extends Ii{};xs=s([B({type:A.Sequence})],xs);class Wc{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],Wc.prototype,"secretTypeId",void 0);s([a({type:f.Any,context:0})],Wc.prototype,"secretValue",void 0);class ar{constructor(e={}){this.mac=new pi,this.macSalt=new D,this.iterations=1,Object.assign(this,e)}}s([a({type:pi})],ar.prototype,"mac",void 0);s([a({type:D})],ar.prototype,"macSalt",void 0);s([a({type:f.Integer,defaultValue:1})],ar.prototype,"iterations",void 0);class Ci{constructor(e={}){this.version=3,this.authSafe=new Et,this.macData=new ar,Object.assign(this,e)}}s([a({type:f.Integer})],Ci.prototype,"version",void 0);s([a({type:Et})],Ci.prototype,"authSafe",void 0);s([a({type:ar,optional:!0})],Ci.prototype,"macData",void 0);var Mn;class Ei{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.ObjectIdentifier})],Ei.prototype,"bagId",void 0);s([a({type:f.Any,context:0})],Ei.prototype,"bagValue",void 0);s([a({type:ki,repeated:"set",optional:!0})],Ei.prototype,"bagAttributes",void 0);let ks=Mn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Mn.prototype)}};ks=Mn=s([B({type:A.Sequence,itemType:Ei})],ks);var $n,Ln,Fn;const Jc="1.2.840.113549.1.9",Yc=`${Jc}.7`,Zc=`${Jc}.14`;let Ur=class extends Q{constructor(e={}){super(e)}toString(){return this.ia5String||super.toString()}};s([a({type:f.IA5String})],Ur.prototype,"ia5String",void 0);Ur=s([B({type:A.Choice})],Ur);let Is=class extends Et{};Is=s([B({type:A.Sequence})],Is);let Cs=class extends Ci{};Cs=s([B({type:A.Sequence})],Cs);let Es=class extends Ii{};Es=s([B({type:A.Sequence})],Es);let qn=class{constructor(e=""){this.value=e}toString(){return this.value}};s([a({type:f.IA5String})],qn.prototype,"value",void 0);qn=s([B({type:A.Choice})],qn);let Ns=class extends Ur{};Ns=s([B({type:A.Choice})],Ns);let Os=class extends Q{};Os=s([B({type:A.Choice})],Os);let zn=class{constructor(e=new Date){this.value=e}};s([a({type:f.GeneralizedTime})],zn.prototype,"value",void 0);zn=s([B({type:A.Choice})],zn);let Ps=class extends Q{};Ps=s([B({type:A.Choice})],Ps);let Gn=class{constructor(e="M"){this.value=e}toString(){return this.value}};s([a({type:f.PrintableString})],Gn.prototype,"value",void 0);Gn=s([B({type:A.Choice})],Gn);let Dr=class{constructor(e=""){this.value=e}toString(){return this.value}};s([a({type:f.PrintableString})],Dr.prototype,"value",void 0);Dr=s([B({type:A.Choice})],Dr);let Vs=class extends Dr{};Vs=s([B({type:A.Choice})],Vs);let Ts=class extends Q{};Ts=s([B({type:A.Choice})],Ts);let Kn=class{constructor(e=""){this.value=e}toString(){return this.value}};s([a({type:f.ObjectIdentifier})],Kn.prototype,"value",void 0);Kn=s([B({type:A.Choice})],Kn);let js=class extends ee{};js=s([B({type:A.Choice})],js);let Wn=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};s([a({type:f.Integer})],Wn.prototype,"value",void 0);Wn=s([B({type:A.Choice})],Wn);let _s=class extends Me{};_s=s([B({type:A.Sequence})],_s);let Hr=class extends Q{};Hr=s([B({type:A.Choice})],Hr);let Rs=$n=class extends tt{constructor(e){super(e),Object.setPrototypeOf(this,$n.prototype)}};Rs=$n=s([B({type:A.Sequence})],Rs);let Us=Ln=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Ln.prototype)}};Us=Ln=s([B({type:A.Set,itemType:Ct})],Us);let Jn=class{constructor(e=""){this.value=e}toString(){return this.value}};s([a({type:f.BmpString})],Jn.prototype,"value",void 0);Jn=s([B({type:A.Choice})],Jn);let Yn=class extends P{};Yn=s([B({type:A.Sequence})],Yn);let Ds=Fn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Fn.prototype)}};Ds=Fn=s([B({type:A.Sequence,itemType:Yn})],Ds);const Hs="1.2.840.10045.2.1",Qc="1.2.840.10045.4.1",$u="1.2.840.10045.4.3.1",Xc="1.2.840.10045.4.3.2",el="1.2.840.10045.4.3.3",tl="1.2.840.10045.4.3.4",Ms="1.2.840.10045.3.1.7",$s="1.3.132.0.34",Ls="1.3.132.0.35";function cr(r){return new P({algorithm:r})}const Lu=cr(Qc);cr($u);const Fu=cr(Xc),qu=cr(el),zu=cr(tl);let kt=class{constructor(e={}){Object.assign(this,e)}};s([a({type:f.ObjectIdentifier})],kt.prototype,"namedCurve",void 0);kt=s([B({type:A.Choice})],kt);class Ni{constructor(e={}){this.version=1,this.privateKey=new D,Object.assign(this,e)}}s([a({type:f.Integer})],Ni.prototype,"version",void 0);s([a({type:D})],Ni.prototype,"privateKey",void 0);s([a({type:kt,context:0,optional:!0})],Ni.prototype,"parameters",void 0);s([a({type:f.BitString,context:1,optional:!0})],Ni.prototype,"publicKey",void 0);class Mr{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:f.Integer,converter:q})],Mr.prototype,"r",void 0);s([a({type:f.Integer,converter:q})],Mr.prototype,"s",void 0);var Zn;let $r=Zn=class extends ${constructor(e){super(e),Object.setPrototypeOf(this,Zn.prototype)}};$r=Zn=s([B({type:A.Sequence,itemType:_e})],$r);class Vt{constructor(e={}){this.version=0,this.subject=new J,this.subjectPKInfo=new qe,this.attributes=new $r,Object.assign(this,e)}}s([a({type:f.Integer})],Vt.prototype,"version",void 0);s([a({type:J})],Vt.prototype,"subject",void 0);s([a({type:qe})],Vt.prototype,"subjectPKInfo",void 0);s([a({type:$r,implicit:!0,context:0})],Vt.prototype,"attributes",void 0);class Uo{constructor(e={}){this.certificationRequestInfo=new Vt,this.signatureAlgorithm=new P,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}s([a({type:Vt})],Uo.prototype,"certificationRequestInfo",void 0);s([a({type:P})],Uo.prototype,"signatureAlgorithm",void 0);s([a({type:f.BitString})],Uo.prototype,"signature",void 0);/*!
 * MIT License
 * 
 * Copyright (c) Peculiar Ventures. All rights reserved.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */class Tt{constructor(...e){if(e.length===1){const t=e[0];this.rawData=j.serialize(t),this.onInit(t)}else{const t=j.parse(e[0],e[1]);this.rawData=E.toArrayBuffer(e[0]),this.onInit(t)}}equal(e){return e instanceof Tt?Sa(e.rawData,this.rawData):!1}}class Ge extends Tt{constructor(...e){let t;E.isBufferSource(e[0])?t=E.toArrayBuffer(e[0]):t=j.serialize(new pe({extnID:e[0],critical:e[1],extnValue:new D(E.toArrayBuffer(e[2]))})),super(t,pe)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}}var rl;class Ye{constructor(){this.items=new Map,this[rl]="CryptoProvider",typeof self<"u"&&typeof crypto<"u"&&this.set(Ye.DEFAULT,crypto)}static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&e.extractable!==void 0}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,t){return this.items.forEach(e,t)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=Ye.DEFAULT){const t=this.items.get(e.toLowerCase());if(!t)throw new Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if(typeof e=="string"){if(!t)throw new TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),t)}else this.items.set(Ye.DEFAULT,e);return this}}rl=Symbol.toStringTag;Ye.DEFAULT="default";const ue=new Ye,Oi="crypto.algorithm";class Gu{getAlgorithms(){return xe.resolveAll(Oi)}toAsnAlgorithm(e){({...e});for(const t of this.getAlgorithms()){const i=t.toAsnAlgorithm(e);if(i)return i}if(/[0-9.]+/.test(e.name)){const t=new P({algorithm:e.name});if("parameters"in e){const i=e;t.parameters=i.parameters}return t}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(const i of this.getAlgorithms()){const n=i.toWebAlgorithm(e);if(n)return n}return{name:e.algorithm,parameters:e.parameters}}}const Do="crypto.algorithmProvider";xe.registerSingleton(Do,Gu);class Ut{constructor(){this.CertificateTag="CERTIFICATE",this.CertificateRequestTag="CERTIFICATE REQUEST",this.PublicKeyTag="PUBLIC KEY",this.PrivateKeyTag="PRIVATE KEY"}static isPem(e){return typeof e=="string"&&/-{5}BEGIN [A-Z0-9 ]+-{5}([a-zA-Z0-9=+/\n\r]+)-{5}END [A-Z0-9 ]+-{5}/g.test(e)}static decode(e){const t=/-{5}BEGIN [A-Z0-9 ]+-{5}([a-zA-Z0-9=+/\n\r]+)-{5}END [A-Z0-9 ]+-{5}/g,i=[];let n=null;for(;n=t.exec(e);){const o=n[1].replace(/\r/g,"").replace(/\n/g,"");i.push(N.FromBase64(o))}return i}static decodeFirst(e){const t=this.decode(e);if(!t.length)throw new RangeError("PEM string doesn't contain any objects");return t[0]}static encode(e,t){if(Array.isArray(e)){const i=new Array;return e.forEach(n=>{i.push(this.encodeBuffer(n,t))}),i.join(`
`)}else return this.encodeBuffer(e,t)}static encodeBuffer(e,t){const i=N.ToBase64(e);let n,o=0;const c=Array();for(;o<i.length&&(i.length-o<64?n=i.substring(o):(n=i.substring(o,o+64),o+=64),n.length!==0);)if(c.push(n),n.length<64)break;const l=t.toLocaleUpperCase();return`-----BEGIN ${l}-----
${c.join(`
`)}
-----END ${l}-----`}}class nt extends Tt{static isAsnEncoded(e){return E.isBufferSource(e)||typeof e=="string"}static toArrayBuffer(e){if(typeof e=="string"){if(Ut.isPem(e))return Ut.decode(e)[0];if(N.isHex(e))return N.FromHex(e);if(N.isBase64(e))return N.FromBase64(e);if(N.isBase64Url(e))return N.FromBase64Url(e);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}else{const t=N.ToBinary(e);return Ut.isPem(t)?Ut.decode(t)[0]:N.isHex(t)?N.FromHex(t):N.isBase64(t)?N.FromBase64(t):N.isBase64Url(t)?N.FromBase64Url(t):E.toArrayBuffer(e)}}constructor(...e){nt.isAsnEncoded(e[0])?super(nt.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){switch(e){case"pem":return Ut.encode(this.rawData,this.tag);case"hex":return N.ToHex(this.rawData);case"base64":return N.ToBase64(this.rawData);case"base64url":return N.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}}class dt extends nt{constructor(e){nt.isAsnEncoded(e)?super(e,qe):super(e),this.tag="PUBLIC KEY"}async export(...e){let t,i=["verify"],n={hash:"SHA-256",...this.algorithm};return e.length>1?(n=e[0]||n,i=e[1]||i,t=e[2]||ue.get()):t=e[0]||ue.get(),t.subtle.importKey("spki",this.rawData,n,!0,i)}onInit(e){const t=xe.resolve(Do),i=this.algorithm=t.toWebAlgorithm(e.algorithm);switch(e.algorithm.algorithm){case Ir:{const n=j.parse(e.subjectPublicKey,xo),o=E.toUint8Array(n.modulus);i.publicExponent=E.toUint8Array(n.publicExponent),i.modulusLength=(o[0]?o:o.slice(1)).byteLength<<3;break}}}async getThumbprint(...e){var t;let i,n="SHA-1";return e.length>=1&&!(!((t=e[0])===null||t===void 0)&&t.subtle)?(n=e[0]||n,i=e[1]||ue.get()):i=e[0]||ue.get(),await i.subtle.digest(n,this.rawData)}async getKeyIdentifier(e){e||(e=ue.get());const t=j.parse(this.rawData,qe);return await e.subtle.digest("SHA-1",t.subjectPublicKey)}}class il{constructor(){this.items={}}get(e){return this.items[e]||null}register(e,t){this.items[e]=t,this.items[t]=e}}const le=new il;le.register("CN","2.5.4.3");le.register("L","2.5.4.7");le.register("ST","2.5.4.8");le.register("O","2.5.4.10");le.register("OU","2.5.4.11");le.register("C","2.5.4.6");le.register("DC","0.9.2342.19200300.100.1.25");le.register("E","1.2.840.113549.1.9.1");le.register("G","2.5.4.42");le.register("I","2.5.4.43");le.register("SN","2.5.4.4");le.register("T","2.5.4.12");function Ku(r,e){return`\\${N.ToHex(N.FromUtf8String(e)).toUpperCase()}`}function Wu(r){return r.replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,Ku)}class Mt{constructor(e,t={}){this.extraNames=new il,this.asn=new J;for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const n=t[i];this.extraNames.register(i,n)}typeof e=="string"?this.asn=this.fromString(e):e instanceof J?this.asn=e:E.isBufferSource(e)?this.asn=j.parse(e,J):this.asn=this.fromJSON(e)}static isASCII(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!1;return!0}getName(e){return this.extraNames.get(e)||le.get(e)}toString(){return this.asn.map(e=>e.map(t=>{const i=this.getName(t.type)||t.type,n=t.value.anyValue?`#${N.ToHex(t.value.anyValue)}`:Wu(t.value.toString());return`${i}=${n}`}).join("+")).join(", ")}toJSON(){var e;const t=[];for(const i of this.asn){const n={};for(const o of i){const c=this.getName(o.type)||o.type;(e=n[c])!==null&&e!==void 0||(n[c]=[]),n[c].push(o.value.anyValue?`#${N.ToHex(o.value.anyValue)}`:o.value.toString())}t.push(n)}return t}fromString(e){const t=new J,i=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let n=null,o=",";for(;n=i.exec(`${e},`);){let[,c,l]=n;const u=l[l.length-1];(u===","||u==="+")&&(l=l.slice(0,l.length-1),n[3]=u);const p=n[3];if(/[\d.]+/.test(c)||(c=this.getName(c)||""),!c)throw new Error(`Cannot get OID for name type '${c}'`);const w=new Lt({type:c});if(l.charAt(0)==="#")w.value.anyValue=N.FromHex(l.slice(1));else{const b=/"(.*?[^\\])?"/.exec(l);b&&(l=b[1]),l=l.replace(/\\0a/ig,`
`).replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1"),c===this.getName("E")||c===this.getName("DC")?w.value.ia5String=l:Mt.isASCII(l)?w.value.printableString=l:w.value.utf8String=l}o==="+"?t[t.length-1].push(w):t.push(new gt([w])),o=p}return t}fromJSON(e){const t=new J;for(const i of e){const n=new gt;for(const o in i){let c=o;if(/[\d.]+/.test(o)||(c=this.getName(o)||""),!c)throw new Error(`Cannot get OID for name type '${o}'`);const l=i[o];for(const u of l){const p=new Lt({type:c});if(typeof u=="object")for(const w in u)switch(w){case"ia5String":p.value.ia5String=u[w];break;case"utf8String":p.value.utf8String=u[w];break;case"universalString":p.value.universalString=u[w];break;case"bmpString":p.value.bmpString=u[w];break;case"printableString":p.value.printableString=u[w];break}else u[0]==="#"?p.value.anyValue=N.FromHex(u.slice(1)):c===this.getName("E")||c===this.getName("DC")?p.value.ia5String=u:p.value.printableString=u;n.push(p)}}t.push(n)}return t}toArrayBuffer(){return j.serialize(this.asn)}async getThumbprint(...e){var t;let i,n="SHA-1";return e.length>=1&&!(!((t=e[0])===null||t===void 0)&&t.subtle)?(n=e[0]||n,i=e[1]||ue.get()):i=e[0]||ue.get(),await i.subtle.digest(n,this.toArrayBuffer())}}class Ee{static register(e,t){this.items.set(e,t)}static create(e){const t=new Ge(e),i=this.items.get(t.type);return i?new i(e):t}}Ee.items=new Map;const Ho="crypto.signatureFormatter";class Ju{toAsnSignature(e,t){return E.toArrayBuffer(t)}toWebSignature(e,t){return E.toArrayBuffer(t)}}class Qn extends nt{constructor(e){nt.isAsnEncoded(e)?super(e,Zt):super(e),this.tag="CERTIFICATE"}onInit(e){const t=e.tbsCertificate;this.tbs=j.serialize(t),this.serialNumber=N.ToHex(t.serialNumber),this.subjectName=new Mt(t.subject),this.subject=new Mt(t.subject).toString(),this.issuerName=new Mt(t.issuer),this.issuer=this.issuerName.toString();const i=xe.resolve(Do);this.signatureAlgorithm=i.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signatureValue;const n=t.validity.notBefore.utcTime||t.validity.notBefore.generalTime;if(!n)throw new Error("Cannot get 'notBefore' value");this.notBefore=n;const o=t.validity.notAfter.utcTime||t.validity.notAfter.generalTime;if(!o)throw new Error("Cannot get 'notAfter' value");this.notAfter=o,this.extensions=[],t.extensions&&(this.extensions=t.extensions.map(c=>Ee.create(j.serialize(c)))),this.publicKey=new dt(t.subjectPublicKeyInfo)}getExtension(e){for(const t of this.extensions)if(typeof e=="string"){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter(t=>typeof e=="string"?t.type===e:t instanceof e)}async verify(e={},t=ue.get()){let i,n;const o=e.publicKey;try{if(!o)i={...this.publicKey.algorithm,...this.signatureAlgorithm},n=await this.publicKey.export(i,["verify"],t);else if("publicKey"in o)i={...o.publicKey.algorithm,...this.signatureAlgorithm},n=await o.publicKey.export(i,["verify"]);else if(o instanceof dt)i={...o.algorithm,...this.signatureAlgorithm},n=await o.export(i,["verify"]);else if(E.isBufferSource(o)){const p=new dt(o);i={...p.algorithm,...this.signatureAlgorithm},n=await p.export(i,["verify"])}else i={...o.algorithm,...this.signatureAlgorithm},n=o}catch{return!1}const c=xe.resolveAll(Ho).reverse();let l=null;for(const p of c)if(l=p.toWebSignature(i,this.signature),l)break;if(!l)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const u=await t.subtle.verify(this.signatureAlgorithm,n,l,this.tbs);if(e.signatureOnly)return u;{const w=(e.date||new Date).getTime();return u&&this.notBefore.getTime()<w&&w<this.notAfter.getTime()}}async getThumbprint(...e){let t,i="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(i=e[0]||i,t=e[1])),t??(t=ue.get()),await t.subtle.digest(i,this.rawData)}async isSelfSigned(e=ue.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}}class Lr extends Ge{constructor(...e){if(E.isBufferSource(e[0]))super(e[0]);else if(typeof e[0]=="string"){const t=new pt({keyIdentifier:new go(N.FromHex(e[0]))});super(zi,e[1],j.serialize(t))}else{const t=e[0],i=new pt({authorityCertIssuer:t.name,authorityCertSerialNumber:N.FromHex(t.serialNumber)});super(zi,e[1],j.serialize(i))}}static async create(e,t=!1,i=ue.get()){if(e instanceof Qn||Ye.isCryptoKey(e)){const n=e instanceof Qn?await e.publicKey.export(i):e,o=await i.subtle.exportKey("spki",n),l=await new dt(o).getKeyIdentifier(i);return new Lr(N.ToHex(l),t)}else return new Lr(e,t)}onInit(e){super.onInit(e);const t=j.parse(e.extnValue,pt);t.keyIdentifier&&(this.keyId=N.ToHex(t.keyIdentifier)),t.authorityCertIssuer&&t.authorityCertSerialNumber&&(this.certId={name:t.authorityCertIssuer,serialNumber:N.ToHex(t.authorityCertSerialNumber)})}}class Yu extends Ge{constructor(...e){if(E.isBufferSource(e[0])){super(e[0]);const t=j.parse(this.value,mr);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else{const t=new mr({cA:e[0],pathLenConstraint:e[1]});super(Bc,e[2],j.serialize(t)),this.ca=e[0],this.pathLength=e[1]}}}class Zu extends Ge{constructor(...e){if(E.isBufferSource(e[0])){super(e[0]);const t=j.parse(this.value,Sr);this.usages=t.map(i=>i)}else{const t=new Sr(e[0]);super(Ic,e[1],j.serialize(t)),this.usages=e[0]}}}var Xn;(function(r){r[r.digitalSignature=1]="digitalSignature",r[r.nonRepudiation=2]="nonRepudiation",r[r.keyEncipherment=4]="keyEncipherment",r[r.dataEncipherment=8]="dataEncipherment",r[r.keyAgreement=16]="keyAgreement",r[r.keyCertSign=32]="keyCertSign",r[r.cRLSign=64]="cRLSign",r[r.encipherOnly=128]="encipherOnly",r[r.decipherOnly=256]="decipherOnly"})(Xn||(Xn={}));class nl extends Ge{constructor(...e){if(E.isBufferSource(e[0])){super(e[0]);const t=j.parse(this.value,hs);this.usages=t.toNumber()}else{const t=new hs(e[0]);super(Cc,e[1],j.serialize(t)),this.usages=e[0]}}}class Mo extends Ge{constructor(...e){if(E.isBufferSource(e[0])){super(e[0]);const t=j.parse(this.value,et);this.keyId=N.ToHex(t)}else{const t=typeof e[0]=="string"?N.FromHex(e[0]):e[0],i=new et(t);super(Pc,e[1],j.serialize(i)),this.keyId=N.ToHex(t)}}static async create(e,t=!1,i=ue.get()){let n;e instanceof dt?n=e.rawData:"publicKey"in e?n=e.publicKey.rawData:E.isBufferSource(e)?n=e:n=await i.subtle.exportKey("spki",e);const c=await new dt(n).getKeyIdentifier(i);return new Mo(N.ToHex(c),t)}}class Qu extends Tt{constructor(...e){let t;if(E.isBufferSource(e[0]))t=E.toArrayBuffer(e[0]);else{const i=e[0],n=E.toArrayBuffer(e[1]);t=j.serialize(new Fe({typeId:i,value:n}))}super(t,Fe)}onInit(e){this.type=e.typeId,this.value=e.value}toJSON(){return{type:this.type,value:N.ToHex(this.value)}}}class me extends Ge{constructor(...e){if(E.isBufferSource(e[0]))super(e[0]);else{const t=e[0]||{},i=new xr;for(const n of t.dns||[])i.push(new U({dNSName:n}));for(const n of t.email||[])i.push(new U({rfc822Name:n}));for(const n of t.guid||[]){const o=/([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})/i.exec(n);if(!o)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const c=o.slice(1).map((l,u)=>u<3?N.ToHex(new Uint8Array(N.FromHex(l)).reverse()):l).join("");i.push(new U({otherName:new Fe({typeId:me.GUID,value:j.serialize(new D(N.FromHex(c)))})}))}for(const n of t.ip||[])i.push(new U({iPAddress:n}));for(const n of t.url||[])i.push(new U({uniformResourceIdentifier:n}));for(const n of t.upn||[])i.push(new U({otherName:new Fe({typeId:me.UPN,value:j.serialize(Ac.toASN(n))})}));for(const n of t.registeredId||[])i.push(new U({registeredID:n}));for(const n of t.otherName||[])i.push(new U({otherName:new Fe({typeId:n.type,value:N.FromHex(n.value)})}));super(Oc,e[1],j.serialize(i))}}onInit(e){super.onInit(e);const t=j.parse(e.extnValue,xr);this.dns=t.filter(i=>i.dNSName).map(i=>i.dNSName||""),this.email=t.filter(i=>i.rfc822Name).map(i=>i.rfc822Name||""),this.ip=t.filter(i=>i.iPAddress).map(i=>i.iPAddress||""),this.url=t.filter(i=>i.uniformResourceIdentifier).map(i=>i.uniformResourceIdentifier||""),this.upn=t.filter(i=>{var n;return((n=i.otherName)===null||n===void 0?void 0:n.typeId)===me.UPN}).map(i=>i.otherName?j.parse(i.otherName.value,Q).toString():""),this.guid=t.filter(i=>{var n;return((n=i.otherName)===null||n===void 0?void 0:n.typeId)===me.GUID}).map(i=>i.otherName?j.parse(i.otherName.value,D):new D).map(i=>{const n=/([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})/i.exec(N.ToHex(i));if(!n)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");return`{${n.slice(1).map((c,l)=>l<3?N.ToHex(new Uint8Array(N.FromHex(c)).reverse()):c).join("-")}}`}),this.registeredId=t.filter(i=>i.registeredID).map(i=>i.registeredID||""),this.otherNames=t.filter(i=>i.otherName&&![me.GUID,me.UPN].includes(i.otherName.typeId)).map(i=>new Qu(i.otherName.typeId,i.otherName.value))}toJSON(){const e={};return this.dns.length&&(e.dns=[...this.dns]),this.email.length&&(e.email=[...this.email]),this.ip.length&&(e.ip=[...this.ip]),this.guid.length&&(e.guid=[...this.guid]),this.upn.length&&(e.upn=[...this.upn]),this.url.length&&(e.url=[...this.url]),this.registeredId.length&&(e.registeredId=[...this.registeredId]),this.otherNames.length&&(e.otherName=this.otherNames.map(t=>t.toJSON())),e}}me.GUID="1.3.6.1.4.1.311.25.1";me.UPN="1.3.6.1.4.1.311.20.2.3";class Xu extends Ge{constructor(...e){var t;if(E.isBufferSource(e[0])){super(e[0]);const i=j.parse(this.value,br);this.policies=i.map(n=>n.policyIdentifier)}else{const i=e[0],n=(t=e[1])!==null&&t!==void 0?t:!1,o=new br(i.map(c=>new ci({policyIdentifier:c})));super(xc,n,j.serialize(o)),this.policies=i}}}Ee.register(xc,Xu);class $o extends Tt{constructor(...e){let t;if(E.isBufferSource(e[0]))t=E.toArrayBuffer(e[0]);else{const i=e[0],n=Array.isArray(e[1])?e[1].map(o=>E.toArrayBuffer(o)):[];t=j.serialize(new _e({type:i,values:n}))}super(t,_e)}onInit(e){this.type=e.type,this.values=e.values}}class ef extends $o{constructor(...e){var t;if(E.isBufferSource(e[0]))super(e[0]);else{const i=new Hr({printableString:e[0]});super(Yc,[j.serialize(i)])}(t=this.password)!==null&&t!==void 0||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){const t=j.parse(this.values[0],Hr);this.password=t.toString()}}}class tf extends $o{constructor(...e){var t;if(E.isBufferSource(e[0]))super(e[0]);else{const i=new tt(e[0]);super(Zc,[j.serialize(i)])}(t=this.items)!==null&&t!==void 0||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){const t=j.parse(this.values[0],tt);this.items=t.map(i=>Ee.create(j.serialize(i)))}}}class Lo{static register(e,t){this.items.set(e,t)}static create(e){const t=new $o(e),i=this.items.get(t.type);return i?new i(e):t}}Lo.items=new Map;let eo=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if(e.hash)switch(e.hash.name.toLowerCase()){case"sha-1":return new P({algorithm:un,parameters:null});case"sha-256":return new P({algorithm:vs,parameters:null});case"sha-384":return new P({algorithm:fn,parameters:null});case"sha-512":return new P({algorithm:hn,parameters:null})}else return new P({algorithm:Ir,parameters:null})}return null}toWebAlgorithm(e){switch(e.algorithm){case Ir:return{name:"RSASSA-PKCS1-v1_5"};case un:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case vs:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case fn:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case hn:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}}}return null}};eo=s([Co()],eo);xe.registerSingleton(Oi,eo);var dr;const oe="1.3.36.3.3.2.8.1.1",Fs=`${oe}.1`,qs=`${oe}.2`,zs=`${oe}.3`,Gs=`${oe}.4`,Ks=`${oe}.5`,Ws=`${oe}.6`,Js=`${oe}.7`,Ys=`${oe}.8`,Zs=`${oe}.9`,Qs=`${oe}.10`,Xs=`${oe}.11`,ea=`${oe}.12`,ta=`${oe}.13`,ra=`${oe}.14`,ia="brainpoolP160r1",na="brainpoolP160t1",oa="brainpoolP192r1",sa="brainpoolP192t1",aa="brainpoolP224r1",ca="brainpoolP224t1",la="brainpoolP256r1",ua="brainpoolP256t1",fa="brainpoolP320r1",ha="brainpoolP320t1",pa="brainpoolP384r1",da="brainpoolP384t1",ya="brainpoolP512r1",va="brainpoolP512t1",z="ECDSA";let Fr=dr=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case z.toLowerCase():if("hash"in e)switch((typeof e.hash=="string"?e.hash:e.hash.name).toLowerCase()){case"sha-1":return Lu;case"sha-256":return Fu;case"sha-384":return qu;case"sha-512":return zu}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=Ms;break;case"K-256":t=dr.SECP256K1;break;case"P-384":t=$s;break;case"P-521":t=Ls;break;case ia:t=Fs;break;case na:t=qs;break;case oa:t=zs;break;case sa:t=Gs;break;case aa:t=Ks;break;case ca:t=Ws;break;case la:t=Js;break;case ua:t=Ys;break;case fa:t=Zs;break;case ha:t=Qs;break;case pa:t=Xs;break;case da:t=ea;break;case ya:t=ta;break;case va:t=ra;break}if(t)return new P({algorithm:Hs,parameters:j.serialize(new kt({namedCurve:t}))})}}return null}toWebAlgorithm(e){switch(e.algorithm){case Qc:return{name:z,hash:{name:"SHA-1"}};case Xc:return{name:z,hash:{name:"SHA-256"}};case el:return{name:z,hash:{name:"SHA-384"}};case tl:return{name:z,hash:{name:"SHA-512"}};case Hs:{if(!e.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(j.parse(e.parameters,kt).namedCurve){case Ms:return{name:z,namedCurve:"P-256"};case dr.SECP256K1:return{name:z,namedCurve:"K-256"};case $s:return{name:z,namedCurve:"P-384"};case Ls:return{name:z,namedCurve:"P-521"};case Fs:return{name:z,namedCurve:ia};case qs:return{name:z,namedCurve:na};case zs:return{name:z,namedCurve:oa};case Gs:return{name:z,namedCurve:sa};case Ks:return{name:z,namedCurve:aa};case Ws:return{name:z,namedCurve:ca};case Js:return{name:z,namedCurve:la};case Ys:return{name:z,namedCurve:ua};case Zs:return{name:z,namedCurve:fa};case Qs:return{name:z,namedCurve:ha};case Xs:return{name:z,namedCurve:pa};case ea:return{name:z,namedCurve:da};case ta:return{name:z,namedCurve:ya};case ra:return{name:z,namedCurve:va}}}}return null}};Fr.SECP256K1="1.3.132.0.10";Fr=dr=s([Co()],Fr);xe.registerSingleton(Oi,Fr);class he{addPadding(e,t){const i=E.toUint8Array(t),n=new Uint8Array(e);return n.set(i,e-i.length),n}removePadding(e,t=!1){let i=E.toUint8Array(e);for(let n=0;n<i.length;n++)if(!!i[n]){i=i.slice(n);break}if(t&&i[0]>127){const n=new Uint8Array(i.length+1);return n.set(i,1),n.buffer}return i.buffer}toAsnSignature(e,t){if(e.name==="ECDSA"){const i=e.namedCurve,n=he.namedCurveSize.get(i)||he.defaultNamedCurveSize,o=new Mr,c=E.toUint8Array(t);return o.r=this.removePadding(c.slice(0,n),!0),o.s=this.removePadding(c.slice(n,n+n),!0),j.serialize(o)}return null}toWebSignature(e,t){if(e.name==="ECDSA"){const i=j.parse(t,Mr),n=e.namedCurve,o=he.namedCurveSize.get(n)||he.defaultNamedCurveSize,c=this.addPadding(o,this.removePadding(i.r)),l=this.addPadding(o,this.removePadding(i.s));return Bl(c,l)}return null}}he.namedCurveSize=new Map;he.defaultNamedCurveSize=32;const ga="1.3.101.110",ma="1.3.101.111",wa="1.3.101.112",ba="1.3.101.113";let to=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=wa;break;case"ed448":t=ba;break}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=ga;break;case"x448":t=ma;break}}return t?new P({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case wa:return{name:"EdDSA",namedCurve:"Ed25519"};case ba:return{name:"EdDSA",namedCurve:"Ed448"};case ga:return{name:"ECDH-ES",namedCurve:"X25519"};case ma:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};to=s([Co()],to);xe.registerSingleton(Oi,to);var Aa;(function(r){r[r.unspecified=0]="unspecified",r[r.keyCompromise=1]="keyCompromise",r[r.cACompromise=2]="cACompromise",r[r.affiliationChanged=3]="affiliationChanged",r[r.superseded=4]="superseded",r[r.cessationOfOperation=5]="cessationOfOperation",r[r.certificateHold=6]="certificateHold",r[r.removeFromCRL=8]="removeFromCRL",r[r.privilegeWithdrawn=9]="privilegeWithdrawn",r[r.aACompromise=10]="aACompromise"})(Aa||(Aa={}));Ee.register(Bc,Yu);Ee.register(Ic,Zu);Ee.register(Cc,nl);Ee.register(Pc,Mo);Ee.register(zi,Lr);Ee.register(Oc,me);Lo.register(Yc,ef);Lo.register(Zc,tf);xe.registerSingleton(Ho,Ju);xe.registerSingleton(Ho,he);he.namedCurveSize.set("P-256",32);he.namedCurveSize.set("K-256",32);he.namedCurveSize.set("P-384",48);he.namedCurveSize.set("P-521",66);const Lh=r=>{const e=new Qn(r),t={subject:e.subjectName.toString(),issuer:e.issuer,notAfter:e.notAfter};return e.extensions.forEach(i=>{if(i instanceof me)t.subjectAltName=Object.entries(i.toJSON()).map(([n,o])=>`${n}=${o.join(", ")}`).join("; ");else if(i instanceof nl){const n=Object.values(Xn),o=Array(n.length/2).fill(null).reduce((c,l,u)=>{const p=n[n.length/2+u];if(i.usages&p){const w=n[u];c.push(w)}return c},[]);t.keyUsage=o}}),t};export{Lh as p};
