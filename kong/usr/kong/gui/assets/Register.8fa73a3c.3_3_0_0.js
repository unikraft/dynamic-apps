/*
  This software is copyright Kong Inc. and its licensors.
  Use of the software is subject to the agreement between your organization
  and Kong Inc. If there is no such agreement, use is governed by and
  subject to the terms of the Kong Master Software License Agreement found
  at https://konghq.com/enterprisesoftwarelicense/.
*/

import{_ as M,A as f,P as y,m as I,u as G,g as Y,r as m,c as n,a as e,b as u,w as l,f as W,o,h as z,i as w,j as J,k as c,v as d,t as _,d as p,s as b,__tla as Q}from"./index.84d84090.3_3_0_0.js";import{__tla as X}from"./monaco-editor.90904fcf.3_3_0_0.js";let T,Z=Promise.all([(()=>{try{return Q}catch{}})(),(()=>{try{return X}catch{}})()]).then(async()=>{const v=f.validAuthPlugins(),A={name:"KMRegister",data(){return{hasSuccess:!1,message:null,email:this.$route.query.email,username:this.$route.query.username,password:"",confirmPassword:"",validAuthPlugins:v.filter(r=>r!=="openid-connect"),lang:{AUTH_NOT_ENABLED:"Authentication is not enabled.",AUTH_TYPE_UNKNOWN:"Authentication type unknown.",REGISTER_SUCCESS:"You've been successfully registered!"}}},computed:{authType(){return this.$root.$data.auth.enabled},isValidAuthType(){return f.isValidAuthType(this.authType)},doesPasswordMatch(){return this.password===this.confirmPassword}},created(){(this.authType===y.LDAP_AUTH||this.authType===y.OPENID_CONNECT)&&this.$router.push({name:"login",params:{username:this.username},query:{username:this.username,email:this.email}})},mounted(){const r=document.getElementsByTagName("input");r&&r.length>=2&&r[0].focus()},methods:{...I(G,["logout"]),submitForm(){this.message=null,setTimeout(this.login,250)},login(){if(this.logout(),!this.doesPasswordMatch){this.message="Passwords do not match";return}const r={email:this.email,username:this.username,password:this.password,token:this.$route.query.token};return this.$api.registerUser(r).then(()=>{this.hasSuccess=!0}).catch(s=>{this.message=Y(s)})}}},P={class:"login register"},S={class:"login-form"},E={key:0},U=e("div",{class:"d-flex justify-content-center mb-4"},[e("img",{class:"d-flex",src:W,alt:"logo"})],-1),N={key:0},k=e("h4",{class:"mb-7 text-center"}," Complete Account Setup ",-1),C={key:0,class:"mb-4"},q={class:"form-group mb-4"},x=e("label",{for:"email"},"Username",-1),K={class:"form-group mb-4"},R=e("label",{for:"password"},"Password",-1),$={class:"form-group mb-4"},F=e("label",{for:"password-confirm"},"Confirm Password",-1),O=p(" Register "),V={key:1,class:"text-center","data-testid":"account-setup-success"},j=e("h4",{class:"mb-4 text-center"}," Account Setup Success ",-1),B=p(" Login "),D={key:1};function H(r,s,ee,se,a,i){const h=m("KAlert"),g=m("KButton"),L=m("KCard");return o(),n("div",P,[e("div",S,[i.authType?(o(),n("div",E,[U,u(L,null,{body:l(()=>[a.hasSuccess?(o(),n("div",V,[j,e("p",null,_(a.lang.REGISTER_SUCCESS),1),u(g,{to:{name:"login",query:{username:a.username,email:a.email}},appearance:"primary",class:"w-100 justify-content-center mt-7 mb-4"},{default:l(()=>[B]),_:1},8,["to"])])):(o(),n("div",N,[k,a.message?(o(),n("div",C,[u(h,{"alert-message":a.message,appearance:"danger"},null,8,["alert-message"])])):z("",!0),e("form",{onSubmit:s[3]||(s[3]=w((...t)=>i.submitForm&&i.submitForm(...t),["prevent"])),onKeydown:s[4]||(s[4]=J(w((...t)=>i.submitForm&&i.submitForm(...t),["prevent"]),["enter"]))},[e("div",q,[x,c(e("input",{id:"username","onUpdate:modelValue":s[0]||(s[0]=t=>a.username=t),class:"form-control",type:"text",disabled:"",required:""},null,512),[[d,a.username]])]),e("div",K,[R,c(e("input",{id:"password","onUpdate:modelValue":s[1]||(s[1]=t=>a.password=t),class:"form-control",type:"password",autocomplete:"new-password",required:""},null,512),[[d,a.password]])]),e("div",$,[F,c(e("input",{id:"password-confirm","onUpdate:modelValue":s[2]||(s[2]=t=>a.confirmPassword=t),class:"form-control",type:"password",required:""},null,512),[[d,a.confirmPassword]])]),u(g,{appearance:"primary",class:"w-100 justify-content-center mb-4",type:"submit"},{default:l(()=>[O]),_:1})],32)]))]),_:1})])):(o(),n("div",D,[u(h,{appearance:"warning",class:"mb-7"},{alertMessage:l(()=>[s[5]||(b(-1),s[5]=e("span",null,[p(_(a.lang.AUTH_NOT_ENABLED),1)]),b(1),s[5])]),_:1})]))])])}T=M(A,[["render",H]])});export{Z as __tla,T as default};
